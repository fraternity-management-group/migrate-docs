{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"GMS Database Migration Documentation","text":"<p>Welcome to the comprehensive documentation for the GMS Database Migration Tool. This tool migrates data from the existing MySQL schema to a modern PostgreSQL schema with enhanced features and improved design.</p>"},{"location":"#quick-start","title":"\ud83d\ude80 Quick Start","text":"<ol> <li>Installation - Set up the migration tool</li> <li>Configuration - Configure database connections</li> <li>Running Migration - Execute the migration process</li> </ol>"},{"location":"#whats-included","title":"\ud83d\udccb What's Included","text":""},{"location":"#migration-features","title":"Migration Features","text":"<ul> <li>Complete Data Migration: Migrates all core business data from MySQL to PostgreSQL</li> <li>Enhanced Contact Tracking: New <code>contact_log</code> table with improved features for tracking interactions and follow-ups</li> <li>Modern PostgreSQL Design: Uses UUIDs, ENUMs, proper foreign keys, and optimized indexes</li> <li>Robust Error Handling: Progress tracking, checkpoint recovery, and detailed logging</li> <li>Performance Optimized: Batch processing and strategic indexing for large datasets</li> <li>International Support: Enhanced address validation and phone number normalization</li> </ul>"},{"location":"#schema-improvements","title":"Schema Improvements","text":"<ul> <li>Primary Keys: MySQL auto-increment integers \u2192 PostgreSQL UUIDs</li> <li>Boolean Fields: MySQL <code>tinyint(1)</code> \u2192 PostgreSQL native <code>BOOLEAN</code> type</li> <li>Enumerations: MySQL string enums \u2192 PostgreSQL custom enum types</li> <li>Timestamps: MySQL <code>timestamp</code> \u2192 PostgreSQL <code>TIMESTAMPTZ</code> with timezone support</li> <li>Foreign Keys: Enhanced constraint definitions with proper cascade behaviors</li> </ul>"},{"location":"#migration-coverage","title":"\ud83d\udcca Migration Coverage","text":"<p>The migration tool handles 23 major data entities with comprehensive table mapping and data transformation. See the Migration Overview for detailed coverage information.</p>"},{"location":"#core-tables-migrated","title":"Core Tables Migrated","text":"Category Tables Status Core Entities Person, Organization, Address, Contact \u2705 Complete Engagement Events, Contact Log, Social Media \u2705 Complete Financial Finance, Transactions (Charges/Payments) \u2705 Complete Relationships Family, Education, Employment \u2705 Complete Campaign Prospects, Volunteers, Feasibility \u2705 Complete Recognition Leadership, Donor Status, Key Players \u2705 Complete"},{"location":"#documentation-sections","title":"\ud83d\udd0d Documentation Sections","text":""},{"location":"#schema-changes","title":"Schema Changes","text":"<p>Learn about the detailed transformations between MySQL and PostgreSQL schemas:</p> <ul> <li>Table Mappings - Complete table-to-table mapping reference</li> <li>Data Type Conversions - How data types are converted</li> <li>Enum Mappings - Enumeration value mappings</li> </ul>"},{"location":"#table-details","title":"Table Details","text":"<p>Detailed documentation for each migrated table:</p> <ul> <li>Contact Log - Enhanced contact tracking system</li> <li>Person - Core person/donor entity</li> <li>Organization - Organization and chapter management</li> <li>Address - Address handling with international support</li> <li>And many more...</li> </ul>"},{"location":"#installation-usage","title":"Installation &amp; Usage","text":"<p>Step-by-step guides for setting up and running the migration:</p> <ul> <li>Installation - Dependencies and setup</li> <li>Configuration - Database and tool configuration</li> <li>Running Migration - Migration execution</li> <li>Troubleshooting - Common issues and solutions</li> </ul>"},{"location":"#important-notes","title":"\u26a0\ufe0f Important Notes","text":"<p>Before You Begin</p> <ol> <li>Backup your PostgreSQL database before running the migration</li> <li>Test on a copy of production data first</li> <li>Verify data integrity after migration completion</li> </ol> <p>Performance Considerations</p> <ul> <li>Consider running migrations during low-traffic periods</li> <li>Monitor database connection pools during migration</li> </ul>"},{"location":"#getting-help","title":"\ud83c\udd98 Getting Help","text":"<p>If you encounter issues:</p> <ol> <li>Check the Troubleshooting guide</li> <li>Review migration logs for specific error messages</li> <li>Verify database connectivity and schema compatibility</li> <li>Ensure all prerequisites are met</li> </ol> <p>This documentation covers the migration tool that transforms MySQL data into a modern PostgreSQL schema with enhanced features for contact management, international support, and improved data integrity.</p>"},{"location":"configuration/","title":"Configuration","text":"<p>The GMS Database Migration Tool supports flexible configuration through environment variables, TOML configuration files, or command-line flags.</p>"},{"location":"configuration/#configuration-methods","title":"Configuration Methods","text":"<p>The tool uses the following priority order (highest to lowest):</p> <ol> <li>Command-line flags (highest priority)</li> <li>Environment variables</li> <li>TOML configuration file (lowest priority)</li> </ol>"},{"location":"configuration/#database-configuration","title":"Database Configuration","text":""},{"location":"configuration/#mysql-configuration","title":"MySQL Configuration","text":"<p>Configure your source MySQL database connection:</p>"},{"location":"configuration/#environment-variables","title":"Environment Variables","text":"<pre><code>export MYSQL_DSN=\"username:password@tcp(hostname:3306)/database_name\"\n</code></pre>"},{"location":"configuration/#toml-configuration","title":"TOML Configuration","text":"<pre><code>[mysql]\ndsn = \"username:password@tcp(hostname:3306)/database_name\"\n</code></pre>"},{"location":"configuration/#postgresql-configuration","title":"PostgreSQL Configuration","text":"<p>Configure your target PostgreSQL database connection:</p>"},{"location":"configuration/#environment-variables_1","title":"Environment Variables","text":"<pre><code>export POSTGRES_DSN=\"postgres://username:password@hostname:5432/database_name?sslmode=disable\"\n</code></pre>"},{"location":"configuration/#toml-configuration_1","title":"TOML Configuration","text":"<pre><code>[postgres]\ndsn = \"postgres://username:password@hostname:5432/database_name?sslmode=disable\"\n</code></pre>"},{"location":"configuration/#configuration-file-examples","title":"Configuration File Examples","text":""},{"location":"configuration/#complete-toml-configuration","title":"Complete TOML Configuration","text":"<p>Create a file named <code>.gms-migrate.toml</code>:</p> <pre><code># GMS Database Migration Configuration\n\n[mysql]\ndsn = \"root:password@tcp(localhost:3306)/fmg\"\n\n[postgres]\ndsn = \"postgres://postgres:password@localhost:5432/gms?sslmode=disable\"\n</code></pre>"},{"location":"configuration/#command-line-flags","title":"Command-Line Flags","text":"<p>Override configuration with command-line flags:</p> <pre><code># Database connections\n./gms-migrate migrate \\\n  --mysql-dsn \"user:pass@tcp(host:3306)/db\" \\\n  --postgres-dsn \"postgres://user:pass@host:5432/db\"\n\n# Custom config file\n./gms-migrate migrate --config custom-config.toml\n</code></pre>"},{"location":"installation/","title":"Installation","text":"<p>This guide walks you through installing and setting up the GMS Database Migration Tool.</p>"},{"location":"installation/#prerequisites","title":"Prerequisites","text":"<p>Before installing the migration tool, ensure you have the following prerequisites:</p>"},{"location":"installation/#system-requirements","title":"System Requirements","text":"<ul> <li>Operating System: Linux, macOS, or Windows</li> <li>Go: Version 1.21 or later</li> <li>Database Access: Both MySQL and PostgreSQL databases</li> <li>Memory: Minimum 4GB RAM (8GB+ recommended for large datasets)</li> <li>Disk Space: Sufficient space for both source and target databases</li> </ul>"},{"location":"installation/#database-requirements","title":"Database Requirements","text":""},{"location":"installation/#mysql-source-database","title":"MySQL (Source Database)","text":"<ul> <li>MySQL 5.7 or later</li> <li>Read access to the source database</li> <li>Network connectivity to the MySQL server</li> </ul>"},{"location":"installation/#postgresql-target-database","title":"PostgreSQL (Target Database)","text":"<ul> <li>PostgreSQL 12 or later</li> <li>Write access to the target database</li> <li>The new schema must be already applied (migration DDL must be run first)</li> <li>Network connectivity to the PostgreSQL server</li> </ul> <p>Schema Setup Required</p> <p>The PostgreSQL database must have the new schema already applied before running the data migration. The migration tool only handles data migration, not schema creation.</p>"},{"location":"installation/#installation-steps","title":"Installation Steps","text":""},{"location":"installation/#1-install-go","title":"1. Install Go","text":"<p>If you don't have Go installed, download and install it from golang.org.</p>"},{"location":"installation/#verify-go-installation","title":"Verify Go Installation","text":"<pre><code>go version\n</code></pre> <p>You should see output similar to: <pre><code>go version go1.21.0 darwin/arm64\n</code></pre></p>"},{"location":"installation/#2-clone-or-download-the-project","title":"2. Clone or Download the Project","text":"<p>Navigate to the GMS database migration directory:</p> <pre><code>cd /Users/jdf/Developer/gms/db\n</code></pre>"},{"location":"installation/#3-install-dependencies","title":"3. Install Dependencies","text":"<p>The migration tool uses Go modules for dependency management:</p> <pre><code># Install all required dependencies\ngo mod tidy\n</code></pre>"},{"location":"installation/#dependencies-overview","title":"Dependencies Overview","text":"<p>The tool uses the following key dependencies:</p> Package Purpose Version <code>github.com/go-sql-driver/mysql</code> MySQL database driver Latest <code>github.com/jackc/pgx/v5</code> PostgreSQL driver (high-performance) v5.x <code>github.com/google/uuid</code> UUID generation Latest <code>github.com/schollz/progressbar/v3</code> Terminal progress bars v3.x <code>github.com/rs/zerolog</code> Structured logging Latest <code>github.com/spf13/viper</code> Configuration management Latest <code>github.com/spf13/cobra</code> CLI framework Latest"},{"location":"installation/#4-build-the-migration-tool","title":"4. Build the Migration Tool","text":"<p>Build the CLI binary:</p> <pre><code># Build for your current platform\ngo build -o gms-migrate ./main.go\n</code></pre> <p>For cross-platform builds:</p> <pre><code># Build for Linux\nGOOS=linux GOARCH=amd64 go build -o gms-migrate-linux ./main.go\n\n# Build for macOS (Intel)\nGOOS=darwin GOARCH=amd64 go build -o gms-migrate-macos-intel ./main.go\n\n# Build for macOS (Apple Silicon)\nGOOS=darwin GOARCH=arm64 go build -o gms-migrate-macos-arm64 ./main.go\n\n# Build for Windows\nGOOS=windows GOARCH=amd64 go build -o gms-migrate.exe ./main.go\n</code></pre>"},{"location":"installation/#5-verify-installation","title":"5. Verify Installation","text":"<p>Test that the migration tool was built successfully:</p> <pre><code>./gms-migrate --help\n</code></pre> <p>You should see the help output with available commands:</p> <pre><code>GMS Database Migration Tool\n\nA powerful tool to migrate data from MySQL to PostgreSQL with enhanced features\nand modern database design patterns.\n\nUsage:\n  gms-migrate [command]\n\nAvailable Commands:\n  completion  Generate the autocompletion script for the specified shell\n  help        Help about any command\n  migrate     Run the complete database migration\n  validate    Validate the migration setup and connectivity\n  version     Show version information\n\nFlags:\n  -h, --help     help for gms-migrate\n  -v, --verbose  enable verbose logging\n\nUse \"gms-migrate [command] --help\" for more information about a command.\n</code></pre>"},{"location":"installation/#post-installation-setup","title":"Post-Installation Setup","text":""},{"location":"installation/#1-database-schema-setup","title":"1. Database Schema Setup","text":"<p>Before running the migration, ensure the PostgreSQL schema is set up:</p> <pre><code># Apply the database migrations to create the schema\n# (This assumes you have a schema migration tool or SQL files)\npsql -h your-postgres-host -U your-username -d your-database -f db/migrations/000001_initial.up.sql\npsql -h your-postgres-host -U your-username -d your-database -f db/migrations/000002_contact_log.up.sql\n</code></pre>"},{"location":"installation/#2-configuration-setup","title":"2. Configuration Setup","text":"<p>Create your configuration file. See the Configuration guide for detailed instructions.</p>"},{"location":"installation/#3-test-database-connectivity","title":"3. Test Database Connectivity","text":"<p>Validate that you can connect to both databases:</p> <pre><code>./gms-migrate validate\n</code></pre> <p>This command will: - Test MySQL database connectivity - Test PostgreSQL database connectivity - Verify schema compatibility - Check for any configuration issues</p>"},{"location":"installation/#installation-verification","title":"Installation Verification","text":""},{"location":"installation/#complete-installation-check","title":"Complete Installation Check","text":"<p>Run through this checklist to ensure everything is properly installed:</p> <ul> <li>[ ] Go 1.21+ is installed and working</li> <li>[ ] Migration tool builds without errors</li> <li>[ ] Help command shows available options</li> <li>[ ] MySQL database is accessible</li> <li>[ ] PostgreSQL database is accessible with the new schema</li> <li>[ ] Configuration is properly set up</li> <li>[ ] <code>validate</code> command runs successfully</li> </ul>"},{"location":"installation/#common-installation-issues","title":"Common Installation Issues","text":""},{"location":"installation/#go-build-errors","title":"Go Build Errors","text":"<p>Issue: Build fails with dependency errors <pre><code>go: module example.com/migration requires go 1.21 or later\n</code></pre></p> <p>Solution: Update Go to version 1.21 or later</p>"},{"location":"installation/#database-connection-issues","title":"Database Connection Issues","text":"<p>Issue: Cannot connect to databases during validation <pre><code>Error: failed to connect to MySQL: dial tcp: connect: connection refused\n</code></pre></p> <p>Solutions: 1. Verify database server is running 2. Check network connectivity 3. Verify credentials and connection strings 4. Check firewall settings</p>"},{"location":"installation/#permission-issues","title":"Permission Issues","text":"<p>Issue: Binary cannot be executed <pre><code>permission denied: ./gms-migrate\n</code></pre></p> <p>Solution: Make the binary executable <pre><code>chmod +x gms-migrate\n</code></pre></p>"},{"location":"installation/#memory-issues-during-build","title":"Memory Issues During Build","text":"<p>Issue: Build fails due to insufficient memory <pre><code>runtime: out of memory: cannot allocate\n</code></pre></p> <p>Solutions: 1. Close other applications to free memory 2. Use a machine with more RAM 3. Build with optimizations: <code>go build -ldflags=\"-s -w\"</code></p>"},{"location":"installation/#development-installation","title":"Development Installation","text":"<p>If you plan to modify or contribute to the migration tool:</p>"},{"location":"installation/#1-install-development-tools","title":"1. Install Development Tools","text":"<pre><code># Install common Go development tools\ngo install golang.org/x/tools/cmd/goimports@latest\ngo install github.com/golangci/golangci-lint/cmd/golangci-lint@latest\n</code></pre>"},{"location":"installation/#2-set-up-pre-commit-hooks","title":"2. Set Up Pre-commit Hooks","text":"<pre><code># Format code before committing\ngit config core.hooksPath .githooks\n</code></pre>"},{"location":"installation/#3-run-tests","title":"3. Run Tests","text":"<pre><code># Run all tests\ngo test ./...\n\n# Run tests with coverage\ngo test -cover ./...\n\n# Run specific test packages\ngo test ./migrate/...\n</code></pre>"},{"location":"installation/#4-development-build","title":"4. Development Build","text":"<p>For development, you can run without building:</p> <pre><code># Run directly with go run\ngo run main.go --help\ngo run main.go validate\ngo run main.go migrate\n</code></pre>"},{"location":"installation/#docker-installation-optional","title":"Docker Installation (Optional)","text":"<p>For containerized deployment:</p>"},{"location":"installation/#1-create-dockerfile","title":"1. Create Dockerfile","text":"<pre><code>FROM golang:1.21-alpine AS builder\n\nWORKDIR /app\nCOPY go.mod go.sum ./\nRUN go mod download\n\nCOPY . .\nRUN go build -o gms-migrate ./main.go\n\nFROM alpine:latest\nRUN apk --no-cache add ca-certificates\nWORKDIR /root/\n\nCOPY --from=builder /app/gms-migrate .\nCMD [\"./gms-migrate\"]\n</code></pre>"},{"location":"installation/#2-build-docker-image","title":"2. Build Docker Image","text":"<pre><code>docker build -t gms-migrate .\n</code></pre>"},{"location":"installation/#3-run-with-docker","title":"3. Run with Docker","text":"<pre><code>docker run --rm -v $(pwd)/config:/config gms-migrate migrate\n</code></pre>"},{"location":"installation/#next-steps","title":"Next Steps","text":"<p>After successful installation:</p> <ol> <li>Configure the migration tool with your database settings</li> <li>Validate your setup before running the migration  </li> <li>Run the migration on a test environment first</li> <li>Review the troubleshooting guide for common issues</li> </ol> <p>With the migration tool properly installed, you're ready to configure and run your database migration.</p>"},{"location":"migration-overview/","title":"Migration Overview","text":"<p>The GMS Database Migration Tool performs a comprehensive migration from MySQL to PostgreSQL, transforming 23 major data entities with enhanced features and modern database design patterns.</p>"},{"location":"migration-overview/#migration-process-flow","title":"Migration Process Flow","text":"<p>The migration tool performs the following steps in order:</p> <pre><code>graph TD\n    A[Organizations] --&gt; B[Persons]\n    B --&gt; C[Addresses]\n    C --&gt; D[Social Media]\n    D --&gt; E[Email Addresses]\n    E --&gt; F[Phone Numbers]\n    F --&gt; G[Contact Preferences]\n    G --&gt; H[Events]\n    H --&gt; I[Participates]\n    I --&gt; J[Finance]\n    J --&gt; K[Charges and Payments]\n    K --&gt; L[Family]\n    L --&gt; M[Education]\n    M --&gt; N[Employment]\n    N --&gt; O[Prospect]\n    O --&gt; P[Volunteer]\n    P --&gt; Q[Feasibility Campaign Info]\n    Q --&gt; R[Hall of Fame]\n    R --&gt; S[Man of Year]\n    S --&gt; T[Leadership]\n    T --&gt; U[Donor Status]\n    U --&gt; V[Key Players]\n    V --&gt; W[Contact Log]\n</code></pre>"},{"location":"migration-overview/#detailed-migration-steps","title":"Detailed Migration Steps","text":""},{"location":"migration-overview/#1-core-entities-foundation","title":"1. Core Entities (Foundation)","text":"Step MySQL Table PostgreSQL Table Description 1 <code>Donor_Group</code> <code>organization</code> Organization data with enhanced structure 2 <code>Donor</code> <code>person</code> Core person/donor information with UUID mapping 3 <code>Address</code> <code>address</code>, <code>contact</code> Address data with international support"},{"location":"migration-overview/#2-contact-information","title":"2. Contact Information","text":"Step MySQL Source PostgreSQL Table Description 4 <code>Donor</code> (social fields) <code>social_media</code> Social media profiles and preferences 5 Email data <code>contact</code> Email addresses with validation 6 Phone data <code>contact</code> Phone numbers with normalization 7 Contact preferences <code>contact_preferences</code> Communication preferences"},{"location":"migration-overview/#3-events-and-participation","title":"3. Events and Participation","text":"Step MySQL Table PostgreSQL Table Description 8 <code>Event</code> <code>event</code> Event information with organization mapping 9 <code>Participates</code> <code>participates</code> Event attendance with enhanced tracking"},{"location":"migration-overview/#4-financial-data","title":"4. Financial Data","text":"Step MySQL Table PostgreSQL Table Description 10 <code>Finance</code> <code>finance</code> Gift and pledge information 11 <code>Charge</code>, <code>Payment</code> <code>transaction</code> Combined financial transactions"},{"location":"migration-overview/#5-relationships-and-history","title":"5. Relationships and History","text":"Step MySQL Table PostgreSQL Table Description 12 <code>Family</code> <code>family</code> Family and relationship data 13 <code>Schools</code> <code>education</code> Education history and achievements 14 <code>Job</code> <code>employment</code> Employment history and positions"},{"location":"migration-overview/#6-campaign-and-volunteer-data","title":"6. Campaign and Volunteer Data","text":"Step MySQL Table PostgreSQL Table Description 15 <code>Prospect</code> <code>prospect</code> Campaign prospect information 16 <code>Volunteer</code> <code>volunteer</code> Volunteer roles and activities 17 <code>Feasibility_Campaign_Info</code> <code>feasibility_campaign_info</code> Campaign feasibility data"},{"location":"migration-overview/#7-recognition-and-awards","title":"7. Recognition and Awards","text":"Step MySQL Table PostgreSQL Table Description 18 <code>Hall_Of_Fame</code> <code>hall_of_fame</code> Hall of fame records 19 <code>Man_Of_Year</code> <code>man_of_year</code> Man of the year awards 20 <code>Leadership</code> <code>leadership</code> Leadership roles and positions 21 <code>Donor_Status</code> <code>donor_status</code> Donor recognition status 22 <code>Key_Players</code> <code>key_players</code> Key player designations"},{"location":"migration-overview/#8-enhanced-contact-tracking","title":"8. Enhanced Contact Tracking","text":"Step MySQL Table PostgreSQL Table Description 23 <code>Contacted</code> <code>contact_log</code> Enhanced contact tracking with follow-up management"},{"location":"migration-overview/#migration-features","title":"Migration Features","text":""},{"location":"migration-overview/#data-integrity","title":"Data Integrity","text":"<ul> <li>Foreign Key Validation: Ensures all relationships are maintained</li> <li>ID Mapping: Robust mapping from MySQL auto-increment to PostgreSQL UUIDs</li> <li>Data Validation: Validates email addresses, phone numbers, and other critical data</li> <li>Error Recovery: Checkpoint recovery allows resuming interrupted migrations</li> </ul>"},{"location":"migration-overview/#performance-optimization","title":"Performance Optimization","text":"<ul> <li>Batch Processing: Configurable batch sizes for memory optimization</li> <li>Strategic Indexing: Indexes are created after data migration for optimal performance</li> <li>Progress Tracking: Real-time progress bars and detailed logging</li> <li>Memory Management: Efficient memory usage for large datasets</li> </ul>"},{"location":"migration-overview/#enhanced-features","title":"Enhanced Features","text":""},{"location":"migration-overview/#international-support","title":"International Support","text":"<ul> <li>Enhanced address validation for non-US addresses</li> <li>Improved phone number normalization</li> <li>Support for international postal codes and formats</li> </ul>"},{"location":"migration-overview/#contact-log-enhancements","title":"Contact Log Enhancements","text":"<ul> <li>Outcome Tracking: Track contact results (successful, no answer, callback needed, etc.)</li> <li>Follow-up Management: Schedule and track follow-up activities</li> <li>Duration Tracking: Record call and meeting durations</li> <li>Audit Trail: Complete history with created/updated timestamps</li> </ul>"},{"location":"migration-overview/#modern-postgresql-features","title":"Modern PostgreSQL Features","text":"<ul> <li>UUID Primary Keys: Better for distributed systems and data security</li> <li>Custom Enums: Type-safe enumeration values</li> <li>Timezone Support: Proper timestamp handling with timezone awareness</li> <li>Advanced Constraints: Enhanced data validation at the database level</li> </ul>"},{"location":"migration-overview/#error-handling-and-recovery","title":"Error Handling and Recovery","text":""},{"location":"migration-overview/#checkpoint-system","title":"Checkpoint System","text":"<p>The migration tool includes a checkpoint recovery system that allows you to:</p> <ul> <li>Resume migrations from the last successful step</li> <li>Skip already-migrated data</li> <li>Handle partial failures gracefully</li> </ul>"},{"location":"migration-overview/#error-reporting","title":"Error Reporting","text":"<ul> <li>Detailed error logs with specific record information</li> <li>Progress tracking with success/failure counts</li> <li>Foreign key violation reporting</li> <li>Data validation error details</li> </ul>"},{"location":"migration-overview/#recovery-options","title":"Recovery Options","text":"<ul> <li>Rollback capabilities for each migration step</li> <li>Data verification tools</li> <li>Integrity check utilities</li> </ul>"},{"location":"migration-overview/#validation-and-testing","title":"Validation and Testing","text":""},{"location":"migration-overview/#pre-migration-validation","title":"Pre-Migration Validation","text":"<ul> <li>Database connectivity checks</li> <li>Schema compatibility verification</li> <li>Dependency validation</li> </ul>"},{"location":"migration-overview/#post-migration-validation","title":"Post-Migration Validation","text":"<ul> <li>Data integrity checks</li> <li>Foreign key constraint validation</li> <li>Record count verification</li> <li>Sample data comparison</li> </ul>"},{"location":"migration-overview/#testing-recommendations","title":"Testing Recommendations","text":"<p>Testing Best Practices</p> <ol> <li>Test on a copy of production data first</li> <li>Verify data integrity after each major step</li> <li>Compare record counts between source and target</li> <li>Test application functionality with migrated data</li> <li>Validate relationships and foreign key constraints</li> </ol> <p>The migration process is designed to be robust, resumable, and provides comprehensive validation to ensure data integrity throughout the transformation.</p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<p>This guide helps you diagnose and resolve common issues when using the GMS Database Migration Tool.</p>"},{"location":"troubleshooting/#quick-diagnosis","title":"Quick Diagnosis","text":""},{"location":"troubleshooting/#check-migration-status","title":"Check Migration Status","text":"<pre><code># Check if migration tool is working\n./gms-migrate --version\n\n# Test database migration\n./gms-migrate validate\n</code></pre>"},{"location":"troubleshooting/#common-error-patterns","title":"Common Error Patterns","text":"Error Pattern Likely Cause Quick Fix <code>connection refused</code> Database not running or network issue Check database status and connectivity <code>authentication failed</code> Wrong credentials Verify username/password <code>database does not exist</code> Target database not created Create database and apply schema <code>foreign key constraint</code> Missing referenced records Check migration order and data integrity <code>out of memory</code> Insufficient system memory Reduce batch size <code>timeout</code> Network latency or database load Increase timeout values"},{"location":"troubleshooting/#database-connection-issues","title":"Database Connection Issues","text":""},{"location":"troubleshooting/#mysql-connection-problems","title":"MySQL Connection Problems","text":""},{"location":"troubleshooting/#problem-connection-refused","title":"Problem: Connection Refused","text":"<pre><code>Error: dial tcp 127.0.0.1:3306: connect: connection refused\n</code></pre> <p>Diagnosis Steps: <pre><code># Check if MySQL is running\nsudo systemctl status mysql\n# or on macOS\nbrew services list | grep mysql\n\n# Test direct connection\nmysql -h localhost -u username -p database_name\n\n# Check MySQL port\nnetstat -tuln | grep 3306\n</code></pre></p> <p>Solutions: 1. Start MySQL Service <pre><code># Linux\nsudo systemctl start mysql\n\n# macOS\nbrew services start mysql\n\n# Windows\nnet start mysql\n</code></pre></p> <ol> <li> <p>Check MySQL Configuration <pre><code># Check MySQL config\nmysql --help | grep -A 1 \"Default options\"\n\n# Verify bind-address in my.cnf\ngrep bind-address /etc/mysql/mysql.conf.d/mysqld.cnf\n</code></pre></p> </li> <li> <p>Firewall Issues <pre><code># Check firewall (Linux)\nsudo ufw status\nsudo ufw allow 3306\n\n# Check firewall (macOS)\nsudo pfctl -sr | grep 3306\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#problem-authentication-failed","title":"Problem: Authentication Failed","text":"<pre><code>Error: Access denied for user 'username'@'host' (using password: YES)\n</code></pre> <p>Solutions: 1. Verify Credentials <pre><code># Test credentials directly\nmysql -h hostname -u username -p database_name\n</code></pre></p> <ol> <li> <p>Check User Permissions <pre><code>-- In MySQL as root\nSELECT user, host FROM mysql.user WHERE user = 'your_username';\nSHOW GRANTS FOR 'your_username'@'your_host';\n\n-- Grant necessary permissions\nGRANT SELECT ON database_name.* TO 'username'@'host';\nFLUSH PRIVILEGES;\n</code></pre></p> </li> <li> <p>Password Issues <pre><code>-- Reset password\nALTER USER 'username'@'host' IDENTIFIED BY 'new_password';\nFLUSH PRIVILEGES;\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#postgresql-connection-problems","title":"PostgreSQL Connection Problems","text":""},{"location":"troubleshooting/#problem-connection-refused_1","title":"Problem: Connection Refused","text":"<pre><code>Error: dial tcp 127.0.0.1:5432: connect: connection refused\n</code></pre> <p>Diagnosis Steps: <pre><code># Check if PostgreSQL is running\nsudo systemctl status postgresql\n# or on macOS\nbrew services list | grep postgresql\n\n# Test direct connection\npsql -h localhost -U username -d database_name\n\n# Check PostgreSQL port\nnetstat -tuln | grep 5432\n</code></pre></p> <p>Solutions: 1. Start PostgreSQL Service <pre><code># Linux\nsudo systemctl start postgresql\n\n# macOS\nbrew services start postgresql\n\n# Windows\nnet start postgresql\n</code></pre></p> <ol> <li>Check PostgreSQL Configuration <pre><code># Find config file\nsudo -u postgres psql -c \"SHOW config_file;\"\n\n# Check listen_addresses\ngrep listen_addresses /etc/postgresql/*/main/postgresql.conf\n\n# Check pg_hba.conf for authentication\nsudo -u postgres cat /etc/postgresql/*/main/pg_hba.conf\n</code></pre></li> </ol>"},{"location":"troubleshooting/#problem-database-does-not-exist","title":"Problem: Database Does Not Exist","text":"<pre><code>Error: database \"gms\" does not exist\n</code></pre> <p>Solutions: 1. Create Database <pre><code># Create database\ncreatedb -U postgres gms\n\n# Or via psql\npsql -U postgres -c \"CREATE DATABASE gms;\"\n</code></pre></p> <ol> <li>Apply Schema <pre><code># Apply migration files\npsql -U postgres -d gms -f db/migrations/000001_initial.up.sql\npsql -U postgres -d gms -f db/migrations/000002_contact_log.up.sql\n</code></pre></li> </ol>"},{"location":"troubleshooting/#problem-ssltls-issues","title":"Problem: SSL/TLS Issues","text":"<pre><code>Error: SSL is not enabled on the server\n</code></pre> <p>Solutions: 1. Disable SSL for Development <pre><code># Update connection string\nexport POSTGRES_DSN=\"postgres://user:pass@host:5432/db?sslmode=disable\"\n</code></pre></p> <ol> <li>Configure SSL (Production) <pre><code># In postgresql.conf\nssl = on\nssl_cert_file = 'path/to/cert.pem'\nssl_key_file = 'path/to/key.pem'\n</code></pre></li> </ol>"},{"location":"troubleshooting/#migration-runtime-issues","title":"Migration Runtime Issues","text":""},{"location":"troubleshooting/#memory-issues","title":"Memory Issues","text":""},{"location":"troubleshooting/#problem-out-of-memory","title":"Problem: Out of Memory","text":"<pre><code>Error: runtime: out of memory: cannot allocate\n</code></pre> <p>Solutions: 1. Close Other Applications <pre><code># Check memory usage\nfree -h\ntop -o %MEM\n\n# Monitor migration memory usage\ntop -p $(pgrep gms-migrate)\n</code></pre></p> <ol> <li>Increase System Memory</li> <li>Add more RAM to the system</li> <li>Use a machine with more memory</li> <li>Consider running migration on a dedicated server</li> </ol>"},{"location":"troubleshooting/#problem-database-memory-issues","title":"Problem: Database Memory Issues","text":"<pre><code>Error: server closed the connection unexpectedly\n</code></pre> <p>Solutions: 1. PostgreSQL Memory Configuration <pre><code># In postgresql.conf\nshared_buffers = 256MB\nwork_mem = 8MB\nmaintenance_work_mem = 64MB\neffective_cache_size = 1GB\n</code></pre></p> <ol> <li>MySQL Memory Configuration <pre><code># In my.cnf\ninnodb_buffer_pool_size = 512M\nsort_buffer_size = 2M\nread_buffer_size = 2M\n</code></pre></li> </ol>"},{"location":"troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"troubleshooting/#problem-migration-running-too-slowly","title":"Problem: Migration Running Too Slowly","text":"<pre><code>Migration progress: 2% after 30 minutes\n</code></pre> <p>Diagnosis: <pre><code># Check system resources\nhtop\niostat -x 1\niotop\n\n# Check database performance\n# PostgreSQL\nSELECT * FROM pg_stat_activity;\n\n# MySQL\nSHOW PROCESSLIST;\n</code></pre></p> <p>Solutions: 1. Database Optimization <pre><code>-- PostgreSQL: Temporarily disable autovacuum\nALTER SYSTEM SET autovacuum = off;\nSELECT pg_reload_conf();\n\n-- Re-enable after migration\nALTER SYSTEM SET autovacuum = on;\nSELECT pg_reload_conf();\n</code></pre></p>"},{"location":"troubleshooting/#problem-network-timeouts","title":"Problem: Network Timeouts","text":"<pre><code>Error: context deadline exceeded\n</code></pre> <p>Solutions: 1. Network Optimization <pre><code># Check network latency\nping database_host\n\n# Use local network when possible\n# Avoid running over WAN connections\n</code></pre></p>"},{"location":"troubleshooting/#data-integrity-issues","title":"Data Integrity Issues","text":""},{"location":"troubleshooting/#problem-foreign-key-violations","title":"Problem: Foreign Key Violations","text":"<pre><code>Error: insert or update on table \"address\" violates foreign key constraint\n</code></pre> <p>Diagnosis: <pre><code>-- Check for orphaned records\nSELECT COUNT(*) FROM address a\nLEFT JOIN person p ON a.person_id = p.id\nWHERE p.id IS NULL;\n</code></pre></p> <p>Solutions: 1. Manual Data Cleanup <pre><code>-- Remove orphaned records from source\nDELETE FROM mysql.Address\nWHERE donor_id NOT IN (SELECT donor_id FROM mysql.Donor);\n</code></pre></p>"},{"location":"troubleshooting/#problem-data-type-conversion-errors","title":"Problem: Data Type Conversion Errors","text":"<pre><code>Error: invalid input value for enum person_status_enum: \"Unknown\"\n</code></pre> <p>Solutions: 1. Check Source Data <pre><code>-- Find invalid enum values\nSELECT DISTINCT status FROM mysql.Donor\nWHERE status NOT IN ('Active', 'In-active', 'Lost', 'Deceased');\n</code></pre></p> <ol> <li>Add Custom Mapping <pre><code># The migration tool should handle this automatically\n# Check logs for mapping details\n./gms-migrate migrate --verbose --log-level debug\n</code></pre></li> </ol>"},{"location":"troubleshooting/#configuration-issues","title":"Configuration Issues","text":""},{"location":"troubleshooting/#problem-configuration-file-not-found","title":"Problem: Configuration File Not Found","text":"<pre><code>Error: config file not found: .gms-migrate.toml\n</code></pre> <p>Solutions: 1. Create Configuration File <pre><code># Create basic config\ncat &gt; gms-migrate.toml &lt;&lt; EOF\n[mysql]\ndsn = \"user:pass@tcp(localhost:3306)/fmg\"\n\n[postgres]\ndsn = \"postgres://user:pass@localhost:5432/gms\"\n\nEOF\n</code></pre></p> <ol> <li> <p>Use Environment Variables <pre><code># Set required environment variables\nexport MYSQL_DSN=\"user:pass@tcp(localhost:3306)/fmg\"\nexport POSTGRES_DSN=\"postgres://user:pass@localhost:5432/gms\"\n\n# Run without config file\n./gms-migrate migrate\n</code></pre></p> </li> <li> <p>Specify Custom Config Path <pre><code># Use custom config location\n./gms-migrate migrate --config /path/to/config.toml\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#problem-environment-variables-not-working","title":"Problem: Environment Variables Not Working","text":"<pre><code>Error: required configuration missing\n</code></pre> <p>Solutions: 1. Verify Environment Variables <pre><code># Check if variables are set\nenv | grep -E \"(MYSQL|POSTGRES)\"\n\n# Set missing variables\nexport MYSQL_DSN=\"your_mysql_connection\"\nexport POSTGRES_DSN=\"your_postgres_connection\"\n</code></pre></p> <ol> <li>Use .env File <pre><code># Create .env file\ncat &gt; .env &lt;&lt; EOF\nMYSQL_DSN=user:pass@tcp(localhost:3306)/fmg\nPOSTGRES_DSN=postgres://user:pass@localhost:5432/gms\nEOF\n\n# Source the file\nsource .env\n./gms-migrate migrate\n</code></pre></li> </ol>"},{"location":"troubleshooting/#schema-issues","title":"Schema Issues","text":""},{"location":"troubleshooting/#problem-table-does-not-exist","title":"Problem: Table Does Not Exist","text":"<pre><code>Error: relation \"person\" does not exist\n</code></pre> <p>Solutions: 1. Apply Schema Migrations <pre><code># Apply PostgreSQL schema\npsql -d gms -f db/migrations/000001_initial.up.sql\npsql -d gms -f db/migrations/000002_contact_log.up.sql\n</code></pre></p> <ol> <li>Verify Schema Application <pre><code>-- Check if tables exist\n\\dt\n\n-- Check specific table\n\\d person\n</code></pre></li> </ol>"},{"location":"troubleshooting/#problem-column-does-not-exist","title":"Problem: Column Does Not Exist","text":"<pre><code>Error: column \"contact_preferences\" of relation \"person\" does not exist\n</code></pre> <p>Solutions: 1. Check Schema Version <pre><code>-- Check applied migrations\nSELECT * FROM schema_migrations;\n</code></pre></p> <ol> <li>Manually Add Missing Columns <pre><code>-- Add missing column\nALTER TABLE person ADD COLUMN contact_preferences JSONB;\n</code></pre></li> </ol>"},{"location":"troubleshooting/#recovery-and-rollback","title":"Recovery and Rollback","text":""},{"location":"troubleshooting/#problem-migration-partially-completed","title":"Problem: Migration Partially Completed","text":"<pre><code>Migration stopped at step 15/23\n</code></pre> <p>Solutions: 1. Resume from Checkpoint <pre><code># Resume migration\n./gms-migrate migrate --resume\n\n# Check checkpoint status\ncat migration_checkpoint.json\n</code></pre></p> <ol> <li>Start Specific Step <pre><code># Start from specific step\n./gms-migrate migrate --start-from-step 16\n</code></pre></li> </ol>"},{"location":"troubleshooting/#problem-need-to-rollback-migration","title":"Problem: Need to Rollback Migration","text":"<pre><code>Migration completed but data is incorrect\n</code></pre> <p>Solutions: 1. Restore from Backup <pre><code># Restore PostgreSQL from backup\npg_restore -d gms backup_before_migration.sql\n\n# Or from SQL dump\npsql gms &lt; backup_before_migration.sql\n</code></pre></p> <ol> <li>Partial Rollback <pre><code># Clear specific tables and re-migrate\npsql gms -c \"TRUNCATE TABLE contact_log CASCADE;\"\n./gms-migrate migrate --start-from-step 23\n</code></pre></li> </ol>"},{"location":"troubleshooting/#debugging-tools","title":"Debugging Tools","text":""},{"location":"troubleshooting/#database-query-logging","title":"Database Query Logging","text":""},{"location":"troubleshooting/#postgresql","title":"PostgreSQL","text":"<pre><code>-- Enable query logging\nALTER SYSTEM SET log_statement = 'all';\nSELECT pg_reload_conf();\n\n-- Check logs\ntail -f /var/log/postgresql/postgresql-*-main.log\n</code></pre>"},{"location":"troubleshooting/#mysql","title":"MySQL","text":"<pre><code>-- Enable query logging\nSET GLOBAL general_log = 'ON';\nSET GLOBAL log_output = 'table';\n\n-- View query log\nSELECT * FROM mysql.general_log\nWHERE command_type = 'Query'\nORDER BY event_time DESC\nLIMIT 20;\n</code></pre>"},{"location":"troubleshooting/#system-monitoring","title":"System Monitoring","text":"<pre><code># Monitor system resources\nhtop\n\n# Monitor disk I/O\niotop -o\n\n# Monitor network\niftop\n\n# Database-specific monitoring\npg_top              # PostgreSQL\nmytop              # MySQL\n</code></pre>"},{"location":"troubleshooting/#getting-help","title":"Getting Help","text":""},{"location":"troubleshooting/#information-to-collect","title":"Information to Collect","text":"<p>When seeking help, provide:</p> <ol> <li>Error Message: Complete error output</li> <li>Configuration: Sanitized config file or environment variables</li> <li>Migration Step: Which step failed</li> <li>System Info: OS, memory, disk space</li> <li>Database Versions: MySQL and PostgreSQL versions</li> <li>Migration Logs: Relevant log entries</li> </ol> <p>Most migration issues can be resolved by checking database connectivity, verifying configuration, and ensuring proper schema setup. When in doubt, start with the validation command and work through issues systematically.</p>"},{"location":"usage/","title":"Running Migration","text":"<p>This guide covers how to execute the GMS database migration from MySQL to PostgreSQL.</p>"},{"location":"usage/#pre-migration-checklist","title":"Pre-Migration Checklist","text":"<p>Before running the migration, ensure you have completed the following:</p> <ul> <li>[ ] Backup databases - Both MySQL source and PostgreSQL target</li> <li>[ ] Schema applied - PostgreSQL target has the new schema</li> <li>[ ] Configuration verified - Database connections tested</li> <li>[ ] Validation passed - <code>./gms-migrate validate</code> runs successfully</li> <li>[ ] Test environment - Tested on non-production data first</li> </ul> <p>Critical: Backup Your Data</p> <p>Always backup your PostgreSQL target database before running the migration. While the tool is designed to be safe, backups are essential for production environments.</p>"},{"location":"usage/#basic-migration","title":"Basic Migration","text":""},{"location":"usage/#simple-migration","title":"Simple Migration","text":"<p>Run the complete migration with default settings:</p> <pre><code># Navigate to the migration tool directory\ncd /Users/jdf/Developer/gms/db\n\n# Set credentials\nexport MYSQL_DSN=\"user:pass@tcp(host:3306)/db\"\nexport POSTGRES_DSN=\"postgres://user:pass@host:5432/db\"\n\n# Run the migration\n./gms-migrate migrate\n</code></pre>"},{"location":"usage/#migration-with-custom-configuration","title":"Migration with Custom Configuration","text":"<pre><code># Using a custom configuration file\n./gms-migrate migrate --config production.toml\n\n# Using environment variables\nMYSQL_DSN=\"user:pass@tcp(host:3306)/db\" \\\nPOSTGRES_DSN=\"postgres://user:pass@host:5432/db\" \\\n./gms-migrate migrate\n\n# Using command-line flags\n./gms-migrate migrate \\\n  --mysql-dsn \"user:pass@tcp(localhost:3306)/fmg\" \\\n  --postgres-dsn \"postgres://user:pass@localhost:5432/gms\" \\\n  --batch-size 2000 \\\n  --log-progress\n</code></pre>"},{"location":"usage/#migration-options","title":"Migration Options","text":""},{"location":"usage/#verbose-logging","title":"Verbose Logging","text":"<p>Enable detailed logging for troubleshooting:</p> <pre><code># Enable verbose output\n./gms-migrate migrate --verbose\n\n# Set specific log level\n./gms-migrate migrate --log-level debug\n\n# Output logs to file\n./gms-migrate migrate --verbose --log-file migration.log\n</code></pre>"},{"location":"usage/#migration-process","title":"Migration Process","text":""},{"location":"usage/#real-time-progress","title":"Real-Time Progress","text":"<p>During migration, you'll see progress bars for each step:</p> <pre><code>\ud83d\ude80 Starting GMS Database Migration\n\n\u2705 Step 1/23: Organizations\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 100% | 1,234/1,234 | 2s\n\n\u2705 Step 2/23: Persons\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 100% | 45,678/45,678 | 15s\n\n\ud83d\udd04 Step 3/23: Addresses\n\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591\u2591 67% | 30,456/45,123 | ETA: 8s\n\n\u23f1\ufe0f  Elapsed: 2m 15s | Estimated Total: 8m 30s\n</code></pre>"},{"location":"usage/#migration-steps","title":"Migration Steps","text":"<p>The migration executes in this order:</p> <ol> <li>Organizations - Base organization data</li> <li>Persons - Core person/donor information</li> <li>Addresses - Address data with international support</li> <li>Social Media - Social media profiles</li> <li>Email Addresses - Email contact information</li> <li>Phone Numbers - Phone contact information</li> <li>Contact Preferences - Communication preferences</li> <li>Events - Event information</li> <li>Participates - Event attendance records</li> <li>Finance - Financial gifts and pledges</li> <li>Charges and Payments - Transaction records</li> <li>Family - Family relationships</li> <li>Education - Education history</li> <li>Employment - Employment records</li> <li>Prospect - Campaign prospects</li> <li>Volunteer - Volunteer information</li> <li>Feasibility Campaign Info - Campaign data</li> <li>Hall of Fame - Recognition records</li> <li>Man of Year - Award information</li> <li>Leadership - Leadership roles</li> <li>Donor Status - Recognition status</li> <li>Key Players - Key player designations</li> <li>Contact Log - Enhanced contact tracking</li> </ol>"},{"location":"usage/#checkpoint-recovery","title":"Checkpoint Recovery","text":""},{"location":"usage/#automatic-checkpointing","title":"Automatic Checkpointing","text":"<p>The migration tool automatically creates checkpoints:</p> <ul> <li>Checkpoint Interval: Every step</li> <li>Checkpoint File: <code>./migration_checkpoint.json</code></li> <li>Recovery: Automatic on restart</li> </ul>"},{"location":"usage/#validation","title":"Validation","text":""},{"location":"usage/#post-migration-validation","title":"Post-Migration Validation","text":"<p>After migration, verify data integrity:</p> <pre><code># Run post-migration validation\n./gms-migrate validate\n</code></pre>"},{"location":"usage/#database-performance","title":"Database Performance","text":"<pre><code># PostgreSQL activity\nSELECT * FROM pg_stat_activity WHERE application_name LIKE '%gms-migrate%';\n\n# MySQL processlist\nSHOW PROCESSLIST;\n</code></pre>"},{"location":"usage/#error-handling","title":"Error Handling","text":""},{"location":"usage/#error-recovery","title":"Error Recovery","text":"<p>The migration tool handles errors gracefully:</p>"},{"location":"usage/#automatic-retry","title":"Automatic Retry","text":"<ul> <li>Network Issues: Automatic retry with backoff</li> <li>Temporary Locks: Waits and retries</li> <li>Connection Drops: Reconnects automatically</li> </ul>"},{"location":"usage/#common-error-scenarios","title":"Common Error Scenarios","text":""},{"location":"usage/#foreign-key-violations","title":"Foreign Key Violations","text":"<pre><code>Error: Foreign key constraint violation in table 'address'\nRecord ID: 12345\nCause: Referenced person_id does not exist\nAction: Skipping record, logged to error file\n</code></pre> <p>Resolution: Check person migration completed successfully</p>"},{"location":"usage/#data-type-conversion-errors","title":"Data Type Conversion Errors","text":"<pre><code>Error: Invalid date value in table 'contact_log'\nRecord ID: 67890\nValue: '0000-00-00'\nAction: Converting to NULL, continuing migration\n</code></pre> <p>Resolution: Review source data quality</p>"},{"location":"usage/#connection-timeouts","title":"Connection Timeouts","text":"<pre><code>Error: Connection timeout to PostgreSQL\nAction: Retrying connection (attempt 2/3)\n</code></pre> <p>Resolution: Check network connectivity and database load</p>"},{"location":"usage/#post-migration-tasks","title":"Post-Migration Tasks","text":""},{"location":"usage/#1-verification","title":"1. Verification","text":"<pre><code># Comprehensive post-migration check\n./gms-migrate validate --post-migration --verbose\n\n# Manual spot checks\npsql gms -c \"SELECT COUNT(*) FROM person;\"\npsql gms -c \"SELECT COUNT(*) FROM contact_log;\"\n</code></pre>"},{"location":"usage/#2-index-optimization","title":"2. Index Optimization","text":"<pre><code># Rebuild statistics (PostgreSQL)\npsql gms -c \"ANALYZE;\"\n\n# Rebuild indexes if needed\npsql gms -c \"REINDEX DATABASE gms;\"\n</code></pre>"},{"location":"usage/#3-application-testing","title":"3. Application Testing","text":"<ul> <li>Test application connectivity</li> <li>Verify data integrity in application</li> <li>Run application test suite</li> <li>Perform user acceptance testing</li> </ul>"},{"location":"usage/#4-cleanup","title":"4. Cleanup","text":"<pre><code># Remove checkpoint files\nrm migration_checkpoint.json\n\n# Remove old MySQL references (after verification)\n# Keep MySQL database for rollback period\n</code></pre>"},{"location":"usage/#migration-completion","title":"Migration Completion","text":""},{"location":"usage/#success-indicators","title":"Success Indicators","text":"<p>\u2705 Migration completed successfully when: - All 23 steps complete without errors - Record counts match between source and target - Foreign key constraints are satisfied - Application connects and functions properly - Post-migration validation passes</p>"},{"location":"usage/#final-steps","title":"Final Steps","text":"<ol> <li>Document Migration</li> <li>Record completion time</li> <li>Note any issues encountered</li> <li> <p>Update application configuration</p> </li> <li> <p>Monitor Application</p> </li> <li>Watch for performance issues</li> <li>Monitor error logs</li> <li> <p>Verify user functionality</p> </li> <li> <p>Plan MySQL Decommission</p> </li> <li>Keep MySQL for rollback period (30+ days)</li> <li>Plan eventual MySQL shutdown</li> <li>Update backup procedures</li> </ol> <p>The migration process is designed to be robust and recoverable. Take time to understand each step and always test in a non-production environment first.</p>"},{"location":"reference/non-migrated-tables/","title":"Non-Migrated Tables","text":"<p>This reference documents MySQL tables that are not migrated by the GMS Database Migration Tool, along with the reasons for exclusion and recommendations for handling their data if needed.</p>"},{"location":"reference/non-migrated-tables/#overview","title":"Overview","text":"<p>The migration tool focuses on core business data and excludes tables that fall into these categories:</p> <ul> <li>Auxiliary/Log Tables: Supporting tables not part of core business logic</li> <li>Legacy Tables: Deprecated or obsolete data structures</li> <li>Temporary Tables: Intermediate storage not needed in production</li> <li>Configuration Tables: System configuration not relevant to new schema</li> <li>Export/Report Tables: Generated data that can be recreated</li> </ul>"},{"location":"reference/non-migrated-tables/#complete-non-migrated-tables-list","title":"Complete Non-Migrated Tables List","text":""},{"location":"reference/non-migrated-tables/#system-and-configuration-tables","title":"System and Configuration Tables","text":"Table Name Reason Alternative Solution <code>Filters</code> Auxiliary table, not used in main application Recreate filters in new application <code>Data_Export</code> Export/log table, not needed in new schema Use PostgreSQL export tools <code>CsvConfig</code> Config/auxiliary, not required Configure export tools directly <code>Categories</code> Lookup/auxiliary, not required Implement categories in application logic <code>ContactTypes</code> Lookup/auxiliary, not required Use contact_type_enum in contact_log <code>Financial_Codes</code> Lookup/auxiliary, not required Implement in application or reference tables"},{"location":"reference/non-migrated-tables/#legacy-and-historical-tables","title":"Legacy and Historical Tables","text":"Table Name Reason Alternative Solution <code>Detail_Frat_Info</code> Legacy/auxiliary, not part of new schema Archive data separately if needed <code>General_Frat_Info</code> Legacy/auxiliary, not part of new schema Archive data separately if needed <code>FiveL_Temp_Storage</code> Temporary/intermediate, not migrated No action needed (temporary data) <code>ChapterAuxInfo</code> Auxiliary, not part of new schema Relevant data moved to chapter_group"},{"location":"reference/non-migrated-tables/#log-and-history-tables","title":"Log and History Tables","text":"Table Name Reason Alternative Solution <code>Member_Log</code> Log/history, not migrated Use PostgreSQL audit triggers <code>Phone_Log</code> Log/history, not migrated Contact changes tracked in contact_log <code>Event_Log</code> Log/history, not migrated Use PostgreSQL audit system <code>Address_Verify</code> Verification/auxiliary, not part of main schema Implement address validation in application"},{"location":"reference/non-migrated-tables/#replaced-by-enhanced-tables","title":"Replaced by Enhanced Tables","text":"Table Name Reason Replacement <code>Contacted</code> Migrated to enhanced contact_log <code>contact_log</code> table with additional features <code>Phone</code> (non-primary) Only main phone migrated <code>contact</code> table with type='phone' <code>Email</code> (non-primary) Only main email migrated <code>contact</code> table with type='email'"},{"location":"reference/non-migrated-tables/#survey-and-form-data","title":"Survey and Form Data","text":"Table Name Reason Alternative Solution <code>Answer</code> Survey/auxiliary, not part of main schema Implement survey system separately"},{"location":"reference/non-migrated-tables/#detailed-analysis-by-category","title":"Detailed Analysis by Category","text":""},{"location":"reference/non-migrated-tables/#1-filter-and-search-tables","title":"1. Filter and Search Tables","text":""},{"location":"reference/non-migrated-tables/#filters","title":"<code>Filters</code>","text":"<p>Purpose: Stored user-defined search filters Why Not Migrated: Application-specific functionality Recommendation:  - Implement filter functionality in new application - Use PostgreSQL views for commonly used filters - Store user preferences in application database</p>"},{"location":"reference/non-migrated-tables/#categories","title":"<code>Categories</code>","text":"<p>Purpose: Categorization lookup table Why Not Migrated: Simple lookup functionality Recommendation: - Implement categories as enums or reference tables - Use application-level categorization - Consider PostgreSQL arrays for multi-category support</p>"},{"location":"reference/non-migrated-tables/#2-export-and-reporting-tables","title":"2. Export and Reporting Tables","text":""},{"location":"reference/non-migrated-tables/#data_export","title":"<code>Data_Export</code>","text":"<p>Purpose: Tracking data export operations Why Not Migrated: Operational data, not business data Recommendation: - Use PostgreSQL's built-in export capabilities - Implement export tracking in application logs - Use audit tables for export compliance</p> <p>Example PostgreSQL export: <pre><code>-- Export to CSV\nCOPY (SELECT * FROM person WHERE status = 'Active') \nTO '/tmp/active_persons.csv' CSV HEADER;\n\n-- Export with formatting\nCOPY (\n    SELECT first_name, last_name, status, created_at\n    FROM person \n    ORDER BY last_name\n) TO '/tmp/person_export.csv' CSV HEADER;\n</code></pre></p>"},{"location":"reference/non-migrated-tables/#csvconfig","title":"<code>CsvConfig</code>","text":"<p>Purpose: CSV export configuration Why Not Migrated: Configuration data, not business data Recommendation: - Configure exports in application settings - Use PostgreSQL COPY command options - Store export templates in application configuration</p>"},{"location":"reference/non-migrated-tables/#3-legacy-tables","title":"3. Legacy Tables","text":""},{"location":"reference/non-migrated-tables/#detail_frat_info-general_frat_info","title":"<code>Detail_Frat_Info</code> / <code>General_Frat_Info</code>","text":"<p>Purpose: Historical fraternity information Why Not Migrated: Legacy data structure, superseded by organization table Recommendation: - Archive data to separate backup - Extract relevant information to <code>organization</code> table if needed - Document historical data location for reference</p> <p>Example data extraction (if needed): <pre><code>-- Archive legacy data\nCREATE TABLE legacy_frat_info AS \nSELECT * FROM Detail_Frat_Info;\n\n-- Extract relevant data to organization\nINSERT INTO organization (name, type, description)\nSELECT DISTINCT \n    frat_name, \n    'Fraternity', \n    CONCAT('Legacy data from: ', legacy_table)\nFROM Detail_Frat_Info \nWHERE frat_name IS NOT NULL;\n</code></pre></p>"},{"location":"reference/non-migrated-tables/#4-log-tables","title":"4. Log Tables","text":""},{"location":"reference/non-migrated-tables/#member_log","title":"<code>Member_Log</code>","text":"<p>Purpose: Membership change history Why Not Migrated: Historical logging, replaced by audit system Recommendation: - Implement PostgreSQL audit triggers - Use temporal tables for history tracking - Store critical historical data in audit schema</p> <p>Example audit implementation: <pre><code>-- Create audit table\nCREATE TABLE person_audit (\n    audit_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    table_name TEXT NOT NULL,\n    operation TEXT NOT NULL,\n    old_values JSONB,\n    new_values JSONB,\n    changed_by TEXT,\n    changed_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- Audit trigger function\nCREATE OR REPLACE FUNCTION audit_trigger_function()\nRETURNS TRIGGER AS $$\nBEGIN\n    INSERT INTO person_audit (\n        table_name, operation, old_values, new_values, changed_by\n    ) VALUES (\n        TG_TABLE_NAME,\n        TG_OP,\n        CASE WHEN TG_OP = 'DELETE' THEN row_to_json(OLD) ELSE NULL END,\n        CASE WHEN TG_OP IN ('INSERT', 'UPDATE') THEN row_to_json(NEW) ELSE NULL END,\n        current_user\n    );\n    RETURN COALESCE(NEW, OLD);\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre></p>"},{"location":"reference/non-migrated-tables/#phone_log-event_log","title":"<code>Phone_Log</code> / <code>Event_Log</code>","text":"<p>Purpose: Change tracking for specific entities Why Not Migrated: Replaced by comprehensive audit system Recommendation: - Use PostgreSQL's built-in logging - Implement table-specific audit triggers - Use contact_log for contact-related changes</p>"},{"location":"reference/non-migrated-tables/#5-verification-and-validation-tables","title":"5. Verification and Validation Tables","text":""},{"location":"reference/non-migrated-tables/#address_verify","title":"<code>Address_Verify</code>","text":"<p>Purpose: Address verification status Why Not Migrated: Verification metadata, not core business data Recommendation: - Implement address validation in application - Use external address validation services - Store validation status in address table if needed</p> <p>Example address validation: <pre><code>-- Add validation fields to address table\nALTER TABLE address ADD COLUMN \n    validation_status TEXT CHECK (validation_status IN ('verified', 'unverified', 'invalid')),\nADD COLUMN validation_date TIMESTAMPTZ,\nADD COLUMN validation_service TEXT;\n</code></pre></p>"},{"location":"reference/non-migrated-tables/#migration-of-specific-non-migrated-data","title":"Migration of Specific Non-Migrated Data","text":""},{"location":"reference/non-migrated-tables/#if-you-need-data-from-non-migrated-tables","title":"If You Need Data from Non-Migrated Tables","text":""},{"location":"reference/non-migrated-tables/#1-manual-data-extraction","title":"1. Manual Data Extraction","text":"<p>For critical data in non-migrated tables:</p> <pre><code>-- Extract to CSV for analysis\nSELECT * FROM mysql.Filters \nINTO OUTFILE '/tmp/filters_backup.csv'\nFIELDS TERMINATED BY ',' \nENCLOSED BY '\"' \nLINES TERMINATED BY '\\n';\n</code></pre>"},{"location":"reference/non-migrated-tables/#2-custom-migration-scripts","title":"2. Custom Migration Scripts","text":"<p>Create custom scripts for specific needs:</p> <pre><code>// Example: Migrate filter data to JSON\nfunc migrateFilters() error {\n    filters, err := getMySQLFilters()\n    if err != nil {\n        return err\n    }\n\n    for _, filter := range filters {\n        filterJSON := map[string]interface{}{\n            \"name\": filter.Name,\n            \"criteria\": filter.Criteria,\n            \"user_id\": filter.UserID,\n        }\n\n        // Store in PostgreSQL as JSONB or in application config\n        err = storeFilter(filterJSON)\n        if err != nil {\n            log.Printf(\"Failed to migrate filter: %v\", err)\n        }\n    }\n    return nil\n}\n</code></pre>"},{"location":"reference/non-migrated-tables/#3-data-archival","title":"3. Data Archival","text":"<p>Archive non-migrated data for historical reference:</p> <pre><code># Create archive database\ncreatedb gms_archive\n\n# Import non-migrated tables\npg_dump mysql_database --table=Filters \\\n    | psql gms_archive\n\n# Document archive location\necho \"Non-migrated data archived in: gms_archive database\" &gt; ARCHIVE_LOCATION.txt\n</code></pre>"},{"location":"reference/non-migrated-tables/#application-considerations","title":"Application Considerations","text":""},{"location":"reference/non-migrated-tables/#functionality-replacement","title":"Functionality Replacement","text":"MySQL Feature PostgreSQL Alternative Custom filters Application filters + PostgreSQL views Export tracking Application logs + audit tables Category lookups Enum types + reference tables Change logging Audit triggers + temporal tables Address verification External services + validation flags"},{"location":"reference/non-migrated-tables/#performance-considerations","title":"Performance Considerations","text":"<p>Non-migrated table functionality may need optimization in PostgreSQL:</p>"},{"location":"reference/non-migrated-tables/#filters-and-searches","title":"Filters and Searches","text":"<pre><code>-- Use materialized views for complex filters\nCREATE MATERIALIZED VIEW active_alumni AS\nSELECT * FROM person \nWHERE status = 'Active' AND person_code = 'Alumni';\n\n-- Refresh periodically\nREFRESH MATERIALIZED VIEW active_alumni;\n</code></pre>"},{"location":"reference/non-migrated-tables/#categorical-data","title":"Categorical Data","text":"<pre><code>-- Use enums for fixed categories\nCREATE TYPE donor_category AS ENUM ('Major', 'Regular', 'Prospect', 'Lapsed');\n\n-- Use arrays for multiple categories\nALTER TABLE person ADD COLUMN categories TEXT[];\nCREATE INDEX idx_person_categories ON person USING GIN(categories);\n</code></pre>"},{"location":"reference/non-migrated-tables/#documentation-and-compliance","title":"Documentation and Compliance","text":""},{"location":"reference/non-migrated-tables/#data-governance","title":"Data Governance","text":"<p>For regulatory compliance, document:</p> <ol> <li>What data was not migrated (this document)</li> <li>Where archived data is stored</li> <li>Retention policies for non-migrated data</li> <li>Access procedures for historical data</li> </ol>"},{"location":"reference/non-migrated-tables/#audit-trail","title":"Audit Trail","text":"<p>Maintain records of: - Migration decisions and rationale - Archive locations and access methods - Alternative implementations for lost functionality - Testing verification that functionality is replaced</p>"},{"location":"reference/non-migrated-tables/#recommendations","title":"Recommendations","text":""},{"location":"reference/non-migrated-tables/#before-migration","title":"Before Migration","text":"<ol> <li>Audit Usage: Verify that non-migrated tables are truly unused</li> <li>Document Dependencies: Identify any application dependencies</li> <li>Create Archives: Backup all non-migrated data</li> <li>Plan Alternatives: Design replacements for any needed functionality</li> </ol>"},{"location":"reference/non-migrated-tables/#after-migration","title":"After Migration","text":"<ol> <li>Monitor Performance: Ensure replacement functionality performs well</li> <li>User Training: Train users on new filter/search capabilities</li> <li>Gradual Decommission: Phase out access to non-migrated data</li> <li>Regular Review: Periodically review if archived data is still needed</li> </ol> <p>Understanding which tables are not migrated helps ensure that no critical functionality is lost and that appropriate alternatives are implemented in the new PostgreSQL system.</p>"},{"location":"reference/performance/","title":"Performance Tuning Guide","text":""},{"location":"reference/performance/#overview","title":"Overview","text":"<p>This guide provides comprehensive strategies for optimizing the performance of both the migration process and the resulting PostgreSQL database. Performance tuning is crucial for large datasets and ensuring optimal query response times in production.</p>"},{"location":"reference/performance/#migration-performance-optimization","title":"Migration Performance Optimization","text":""},{"location":"reference/performance/#pre-migration-preparation","title":"Pre-Migration Preparation","text":""},{"location":"reference/performance/#database-configuration-for-migration","title":"Database Configuration for Migration","text":"<ol> <li> <p>PostgreSQL Configuration Tuning <pre><code>-- Increase work memory for large operations\nSET work_mem = '256MB';\n\n-- Increase maintenance work memory for index creation\nSET maintenance_work_mem = '1GB';\n\n-- Increase checkpoint segments for bulk operations\nSET max_wal_size = '4GB';\nSET checkpoint_completion_target = 0.9;\n\n-- Disable synchronous commit during migration\nSET synchronous_commit = OFF;\n\n-- Increase shared buffers\nSET shared_buffers = '2GB';\n</code></pre></p> </li> <li> <p>Temporary Performance Settings <pre><code>-- Disable autovacuum during migration\nALTER SYSTEM SET autovacuum = off;\n\n-- Increase parallel workers\nALTER SYSTEM SET max_parallel_workers = 8;\nALTER SYSTEM SET max_parallel_workers_per_gather = 4;\n\n-- Reload configuration\nSELECT pg_reload_conf();\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#mysql-source-optimization","title":"MySQL Source Optimization","text":"<ol> <li> <p>MySQL Configuration <pre><code># /etc/mysql/my.cnf additions for export performance\n[mysqld]\nread_buffer_size = 256K\nread_rnd_buffer_size = 512K\nsort_buffer_size = 2M\njoin_buffer_size = 2M\ntmp_table_size = 64M\nmax_heap_table_size = 64M\n</code></pre></p> </li> <li> <p>Export Optimization <pre><code>-- Use SELECT INTO OUTFILE for large tables\nSELECT * INTO OUTFILE '/tmp/donor_export.csv'\nFIELDS TERMINATED BY ',' ENCLOSED BY '\"'\nLINES TERMINATED BY '\\n'\nFROM Donor;\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#migration-process-optimization","title":"Migration Process Optimization","text":""},{"location":"reference/performance/#batch-processing-strategy","title":"Batch Processing Strategy","text":"<ol> <li> <p>Chunked Migration Implementation <pre><code>// Optimal batch size determination\nfunc determineBatchSize(tableSize int64) int {\n    switch {\n    case tableSize &lt; 10000:\n        return 1000\n    case tableSize &lt; 100000:\n        return 5000\n    case tableSize &lt; 1000000:\n        return 10000\n    default:\n        return 25000\n    }\n}\n\n// Parallel processing with worker pools\nfunc migrateTableInBatches(tableName string, totalRecords int64) error {\n    batchSize := determineBatchSize(totalRecords)\n    numWorkers := runtime.NumCPU()\n\n    jobs := make(chan BatchJob, numWorkers*2)\n    results := make(chan BatchResult, numWorkers*2)\n\n    // Start workers\n    for i := 0; i &lt; numWorkers; i++ {\n        go batchWorker(jobs, results)\n    }\n\n    // Generate batches\n    go func() {\n        for offset := int64(0); offset &lt; totalRecords; offset += int64(batchSize) {\n            jobs &lt;- BatchJob{\n                TableName: tableName,\n                Offset:    offset,\n                Limit:     batchSize,\n            }\n        }\n        close(jobs)\n    }()\n\n    // Collect results\n    for i := 0; i &lt; int(totalRecords/int64(batchSize))+1; i++ {\n        result := &lt;-results\n        if result.Error != nil {\n            return result.Error\n        }\n    }\n\n    return nil\n}\n</code></pre></p> </li> <li> <p>Memory Management <pre><code>// Efficient memory usage during migration\nfunc processBatchWithMemoryManagement(batch []Record) error {\n    const maxMemoryUsage = 100 * 1024 * 1024 // 100MB\n\n    for i, record := range batch {\n        if i%1000 == 0 {\n            // Force garbage collection periodically\n            runtime.GC()\n\n            // Check memory usage\n            var m runtime.MemStats\n            runtime.ReadMemStats(&amp;m)\n            if m.Alloc &gt; maxMemoryUsage {\n                return fmt.Errorf(\"memory usage too high: %d bytes\", m.Alloc)\n            }\n        }\n\n        if err := processRecord(record); err != nil {\n            return err\n        }\n    }\n    return nil\n}\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#index-management-during-migration","title":"Index Management During Migration","text":"<ol> <li> <p>Deferred Index Creation <pre><code>-- Drop indexes before bulk insert\nDO $$\nDECLARE\n    rec RECORD;\nBEGIN\n    FOR rec IN \n        SELECT schemaname, tablename, indexname, indexdef\n        FROM pg_indexes \n        WHERE schemaname = 'public' \n        AND indexname NOT LIKE '%_pkey'\n    LOOP\n        EXECUTE 'DROP INDEX IF EXISTS ' || rec.indexname;\n    END LOOP;\nEND $$;\n</code></pre></p> </li> <li> <p>Parallel Index Creation <pre><code>-- Create indexes in parallel after migration\nCREATE INDEX CONCURRENTLY idx_person_email ON person(email);\nCREATE INDEX CONCURRENTLY idx_person_last_name ON person(last_name);\nCREATE INDEX CONCURRENTLY idx_contact_person_id ON contact(person_id);\nCREATE INDEX CONCURRENTLY idx_finance_date ON finance(date_received);\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#database-performance-optimization","title":"Database Performance Optimization","text":""},{"location":"reference/performance/#index-strategy","title":"Index Strategy","text":""},{"location":"reference/performance/#primary-indexes","title":"Primary Indexes","text":"<ol> <li> <p>Essential Indexes <pre><code>-- Core entity indexes\nCREATE INDEX CONCURRENTLY idx_person_name ON person(last_name, first_name);\nCREATE INDEX CONCURRENTLY idx_person_email ON person(email) WHERE email IS NOT NULL;\nCREATE INDEX CONCURRENTLY idx_person_created ON person(created_at);\n\n-- Foreign key indexes\nCREATE INDEX CONCURRENTLY idx_contact_person_id ON contact(person_id);\nCREATE INDEX CONCURRENTLY idx_address_person_id ON address(person_id);\nCREATE INDEX CONCURRENTLY idx_finance_person_id ON finance(person_id);\nCREATE INDEX CONCURRENTLY idx_employment_person_id ON employment(person_id);\nCREATE INDEX CONCURRENTLY idx_education_person_id ON education(person_id);\nCREATE INDEX CONCURRENTLY idx_family_person_id ON family(person_id);\nCREATE INDEX CONCURRENTLY idx_family_related_person_id ON family(related_person_id);\n</code></pre></p> </li> <li> <p>Composite Indexes for Common Queries <pre><code>-- Multi-column indexes for frequent query patterns\nCREATE INDEX CONCURRENTLY idx_person_status_type ON person(contact_status, person_type);\nCREATE INDEX CONCURRENTLY idx_finance_person_date ON finance(person_id, date_received);\nCREATE INDEX CONCURRENTLY idx_contact_person_type ON contact(person_id, contact_type);\nCREATE INDEX CONCURRENTLY idx_address_person_primary ON address(person_id, is_primary);\nCREATE INDEX CONCURRENTLY idx_employment_person_current ON employment(person_id, is_current);\n</code></pre></p> </li> <li> <p>Partial Indexes for Selective Queries <pre><code>-- Indexes on subsets of data\nCREATE INDEX CONCURRENTLY idx_person_active ON person(id) \nWHERE contact_status = 'active';\n\nCREATE INDEX CONCURRENTLY idx_finance_current_year ON finance(date_received, amount) \nWHERE date_received &gt;= DATE_TRUNC('year', CURRENT_DATE);\n\nCREATE INDEX CONCURRENTLY idx_contact_primary_email ON contact(person_id, email_address) \nWHERE contact_type = 'email' AND is_primary = true;\n\nCREATE INDEX CONCURRENTLY idx_employment_current ON employment(person_id, company_name) \nWHERE is_current = true;\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#advanced-indexing-strategies","title":"Advanced Indexing Strategies","text":"<ol> <li> <p>GIN Indexes for Array and JSONB Data <pre><code>-- Array column indexes\nCREATE INDEX CONCURRENTLY idx_employment_skills_gin ON employment USING GIN(skills);\nCREATE INDEX CONCURRENTLY idx_volunteer_activities_gin ON volunteer USING GIN(preferred_activities);\n\n-- Text search indexes\nCREATE INDEX CONCURRENTLY idx_person_name_gin ON person USING GIN(\n    to_tsvector('english', coalesce(first_name, '') || ' ' || coalesce(last_name, ''))\n);\n\nCREATE INDEX CONCURRENTLY idx_organization_name_gin ON organization USING GIN(\n    to_tsvector('english', organization_name)\n);\n</code></pre></p> </li> <li> <p>Functional Indexes <pre><code>-- Case-insensitive searches\nCREATE INDEX CONCURRENTLY idx_person_email_lower ON person(LOWER(email));\nCREATE INDEX CONCURRENTLY idx_organization_name_lower ON organization(LOWER(organization_name));\n\n-- Date-based functional indexes\nCREATE INDEX CONCURRENTLY idx_finance_fiscal_year ON finance(\n    CASE WHEN EXTRACT(MONTH FROM date_received) &gt;= 7 \n         THEN EXTRACT(YEAR FROM date_received) + 1\n         ELSE EXTRACT(YEAR FROM date_received)\n    END\n);\n\n-- Age calculation index\nCREATE INDEX CONCURRENTLY idx_person_age ON person(\n    EXTRACT(YEAR FROM AGE(birth_date))\n) WHERE birth_date IS NOT NULL;\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#query-optimization","title":"Query Optimization","text":""},{"location":"reference/performance/#common-query-patterns-and-optimizations","title":"Common Query Patterns and Optimizations","text":"<ol> <li> <p>Donor Search Optimization <pre><code>-- Optimized donor search query\nCREATE OR REPLACE FUNCTION search_donors(\n    search_term TEXT,\n    limit_count INTEGER DEFAULT 50\n) RETURNS TABLE(\n    person_id UUID,\n    full_name TEXT,\n    email TEXT,\n    total_giving NUMERIC,\n    last_gift_date DATE\n) AS $$\nBEGIN\n    RETURN QUERY\n    WITH donor_search AS (\n        SELECT \n            p.id,\n            p.first_name || ' ' || p.last_name as name,\n            c.email_address,\n            ts_rank(to_tsvector('english', p.first_name || ' ' || p.last_name), \n                   plainto_tsquery('english', search_term)) as rank\n        FROM person p\n        LEFT JOIN contact c ON p.id = c.person_id AND c.contact_type = 'email' AND c.is_primary = true\n        WHERE to_tsvector('english', p.first_name || ' ' || p.last_name) @@ plainto_tsquery('english', search_term)\n           OR LOWER(p.email) LIKE LOWER('%' || search_term || '%')\n        ORDER BY rank DESC\n        LIMIT limit_count\n    ),\n    giving_summary AS (\n        SELECT \n            f.person_id,\n            SUM(f.amount) as total_amount,\n            MAX(f.date_received) as last_date\n        FROM finance f\n        WHERE f.person_id IN (SELECT id FROM donor_search)\n        GROUP BY f.person_id\n    )\n    SELECT \n        ds.id,\n        ds.name,\n        ds.email_address,\n        COALESCE(gs.total_amount, 0),\n        gs.last_date\n    FROM donor_search ds\n    LEFT JOIN giving_summary gs ON ds.id = gs.person_id\n    ORDER BY ds.rank DESC, gs.total_amount DESC NULLS LAST;\nEND;\n$$ LANGUAGE plpgsql STABLE;\n</code></pre></p> </li> <li> <p>Financial Reporting Optimization <pre><code>-- Materialized view for financial summaries\nCREATE MATERIALIZED VIEW donor_giving_summary AS\nSELECT \n    p.id as person_id,\n    p.first_name,\n    p.last_name,\n    p.email,\n    COUNT(f.id) as gift_count,\n    SUM(f.amount) as total_giving,\n    AVG(f.amount) as average_gift,\n    MIN(f.date_received) as first_gift_date,\n    MAX(f.date_received) as last_gift_date,\n    SUM(CASE WHEN f.date_received &gt;= DATE_TRUNC('year', CURRENT_DATE) THEN f.amount ELSE 0 END) as current_year_giving,\n    SUM(CASE WHEN f.date_received &gt;= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' \n              AND f.date_received &lt; DATE_TRUNC('year', CURRENT_DATE) THEN f.amount ELSE 0 END) as prior_year_giving\nFROM person p\nLEFT JOIN finance f ON p.id = f.person_id\nGROUP BY p.id, p.first_name, p.last_name, p.email;\n\n-- Index the materialized view\nCREATE UNIQUE INDEX idx_donor_giving_summary_person ON donor_giving_summary(person_id);\nCREATE INDEX idx_donor_giving_summary_total ON donor_giving_summary(total_giving DESC);\nCREATE INDEX idx_donor_giving_summary_current ON donor_giving_summary(current_year_giving DESC);\n\n-- Refresh procedure\nCREATE OR REPLACE FUNCTION refresh_donor_giving_summary() RETURNS VOID AS $$\nBEGIN\n    REFRESH MATERIALIZED VIEW CONCURRENTLY donor_giving_summary;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre></p> </li> <li> <p>Contact History Optimization <pre><code>-- Optimized contact log queries with proper indexing\nCREATE INDEX CONCURRENTLY idx_contact_log_person_date ON contact_log(person_id, contact_date DESC);\nCREATE INDEX CONCURRENTLY idx_contact_log_follow_up ON contact_log(follow_up_date) \nWHERE follow_up_date IS NOT NULL AND completed = false;\n\n-- Function for recent contact activity\nCREATE OR REPLACE FUNCTION get_recent_contacts(\n    person_uuid UUID,\n    days_back INTEGER DEFAULT 90\n) RETURNS TABLE(\n    contact_date DATE,\n    contact_type contact_type_enum,\n    staff_member TEXT,\n    summary TEXT,\n    follow_up_required BOOLEAN\n) AS $$\nBEGIN\n    RETURN QUERY\n    SELECT \n        cl.contact_date,\n        cl.contact_type,\n        s.first_name || ' ' || s.last_name as staff_name,\n        cl.summary,\n        (cl.follow_up_date IS NOT NULL AND NOT cl.completed) as needs_follow_up\n    FROM contact_log cl\n    LEFT JOIN person s ON cl.staff_id = s.id\n    WHERE cl.person_id = person_uuid\n      AND cl.contact_date &gt;= CURRENT_DATE - INTERVAL '%s days' % days_back\n    ORDER BY cl.contact_date DESC;\nEND;\n$$ LANGUAGE plpgsql STABLE;\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#connection-pool-optimization","title":"Connection Pool Optimization","text":""},{"location":"reference/performance/#application-level-optimization","title":"Application-Level Optimization","text":"<ol> <li> <p>Connection Pool Configuration <pre><code>// Optimal connection pool settings\nfunc configureConnectionPool(db *sql.DB) {\n    // Set maximum number of open connections\n    db.SetMaxOpenConns(25)\n\n    // Set maximum number of idle connections\n    db.SetMaxIdleConns(10)\n\n    // Set connection lifetime\n    db.SetConnMaxLifetime(5 * time.Minute)\n\n    // Set connection idle time\n    db.SetConnMaxIdleTime(30 * time.Second)\n}\n\n// Connection health check\nfunc healthCheck(db *sql.DB) error {\n    ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)\n    defer cancel()\n\n    if err := db.PingContext(ctx); err != nil {\n        return fmt.Errorf(\"database health check failed: %w\", err)\n    }\n\n    return nil\n}\n</code></pre></p> </li> <li> <p>Query Timeout Management <pre><code>// Query with timeout\nfunc executeQueryWithTimeout(db *sql.DB, query string, timeout time.Duration) (*sql.Rows, error) {\n    ctx, cancel := context.WithTimeout(context.Background(), timeout)\n    defer cancel()\n\n    stmt, err := db.PrepareContext(ctx, query)\n    if err != nil {\n        return nil, err\n    }\n    defer stmt.Close()\n\n    return stmt.QueryContext(ctx)\n}\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#monitoring-and-maintenance","title":"Monitoring and Maintenance","text":""},{"location":"reference/performance/#performance-monitoring-queries","title":"Performance Monitoring Queries","text":"<ol> <li> <p>Index Usage Analysis <pre><code>-- Check index usage statistics\nSELECT \n    schemaname,\n    tablename,\n    indexname,\n    idx_tup_read,\n    idx_tup_fetch,\n    idx_scan,\n    CASE WHEN idx_scan = 0 THEN 'Unused'\n         WHEN idx_scan &lt; 10 THEN 'Low Usage'\n         ELSE 'Active'\n    END as usage_status\nFROM pg_stat_user_indexes\nORDER BY idx_scan DESC;\n\n-- Find missing indexes\nSELECT \n    schemaname,\n    tablename,\n    seq_scan,\n    seq_tup_read,\n    seq_tup_read / seq_scan as avg_tup_per_scan\nFROM pg_stat_user_tables\nWHERE seq_scan &gt; 0\nORDER BY seq_tup_read DESC;\n</code></pre></p> </li> <li> <p>Query Performance Analysis <pre><code>-- Slow query identification (requires pg_stat_statements)\nSELECT \n    query,\n    calls,\n    total_time,\n    mean_time,\n    rows,\n    100.0 * shared_blks_hit / nullif(shared_blks_hit + shared_blks_read, 0) AS hit_percent\nFROM pg_stat_statements\nWHERE mean_time &gt; 1000  -- Queries taking more than 1 second on average\nORDER BY total_time DESC\nLIMIT 20;\n</code></pre></p> </li> <li> <p>Database Size and Growth Monitoring <pre><code>-- Table size analysis\nSELECT \n    schemaname,\n    tablename,\n    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) as total_size,\n    pg_size_pretty(pg_relation_size(schemaname||'.'||tablename)) as table_size,\n    pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename) - pg_relation_size(schemaname||'.'||tablename)) as index_size\nFROM pg_tables\nWHERE schemaname = 'public'\nORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;\n\n-- Growth tracking\nCREATE TABLE IF NOT EXISTS database_size_history (\n    recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    database_name TEXT,\n    total_size BIGINT,\n    table_count INTEGER,\n    index_count INTEGER\n);\n\n-- Daily size tracking function\nCREATE OR REPLACE FUNCTION record_database_size() RETURNS VOID AS $$\nBEGIN\n    INSERT INTO database_size_history (database_name, total_size, table_count, index_count)\n    SELECT \n        current_database(),\n        pg_database_size(current_database()),\n        (SELECT COUNT(*) FROM pg_tables WHERE schemaname = 'public'),\n        (SELECT COUNT(*) FROM pg_indexes WHERE schemaname = 'public');\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#automated-maintenance","title":"Automated Maintenance","text":"<ol> <li> <p>Vacuum and Analyze Scheduling <pre><code>-- Custom vacuum strategy\nCREATE OR REPLACE FUNCTION smart_vacuum_analyze() RETURNS VOID AS $$\nDECLARE\n    rec RECORD;\nBEGIN\n    FOR rec IN \n        SELECT schemaname, tablename, n_tup_ins, n_tup_upd, n_tup_del\n        FROM pg_stat_user_tables\n        WHERE schemaname = 'public'\n    LOOP\n        -- Vacuum tables with significant changes\n        IF rec.n_tup_ins + rec.n_tup_upd + rec.n_tup_del &gt; 1000 THEN\n            EXECUTE 'VACUUM ANALYZE ' || rec.schemaname || '.' || rec.tablename;\n            RAISE NOTICE 'Vacuumed and analyzed %.%', rec.schemaname, rec.tablename;\n        END IF;\n    END LOOP;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre></p> </li> <li> <p>Index Maintenance <pre><code>-- Reindex bloated indexes\nCREATE OR REPLACE FUNCTION reindex_bloated_indexes() RETURNS VOID AS $$\nDECLARE\n    rec RECORD;\nBEGIN\n    FOR rec IN \n        SELECT schemaname, indexname\n        FROM pg_stat_user_indexes\n        WHERE idx_scan &gt; 0 \n        AND pg_relation_size(indexrelid) &gt; 100 * 1024 * 1024  -- &gt; 100MB\n    LOOP\n        EXECUTE 'REINDEX INDEX CONCURRENTLY ' || rec.schemaname || '.' || rec.indexname;\n        RAISE NOTICE 'Reindexed %.%', rec.schemaname, rec.indexname;\n    END LOOP;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#hardware-and-system-optimization","title":"Hardware and System Optimization","text":""},{"location":"reference/performance/#postgresql-configuration-tuning","title":"PostgreSQL Configuration Tuning","text":"<ol> <li> <p>Memory Configuration <pre><code># postgresql.conf optimizations\n\n# Memory settings (adjust based on available RAM)\nshared_buffers = 2GB                    # 25% of RAM\neffective_cache_size = 6GB              # 75% of RAM\nwork_mem = 256MB                        # For complex queries\nmaintenance_work_mem = 1GB              # For maintenance operations\n\n# Checkpoint settings\ncheckpoint_timeout = 15min\ncheckpoint_completion_target = 0.9\nmax_wal_size = 4GB\nmin_wal_size = 1GB\n\n# Connection settings\nmax_connections = 100\nsuperuser_reserved_connections = 3\n\n# Query planning\nrandom_page_cost = 1.1                  # For SSD storage\neffective_io_concurrency = 200          # For SSD storage\n\n# Parallel query settings\nmax_parallel_workers_per_gather = 4\nmax_parallel_workers = 8\nmax_parallel_maintenance_workers = 4\n\n# Logging for performance monitoring\nlog_min_duration_statement = 1000       # Log slow queries\nlog_checkpoints = on\nlog_connections = on\nlog_disconnections = on\nlog_lock_waits = on\n</code></pre></p> </li> <li> <p>Operating System Optimization <pre><code># Linux kernel parameters for PostgreSQL\n# Add to /etc/sysctl.conf\n\n# Shared memory settings\nkernel.shmmax = 68719476736        # 64GB\nkernel.shmall = 4294967296         # 16TB\n\n# Semaphore settings\nkernel.sem = 250 32000 100 128\n\n# Memory overcommit\nvm.overcommit_memory = 2\nvm.overcommit_ratio = 80\n\n# Swappiness (reduce swapping)\nvm.swappiness = 10\n\n# Dirty page management\nvm.dirty_background_ratio = 5\nvm.dirty_ratio = 10\n\n# File system settings\nfs.file-max = 6815744\n\n# Apply settings\nsudo sysctl -p\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#performance-testing-and-benchmarking","title":"Performance Testing and Benchmarking","text":""},{"location":"reference/performance/#load-testing-framework","title":"Load Testing Framework","text":"<ol> <li> <p>Query Performance Testing <pre><code>// Benchmark common queries\nfunc BenchmarkDonorSearch(b *testing.B) {\n    db := setupTestDB()\n    defer db.Close()\n\n    searchTerms := []string{\"John\", \"Smith\", \"Foundation\", \"University\"}\n\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        term := searchTerms[i%len(searchTerms)]\n        rows, err := db.Query(\"SELECT * FROM search_donors($1, 50)\", term)\n        if err != nil {\n            b.Fatal(err)\n        }\n        rows.Close()\n    }\n}\n\nfunc BenchmarkFinancialReport(b *testing.B) {\n    db := setupTestDB()\n    defer db.Close()\n\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        rows, err := db.Query(`\n            SELECT person_id, total_giving, current_year_giving \n            FROM donor_giving_summary \n            WHERE total_giving &gt; 1000 \n            ORDER BY total_giving DESC \n            LIMIT 100\n        `)\n        if err != nil {\n            b.Fatal(err)\n        }\n        rows.Close()\n    }\n}\n</code></pre></p> </li> <li> <p>Concurrent Load Testing <pre><code>// Simulate concurrent users\nfunc TestConcurrentLoad(t *testing.T) {\n    db := setupTestDB()\n    defer db.Close()\n\n    const numGoroutines = 10\n    const queriesPerGoroutine = 100\n\n    var wg sync.WaitGroup\n    errChan := make(chan error, numGoroutines)\n\n    for i := 0; i &lt; numGoroutines; i++ {\n        wg.Add(1)\n        go func(workerID int) {\n            defer wg.Done()\n\n            for j := 0; j &lt; queriesPerGoroutine; j++ {\n                if err := executeRandomQuery(db); err != nil {\n                    errChan &lt;- fmt.Errorf(\"worker %d, query %d: %w\", workerID, j, err)\n                    return\n                }\n            }\n        }(i)\n    }\n\n    wg.Wait()\n    close(errChan)\n\n    for err := range errChan {\n        t.Error(err)\n    }\n}\n</code></pre></p> </li> </ol>"},{"location":"reference/performance/#performance-metrics-and-slas","title":"Performance Metrics and SLAs","text":""},{"location":"reference/performance/#target-performance-metrics","title":"Target Performance Metrics","text":"<ol> <li>Query Response Times</li> <li>Donor search: &lt; 500ms for 95th percentile</li> <li>Financial reports: &lt; 2 seconds for complex aggregations</li> <li>Contact log retrieval: &lt; 200ms for recent history</li> <li> <p>Dashboard queries: &lt; 1 second for summary data</p> </li> <li> <p>Throughput Targets</p> </li> <li>Concurrent users: 50+ simultaneous users</li> <li>Query throughput: 1000+ queries per second</li> <li>Data entry: 100+ records per minute</li> <li> <p>Report generation: 10+ concurrent reports</p> </li> <li> <p>Migration Performance</p> </li> <li>Large table migration: &lt; 1 hour per 1M records</li> <li>Index creation: &lt; 30 minutes for largest tables</li> <li>Data validation: &lt; 15 minutes for complete dataset</li> <li>Total migration time: &lt; 8 hours for typical database</li> </ol> <p>This comprehensive performance tuning guide ensures optimal database performance both during migration and in production use, with specific recommendations for indexing, query optimization, system configuration, and ongoing maintenance.</p>"},{"location":"schema/data-types/","title":"Data Type Conversions","text":"<p>This page details how MySQL data types are converted to their PostgreSQL equivalents during the migration process.</p>"},{"location":"schema/data-types/#primary-data-type-mappings","title":"Primary Data Type Mappings","text":""},{"location":"schema/data-types/#numeric-types","title":"Numeric Types","text":"MySQL Type PostgreSQL Type Notes <code>TINYINT</code> <code>SMALLINT</code> 8-bit \u2192 16-bit integer <code>TINYINT(1)</code> <code>BOOLEAN</code> MySQL boolean emulation \u2192 native boolean <code>SMALLINT</code> <code>SMALLINT</code> Direct mapping <code>MEDIUMINT</code> <code>INTEGER</code> 24-bit \u2192 32-bit integer <code>INT</code> / <code>INTEGER</code> <code>INTEGER</code> Direct mapping <code>BIGINT</code> <code>BIGINT</code> Direct mapping <code>DECIMAL(p,s)</code> <code>DECIMAL(p,s)</code> Direct mapping with precision <code>FLOAT</code> <code>REAL</code> Single precision floating point <code>DOUBLE</code> <code>DOUBLE PRECISION</code> Double precision floating point"},{"location":"schema/data-types/#string-types","title":"String Types","text":"MySQL Type PostgreSQL Type Notes <code>CHAR(n)</code> <code>CHAR(n)</code> Fixed-length character string <code>VARCHAR(n)</code> <code>VARCHAR(n)</code> Variable-length character string <code>TEXT</code> <code>TEXT</code> Unlimited variable-length text <code>TINYTEXT</code> <code>TEXT</code> Small text \u2192 unlimited text <code>MEDIUMTEXT</code> <code>TEXT</code> Medium text \u2192 unlimited text <code>LONGTEXT</code> <code>TEXT</code> Large text \u2192 unlimited text <code>BINARY(n)</code> <code>BYTEA</code> Fixed-length binary \u2192 variable binary <code>VARBINARY(n)</code> <code>BYTEA</code> Variable-length binary data <code>BLOB</code> <code>BYTEA</code> Binary large object"},{"location":"schema/data-types/#date-and-time-types","title":"Date and Time Types","text":"MySQL Type PostgreSQL Type Notes <code>DATE</code> <code>DATE</code> Direct mapping <code>TIME</code> <code>TIME</code> Direct mapping <code>DATETIME</code> <code>TIMESTAMP</code> Date and time without timezone <code>TIMESTAMP</code> <code>TIMESTAMPTZ</code> Date and time with timezone <code>YEAR</code> <code>SMALLINT</code> Year stored as integer"},{"location":"schema/data-types/#special-conversions","title":"Special Conversions","text":"MySQL Type PostgreSQL Type Notes <code>ENUM('a','b','c')</code> Custom ENUM Type-safe enumeration <code>SET('a','b','c')</code> <code>TEXT[]</code> Array of text values <code>JSON</code> <code>JSONB</code> Binary JSON for better performance <code>AUTO_INCREMENT</code> <code>UUID</code> Sequential integers \u2192 UUIDs"},{"location":"schema/data-types/#boolean-type-conversion","title":"Boolean Type Conversion","text":""},{"location":"schema/data-types/#mysql-tinyint1-to-postgresql-boolean","title":"MySQL TINYINT(1) to PostgreSQL BOOLEAN","text":"<p>MySQL uses <code>TINYINT(1)</code> to emulate boolean values, while PostgreSQL has native boolean support.</p>"},{"location":"schema/data-types/#conversion-logic","title":"Conversion Logic","text":"<pre><code>-- MySQL values\nTINYINT(1): 0, 1, NULL\n\n-- PostgreSQL conversion\nCASE \n    WHEN mysql_field = 1 THEN true\n    WHEN mysql_field = 0 THEN false\n    ELSE NULL\nEND\n</code></pre>"},{"location":"schema/data-types/#example-fields","title":"Example Fields","text":"Table MySQL Field PostgreSQL Field Conversion <code>Donor</code> <code>active TINYINT(1)</code> <code>is_active BOOLEAN</code> 0/1 \u2192 false/true <code>Address</code> <code>primary TINYINT(1)</code> <code>is_primary BOOLEAN</code> 0/1 \u2192 false/true <code>Contacted</code> <code>restricted TINYINT(1)</code> <code>is_restricted BOOLEAN</code> 0/1 \u2192 false/true"},{"location":"schema/data-types/#primary-key-conversion","title":"Primary Key Conversion","text":""},{"location":"schema/data-types/#auto_increment-to-uuid","title":"AUTO_INCREMENT to UUID","text":"<p>All MySQL auto-increment primary keys are converted to PostgreSQL UUIDs for better distributed system support.</p>"},{"location":"schema/data-types/#conversion-process","title":"Conversion Process","text":"<pre><code>-- MySQL\nCREATE TABLE donor (\n    donor_id INT AUTO_INCREMENT PRIMARY KEY,\n    first_name VARCHAR(50)\n);\n\n-- PostgreSQL\nCREATE TABLE person (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    first_name VARCHAR(50)\n);\n</code></pre>"},{"location":"schema/data-types/#id-mapping-table","title":"ID Mapping Table","text":"<p>During migration, a mapping table tracks the conversion:</p> <pre><code>CREATE TABLE id_mapping (\n    mysql_table VARCHAR(50),\n    mysql_id INTEGER,\n    postgres_id UUID,\n    created_at TIMESTAMPTZ DEFAULT NOW()\n);\n</code></pre>"},{"location":"schema/data-types/#foreign-key-updates","title":"Foreign Key Updates","text":"<p>All foreign key references are updated to use the new UUIDs:</p> <pre><code>-- MySQL\ndonor_id INT REFERENCES donor(donor_id)\n\n-- PostgreSQL  \nperson_id UUID REFERENCES person(id)\n</code></pre>"},{"location":"schema/data-types/#enumeration-conversion","title":"Enumeration Conversion","text":""},{"location":"schema/data-types/#mysql-enum-to-postgresql-enum","title":"MySQL ENUM to PostgreSQL ENUM","text":"<p>MySQL enum values are converted to PostgreSQL custom enum types for better type safety.</p>"},{"location":"schema/data-types/#person-status-example","title":"Person Status Example","text":"<pre><code>-- MySQL\nstatus ENUM('Active', 'In-active', 'Lost', 'Deceased')\n\n-- PostgreSQL\nCREATE TYPE person_status_enum AS ENUM (\n    'Active', \n    'In-active', \n    'Lost', \n    'Deceased'\n);\n\nstatus person_status_enum\n</code></pre>"},{"location":"schema/data-types/#contact-type-example","title":"Contact Type Example","text":"<pre><code>-- MySQL\nctype INT  -- 1=Phone, 2=Email, 3=Letter, etc.\n\n-- PostgreSQL\nCREATE TYPE contact_type_enum AS ENUM (\n    'Phone Call',\n    'Email', \n    'Letter',\n    'In-Person Meeting',\n    'Text Message',\n    'Social Media',\n    'Video Call',\n    'Voicemail',\n    'Event Contact',\n    'Newsletter',\n    'Donation Thank You',\n    'Other'\n);\n\ncontact_type contact_type_enum\n</code></pre>"},{"location":"schema/data-types/#enum-mapping-logic","title":"Enum Mapping Logic","text":"<p>Integer-based enums are mapped using CASE statements:</p> <pre><code>CASE mysql_ctype\n    WHEN 1 THEN 'Phone Call'::contact_type_enum\n    WHEN 2 THEN 'Email'::contact_type_enum\n    WHEN 3 THEN 'Letter'::contact_type_enum\n    WHEN 4 THEN 'In-Person Meeting'::contact_type_enum\n    ELSE 'Other'::contact_type_enum\nEND\n</code></pre>"},{"location":"schema/data-types/#date-and-time-handling","title":"Date and Time Handling","text":""},{"location":"schema/data-types/#timezone-considerations","title":"Timezone Considerations","text":"<p>MySQL <code>TIMESTAMP</code> fields are converted to PostgreSQL <code>TIMESTAMPTZ</code> to properly handle timezones.</p> <pre><code>-- MySQL\ncreated_timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n\n-- PostgreSQL\ncreated_at TIMESTAMPTZ DEFAULT NOW()\n</code></pre>"},{"location":"schema/data-types/#invalid-date-handling","title":"Invalid Date Handling","text":"<p>MySQL allows invalid dates like '0000-00-00', which PostgreSQL rejects:</p> <pre><code>-- Conversion logic\nCASE \n    WHEN mysql_date = '0000-00-00' THEN NULL\n    WHEN mysql_date IS NULL THEN NULL\n    WHEN mysql_date &lt; '1900-01-01' THEN NULL\n    ELSE mysql_date::DATE\nEND\n</code></pre>"},{"location":"schema/data-types/#date-range-validation","title":"Date Range Validation","text":"<p>PostgreSQL is stricter about date ranges:</p> <pre><code>-- Handle edge cases\nCASE \n    WHEN mysql_year &lt; 1900 THEN NULL\n    WHEN mysql_year &gt; 2100 THEN NULL\n    ELSE make_date(mysql_year, 1, 1)\nEND\n</code></pre>"},{"location":"schema/data-types/#text-and-character-encoding","title":"Text and Character Encoding","text":""},{"location":"schema/data-types/#character-set-conversion","title":"Character Set Conversion","text":"<p>MySQL data is converted to PostgreSQL UTF-8:</p> <ul> <li>Source: MySQL with various character sets (latin1, utf8mb4, etc.)</li> <li>Target: PostgreSQL UTF-8 encoding</li> <li>Handling: Automatic conversion with error handling for invalid characters</li> </ul>"},{"location":"schema/data-types/#text-length-considerations","title":"Text Length Considerations","text":"<p>PostgreSQL handles text differently than MySQL:</p> MySQL PostgreSQL Notes <code>TEXT</code> (65,535 bytes) <code>TEXT</code> (unlimited) No length restriction <code>MEDIUMTEXT</code> (16MB) <code>TEXT</code> (unlimited) No length restriction <code>LONGTEXT</code> (4GB) <code>TEXT</code> (unlimited) No length restriction"},{"location":"schema/data-types/#json-data-conversion","title":"JSON Data Conversion","text":""},{"location":"schema/data-types/#mysql-json-to-postgresql-jsonb","title":"MySQL JSON to PostgreSQL JSONB","text":"<p>JSON data is converted to JSONB for better performance:</p> <pre><code>-- MySQL\npreferences JSON\n\n-- PostgreSQL\npreferences JSONB\n</code></pre>"},{"location":"schema/data-types/#benefits-of-jsonb","title":"Benefits of JSONB","text":"<ul> <li>Binary storage format (faster)</li> <li>Indexing support</li> <li>Better query performance</li> <li>Duplicate key elimination</li> </ul>"},{"location":"schema/data-types/#decimal-and-precision-handling","title":"Decimal and Precision Handling","text":""},{"location":"schema/data-types/#financial-data-precision","title":"Financial Data Precision","text":"<p>Financial amounts maintain precision:</p> <pre><code>-- MySQL\namount DECIMAL(10,2)\n\n-- PostgreSQL\namount DECIMAL(10,2)\n</code></pre>"},{"location":"schema/data-types/#currency-considerations","title":"Currency Considerations","text":"<p>For currency handling, consider using PostgreSQL's <code>MONEY</code> type or maintaining <code>DECIMAL</code>:</p> <pre><code>-- Option 1: Maintain DECIMAL\namount DECIMAL(10,2)\n\n-- Option 2: Use MONEY (locale-dependent)\namount MONEY\n</code></pre>"},{"location":"schema/data-types/#array-and-set-conversion","title":"Array and Set Conversion","text":""},{"location":"schema/data-types/#mysql-set-to-postgresql-array","title":"MySQL SET to PostgreSQL Array","text":"<p>MySQL SET types are converted to PostgreSQL arrays:</p> <pre><code>-- MySQL\ninterests SET('sports', 'music', 'travel', 'books')\n\n-- PostgreSQL\ninterests TEXT[]\n</code></pre>"},{"location":"schema/data-types/#conversion-logic_1","title":"Conversion Logic","text":"<pre><code>-- Split MySQL SET values into array\nstring_to_array(mysql_set_field, ',')\n</code></pre>"},{"location":"schema/data-types/#validation-and-constraints","title":"Validation and Constraints","text":""},{"location":"schema/data-types/#enhanced-constraints","title":"Enhanced Constraints","text":"<p>PostgreSQL allows more sophisticated constraints:</p> <pre><code>-- Email validation\nemail VARCHAR(255) CHECK (email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$')\n\n-- Phone number format\nphone VARCHAR(20) CHECK (phone ~ '^[\\d\\s\\-\\(\\)\\+\\.x]+$')\n\n-- Date range validation  \nbirth_date DATE CHECK (birth_date BETWEEN '1900-01-01' AND CURRENT_DATE)\n</code></pre>"},{"location":"schema/data-types/#not-null-constraints","title":"NOT NULL Constraints","text":"<p>Review and enhance NOT NULL constraints:</p> <pre><code>-- Required fields\nfirst_name VARCHAR(50) NOT NULL,\nlast_name VARCHAR(100) NOT NULL,\ncreated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n</code></pre>"},{"location":"schema/data-types/#performance-considerations","title":"Performance Considerations","text":""},{"location":"schema/data-types/#index-conversion","title":"Index Conversion","text":"<p>MySQL indexes are recreated with PostgreSQL-specific optimizations:</p> <pre><code>-- B-tree indexes (default)\nCREATE INDEX idx_person_last_name ON person(last_name);\n\n-- Partial indexes for performance\nCREATE INDEX idx_active_persons ON person(last_name) WHERE is_active = true;\n\n-- GIN indexes for arrays/JSONB\nCREATE INDEX idx_person_preferences ON person USING GIN(preferences);\n</code></pre>"},{"location":"schema/data-types/#storage-optimization","title":"Storage Optimization","text":"<p>PostgreSQL storage considerations:</p> <ul> <li>TOAST: Automatic compression for large text fields</li> <li>Fill Factor: Adjust for high-update tables</li> <li>Vacuum Strategy: Plan for ongoing maintenance</li> </ul> <p>Data type conversion ensures that all MySQL data is properly transformed to take advantage of PostgreSQL's advanced type system while maintaining data integrity and improving performance.</p>"},{"location":"schema/enums/","title":"Database Enums","text":""},{"location":"schema/enums/#overview","title":"Overview","text":"<p>This document provides a complete reference of all enum types defined in the GMS database schema. Enums ensure data consistency, improve query performance, and provide better validation compared to free-text fields.</p>"},{"location":"schema/enums/#person-and-status-enums","title":"Person and Status Enums","text":""},{"location":"schema/enums/#person-status-enum","title":"Person Status Enum","text":"<p>Tracks the current status of a person in the system. <pre><code>CREATE TYPE person_status_enum AS ENUM ('Active', 'In-active', 'Lost', 'Deceased');\n</code></pre></p> <p>Values: - <code>Active</code> - Person is currently active in the organization - <code>In-active</code> - Person is temporarily inactive - <code>Lost</code> - Lost contact with the person - <code>Deceased</code> - Person is deceased</p> <p>MySQL to PostgreSQL Mapping: | MySQL Value | PostgreSQL Enum | Description | |-------------|-----------------|-------------| | 'A' | 'Active' | Active member | | 'I' | 'In-active' | Inactive member | | 'L' | 'Lost' | Lost contact | | 'D' | 'Deceased' | Deceased member |</p>"},{"location":"schema/enums/#person-code-enum","title":"Person Code Enum","text":"<p>Categorizes the person's relationship to the organization. <pre><code>CREATE TYPE person_code_enum AS ENUM ('Alumni', 'Undergrad', 'Parent', 'Friend', 'Alumni/Parent');\n</code></pre></p> <p>Values: - <code>Alumni</code> - Graduate/former member - <code>Undergrad</code> - Current undergraduate member - <code>Parent</code> - Parent of a member - <code>Friend</code> - Friend of the organization - <code>Alumni/Parent</code> - Person who is both alumni and parent</p> <p>MySQL to PostgreSQL Mapping: | MySQL Value | PostgreSQL Enum | Description | |-------------|-----------------|-------------| | 'A' | 'Alumni' | Alumni/graduate member | | 'U' | 'Undergrad' | Undergraduate member | | 'P' | 'Parent' | Parent of member | | 'F' | 'Friend' | Friend of organization | | 'X' | 'Alumni/Parent' | Alumni who is also a parent |</p>"},{"location":"schema/enums/#marital-status-enum","title":"Marital Status Enum","text":"<p>Tracks marital status of individuals. <pre><code>CREATE TYPE marital_status_enum AS ENUM ('Single','Married','Widowed','Divorced','Unknown');\n</code></pre></p> <p>Values: - <code>Single</code> - Not married - <code>Married</code> - Currently married - <code>Widowed</code> - Spouse is deceased - <code>Divorced</code> - Previously married, now divorced - <code>Unknown</code> - Marital status unknown</p> <p>MySQL to PostgreSQL Mapping: | MySQL Value | PostgreSQL Enum | Description | |-------------|-----------------|-------------| | 'S' | 'Single' | Single/unmarried | | 'M' | 'Married' | Currently married | | 'W' | 'Widowed' | Widowed | | 'D' | 'Divorced' | Divorced | | '?' | 'Unknown' | Unknown marital status |</p>"},{"location":"schema/enums/#organization-and-date-enums","title":"Organization and Date Enums","text":""},{"location":"schema/enums/#year-type-enum","title":"Year Type Enum","text":"<p>Defines what type of year is being referenced for the organization. <pre><code>CREATE TYPE year_type_enum AS ENUM ('Initiation', 'Graduation');\n</code></pre></p> <p>Values: - <code>Initiation</code> - Year refers to initiation date - <code>Graduation</code> - Year refers to graduation date</p>"},{"location":"schema/enums/#address-and-location-enums","title":"Address and Location Enums","text":""},{"location":"schema/enums/#address-type-enum","title":"Address Type Enum","text":"<p>Categorizes different types of addresses. <pre><code>CREATE TYPE address_type_enum AS ENUM (\n  'Home', 'Business', 'Mailing', 'Billing', 'Shipping',\n  'Summer Home', 'Winter Home', 'Previous', 'Other'\n);\n</code></pre></p> <p>Values: - <code>Home</code> - Primary residence - <code>Business</code> - Work/business address - <code>Mailing</code> - Preferred mailing address - <code>Billing</code> - Billing address for financial transactions - <code>Shipping</code> - Address for shipping items - <code>Summer Home</code> - Seasonal summer residence - <code>Winter Home</code> - Seasonal winter residence - <code>Previous</code> - Former address - <code>Other</code> - Other address type</p> <p>MySQL to PostgreSQL Mapping: | MySQL Value | PostgreSQL Enum | Description | |-------------|-----------------|-------------| | 'Home' | 'Home' | Primary residence | | 'Business' | 'Business' | Work/business address | | 'Summer Home' | 'Summer Home' | Seasonal summer residence | | 'Winter Home' | 'Winter Home' | Seasonal winter residence | | 'Other' | 'Other' | Other address type | | Any unmapped value | 'Mailing' | Default for new address types |</p>"},{"location":"schema/enums/#geocode-accuracy-enum","title":"Geocode Accuracy Enum","text":"<p>Indicates the accuracy level of geocoded addresses. <pre><code>CREATE TYPE geocode_accuracy_enum AS ENUM (\n  'ROOFTOP', 'RANGE_INTERPOLATED', 'GEOMETRIC_CENTER',\n  'APPROXIMATE', 'UNKNOWN'\n);\n</code></pre></p> <p>Values: - <code>ROOFTOP</code> - Exact building location - <code>RANGE_INTERPOLATED</code> - Interpolated from address range - <code>GEOMETRIC_CENTER</code> - Center of geographic area - <code>APPROXIMATE</code> - Approximate location - <code>UNKNOWN</code> - Accuracy unknown</p>"},{"location":"schema/enums/#validation-status-enum","title":"Validation Status Enum","text":"<p>Tracks validation status of addresses and contact information. <pre><code>CREATE TYPE validation_status_enum AS ENUM (\n  'VERIFIED', 'UNVERIFIED', 'INVALID', 'PENDING', 'FAILED'\n);\n</code></pre></p> <p>Values: - <code>VERIFIED</code> - Information has been verified as correct - <code>UNVERIFIED</code> - Information has not been verified - <code>INVALID</code> - Information is known to be invalid - <code>PENDING</code> - Verification is in progress - <code>FAILED</code> - Verification attempt failed</p>"},{"location":"schema/enums/#contact-information-enums","title":"Contact Information Enums","text":""},{"location":"schema/enums/#email-type-enum","title":"Email Type Enum","text":"<p>Categorizes email addresses by their purpose. <pre><code>CREATE TYPE email_type_enum AS ENUM (\n  'Personal', 'Work', 'Alumni', 'School', 'Other'\n);\n</code></pre></p> <p>Values: - <code>Personal</code> - Personal email address - <code>Work</code> - Work/business email address - <code>Alumni</code> - Alumni-specific email address - <code>School</code> - School-provided email address - <code>Other</code> - Other email type</p>"},{"location":"schema/enums/#phone-type-enum","title":"Phone Type Enum","text":"<p>Categorizes phone numbers by their purpose. <pre><code>CREATE TYPE phone_type_enum AS ENUM (\n  'Mobile', 'Home', 'Work', 'Fax', 'Emergency', 'Other'\n);\n</code></pre></p> <p>Values: - <code>Mobile</code> - Mobile/cell phone - <code>Home</code> - Home phone number - <code>Work</code> - Work phone number - <code>Fax</code> - Fax number - <code>Emergency</code> - Emergency contact number - <code>Other</code> - Other phone type</p> <p>MySQL to PostgreSQL Mapping: | MySQL Value | PostgreSQL Enum | Description | |-------------|-----------------|-------------| | 'Cell' | 'Mobile' | Mobile/cell phone | | 'Home' | 'Home' | Home phone number | | 'Work' | 'Work' | Work phone number | | 'Fax' | 'Fax' | Fax number | | 'Other' | 'Other' | Other phone type | | Any unmapped value | 'Other' | Default for unknown types |</p>"},{"location":"schema/enums/#communication-preference-enums","title":"Communication Preference Enums","text":""},{"location":"schema/enums/#contact-method-enum","title":"Contact Method Enum","text":"<p>Defines preferred methods of contact. <pre><code>CREATE TYPE contact_method_enum AS ENUM (\n  'Email', 'Phone', 'Text', 'Mail', 'Social Media'\n);\n</code></pre></p> <p>Values: - <code>Email</code> - Contact via email - <code>Phone</code> - Contact via phone call - <code>Text</code> - Contact via text message - <code>Mail</code> - Contact via postal mail - <code>Social Media</code> - Contact via social media platforms</p>"},{"location":"schema/enums/#contact-frequency-enum","title":"Contact Frequency Enum","text":"<p>Defines how often contact should occur. <pre><code>CREATE TYPE contact_frequency_enum AS ENUM (\n  'Daily', 'Weekly', 'Monthly', 'Quarterly', 'Annually', 'Never'\n);\n</code></pre></p> <p>Values: - <code>Daily</code> - Daily contact preferred - <code>Weekly</code> - Weekly contact preferred - <code>Monthly</code> - Monthly contact preferred - <code>Quarterly</code> - Quarterly contact preferred - <code>Annually</code> - Annual contact preferred - <code>Never</code> - No contact preferred</p> <p>MySQL to PostgreSQL Mapping: | MySQL Value | PostgreSQL Enum | Description | |-------------|-----------------|-------------| | 'Daily' | 'Daily' | Daily contact preferred | | 'Weekly' | 'Weekly' | Weekly contact preferred | | 'Monthly' | 'Monthly' | Monthly contact preferred | | 'Annually' | 'Annually' | Annual contact preferred | | Any unmapped value | 'Monthly' | Default frequency |</p>"},{"location":"schema/enums/#contact-time-enum","title":"Contact Time Enum","text":"<p>Defines preferred times for contact. <pre><code>CREATE TYPE contact_time_enum AS ENUM (\n  'Morning', 'Afternoon', 'Evening', 'Weekends', 'Anytime'\n);\n</code></pre></p> <p>Values: - <code>Morning</code> - Prefer morning contact - <code>Afternoon</code> - Prefer afternoon contact - <code>Evening</code> - Prefer evening contact - <code>Weekends</code> - Prefer weekend contact - <code>Anytime</code> - No time preference</p>"},{"location":"schema/enums/#employment-enums","title":"Employment Enums","text":""},{"location":"schema/enums/#employment-status-enum","title":"Employment Status Enum","text":"<p>Categorizes employment status. <pre><code>CREATE TYPE employment_status_enum AS ENUM (\n  'Full-time', 'Part-time', 'Contract', 'Consulting',\n  'Retired', 'Self-employed', 'Unemployed', 'Student'\n);\n</code></pre></p> <p>Values: - <code>Full-time</code> - Full-time employee - <code>Part-time</code> - Part-time employee - <code>Contract</code> - Contract worker - <code>Consulting</code> - Independent consultant - <code>Retired</code> - Retired from work - <code>Self-employed</code> - Self-employed/business owner - <code>Unemployed</code> - Currently unemployed - <code>Student</code> - Full-time student</p>"},{"location":"schema/enums/#work-arrangement-enum","title":"Work Arrangement Enum","text":"<p>Defines work arrangement types. <pre><code>CREATE TYPE work_arrangement_enum AS ENUM (\n  'On-site', 'Remote', 'Hybrid', 'Travel', 'Field-based'\n);\n</code></pre></p> <p>Values: - <code>On-site</code> - Works at employer's location - <code>Remote</code> - Works remotely/from home - <code>Hybrid</code> - Mix of on-site and remote work - <code>Travel</code> - Work involves significant travel - <code>Field-based</code> - Work is primarily field-based</p>"},{"location":"schema/enums/#contact-log-enums","title":"Contact Log Enums","text":""},{"location":"schema/enums/#contact-type-enum","title":"Contact Type Enum","text":"<p>Categorizes types of contact interactions. <pre><code>CREATE TYPE contact_type_enum AS ENUM (\n  'Phone Call', 'Email', 'Letter', 'In-Person Meeting',\n  'Text Message', 'Social Media', 'Video Call', 'Voicemail',\n  'Event Contact', 'Newsletter', 'Donation Thank You', 'Other'\n);\n</code></pre></p> <p>Values: - <code>Phone Call</code> - Contact via phone call - <code>Email</code> - Contact via email - <code>Letter</code> - Contact via postal letter - <code>In-Person Meeting</code> - Face-to-face meeting - <code>Text Message</code> - Contact via text/SMS - <code>Social Media</code> - Contact via social media - <code>Video Call</code> - Contact via video call - <code>Voicemail</code> - Left voicemail message - <code>Event Contact</code> - Contact at an event - <code>Newsletter</code> - Newsletter communication - <code>Donation Thank You</code> - Thank you for donation - <code>Other</code> - Other type of contact</p>"},{"location":"schema/enums/#contact-outcome-enum","title":"Contact Outcome Enum","text":"<p>Tracks the outcome of contact attempts. <pre><code>CREATE TYPE contact_outcome_enum AS ENUM (\n  'Successful', 'No Answer', 'Busy', 'Invalid Contact Info',\n  'Declined', 'Callback Requested', 'Follow-up Needed', 'Completed'\n);\n</code></pre></p> <p>Values: - <code>Successful</code> - Contact was successful - <code>No Answer</code> - No answer received - <code>Busy</code> - Contact was busy/unavailable - <code>Invalid Contact Info</code> - Contact information is invalid - <code>Declined</code> - Contact declined to engage - <code>Callback Requested</code> - Contact requested callback - <code>Follow-up Needed</code> - Follow-up action required - <code>Completed</code> - Contact interaction completed</p>"},{"location":"schema/enums/#database-usage-guidelines","title":"Database Usage Guidelines","text":""},{"location":"schema/enums/#best-practices","title":"Best Practices","text":"<ol> <li>Always use enum values exactly as defined - Enums are case-sensitive</li> <li>Handle enum values in application code - Don't rely on database for enum validation alone</li> <li>Plan for enum expansion - Consider future values when designing application logic</li> <li>Use descriptive enum values - Values should be self-documenting</li> </ol>"},{"location":"schema/enums/#query-examples","title":"Query Examples","text":"<pre><code>-- Filter by person status\nSELECT * FROM person WHERE status = 'Active';\n\n-- Group by contact method preference\nSELECT contact_method, COUNT(*)\nFROM contact_preferences\nGROUP BY contact_method;\n\n-- Find people by marital status\nSELECT full_name, marital_status\nFROM person\nWHERE marital_status IN ('Married', 'Single');\n\n-- Contact log summary by type\nSELECT contact_type, COUNT(*) as contact_count\nFROM contact_log\nGROUP BY contact_type\nORDER BY contact_count DESC;\n</code></pre>"},{"location":"schema/enums/#index-performance","title":"Index Performance","text":"<p>Enums provide excellent index performance and are stored efficiently:</p> <pre><code>-- Efficient indexes on enum columns\nCREATE INDEX idx_person_status ON person(status);\nCREATE INDEX idx_contact_type ON contact_log(contact_type);\nCREATE INDEX idx_address_type ON address(address_type);\n</code></pre> <p>This enum system ensures data consistency, improves query performance, and provides clear data validation throughout the GMS database.</p>"},{"location":"schema/enums/#migration-mapping-functions","title":"Migration Mapping Functions","text":"<p>The following functions help convert MySQL enum values to PostgreSQL enum values during migration:</p>"},{"location":"schema/enums/#generic-enum-conversion-function","title":"Generic Enum Conversion Function","text":"<pre><code>-- Generic enum conversion function with fallback\nCREATE OR REPLACE FUNCTION convert_mysql_enum(\n    input_value TEXT,\n    mapping JSONB,\n    default_value TEXT DEFAULT 'Other'\n) RETURNS TEXT AS $$\nDECLARE\n    result TEXT;\nBEGIN\n    -- Handle NULL or empty input\n    IF input_value IS NULL OR TRIM(input_value) = '' THEN\n        RETURN default_value;\n    END IF;\n\n    -- Try direct mapping first\n    result := mapping-&gt;&gt;input_value;\n\n    -- If no mapping found, return default\n    IF result IS NULL THEN\n        result := default_value;\n    END IF;\n\n    RETURN result;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre>"},{"location":"schema/enums/#specific-mapping-functions","title":"Specific Mapping Functions","text":"<pre><code>-- Person status mapping\nCREATE OR REPLACE FUNCTION map_person_status(mysql_status TEXT) RETURNS person_status_enum AS $$\nBEGIN\n    RETURN CASE mysql_status\n        WHEN 'A' THEN 'Active'::person_status_enum\n        WHEN 'I' THEN 'In-active'::person_status_enum\n        WHEN 'L' THEN 'Lost'::person_status_enum\n        WHEN 'D' THEN 'Deceased'::person_status_enum\n        ELSE 'Active'::person_status_enum\n    END;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Person code mapping\nCREATE OR REPLACE FUNCTION map_person_code(mysql_code TEXT) RETURNS person_code_enum AS $$\nBEGIN\n    RETURN CASE mysql_code\n        WHEN 'A' THEN 'Alumni'::person_code_enum\n        WHEN 'U' THEN 'Undergrad'::person_code_enum\n        WHEN 'P' THEN 'Parent'::person_code_enum\n        WHEN 'F' THEN 'Friend'::person_code_enum\n        WHEN 'X' THEN 'Alumni/Parent'::person_code_enum\n        ELSE 'Alumni'::person_code_enum\n    END;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Marital status mapping\nCREATE OR REPLACE FUNCTION map_marital_status(mysql_status TEXT) RETURNS marital_status_enum AS $$\nBEGIN\n    RETURN CASE mysql_status\n        WHEN 'S' THEN 'Single'::marital_status_enum\n        WHEN 'M' THEN 'Married'::marital_status_enum\n        WHEN 'W' THEN 'Widowed'::marital_status_enum\n        WHEN 'D' THEN 'Divorced'::marital_status_enum\n        WHEN '?' THEN 'Unknown'::marital_status_enum\n        ELSE 'Unknown'::marital_status_enum\n    END;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Phone type mapping\nCREATE OR REPLACE FUNCTION map_phone_type(mysql_type TEXT) RETURNS phone_type_enum AS $$\nBEGIN\n    RETURN CASE mysql_type\n        WHEN 'Cell' THEN 'Mobile'::phone_type_enum\n        WHEN 'Home' THEN 'Home'::phone_type_enum\n        WHEN 'Work' THEN 'Work'::phone_type_enum\n        WHEN 'Fax' THEN 'Fax'::phone_type_enum\n        WHEN 'Other' THEN 'Other'::phone_type_enum\n        ELSE 'Other'::phone_type_enum\n    END;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Address type mapping\nCREATE OR REPLACE FUNCTION map_address_type(mysql_type TEXT) RETURNS address_type_enum AS $$\nBEGIN\n    RETURN CASE mysql_type\n        WHEN 'Home' THEN 'Home'::address_type_enum\n        WHEN 'Business' THEN 'Business'::address_type_enum\n        WHEN 'Summer Home' THEN 'Summer Home'::address_type_enum\n        WHEN 'Winter Home' THEN 'Winter Home'::address_type_enum\n        WHEN 'Other' THEN 'Other'::address_type_enum\n        ELSE 'Other'::address_type_enum\n    END;\nEND;\n$$ LANGUAGE plpgsql;\n\n-- Contact frequency mapping\nCREATE OR REPLACE FUNCTION map_contact_frequency(mysql_freq TEXT) RETURNS contact_frequency_enum AS $$\nBEGIN\n    RETURN CASE mysql_freq\n        WHEN 'Daily' THEN 'Daily'::contact_frequency_enum\n        WHEN 'Weekly' THEN 'Weekly'::contact_frequency_enum\n        WHEN 'Monthly' THEN 'Monthly'::contact_frequency_enum\n        WHEN 'Annually' THEN 'Annually'::contact_frequency_enum\n        ELSE 'Monthly'::contact_frequency_enum\n    END;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre>"},{"location":"schema/enums/#migration-usage-examples","title":"Migration Usage Examples","text":"<pre><code>-- Example usage during data migration\nUPDATE person\nSET status = map_person_status(mysql_mstatus),\n    code = map_person_code(mysql_mcode);\n\nUPDATE family\nSET marital_status = map_marital_status(mysql_mar_status);\n\nUPDATE phone_number\nSET phone_type = map_phone_type(mysql_ptype);\n\nUPDATE address\nSET address_type = map_address_type(mysql_atype);\n</code></pre>"},{"location":"schema/enums/#validation-queries-for-migration","title":"Validation Queries for Migration","text":"<pre><code>-- Check for unmapped values before migration\nSELECT\n    'person_status' as field_name,\n    mysql_mstatus as mysql_value,\n    COUNT(*) as count\nFROM mysql_general_frat_info_temp\nWHERE mysql_mstatus NOT IN ('A', 'I', 'L', 'D')\nGROUP BY mysql_mstatus\n\nUNION ALL\n\nSELECT\n    'person_code' as field_name,\n    mysql_mcode as mysql_value,\n    COUNT(*) as count\nFROM mysql_general_frat_info_temp\nWHERE mysql_mcode NOT IN ('A', 'U', 'P', 'F', 'X')\nGROUP BY mysql_mcode\n\nUNION ALL\n\nSELECT\n    'marital_status' as field_name,\n    mysql_mar_status as mysql_value,\n    COUNT(*) as count\nFROM mysql_family_temp\nWHERE mysql_mar_status NOT IN ('S', 'M', 'W', 'D', '?')\nGROUP BY mysql_mar_status\n\nUNION ALL\n\nSELECT\n    'phone_type' as field_name,\n    mysql_ptype as mysql_value,\n    COUNT(*) as count\nFROM mysql_phone_temp\nWHERE mysql_ptype NOT IN ('Home', 'Work', 'Cell', 'Fax', 'Other')\nGROUP BY mysql_ptype\n\nORDER BY field_name, count DESC;\n</code></pre> <p>This comprehensive mapping system ensures accurate data migration from MySQL to PostgreSQL while maintaining data integrity and consistency.</p>"},{"location":"schema/table-mappings/","title":"Table Mappings","text":"<p>This page provides a comprehensive reference for how MySQL tables are mapped to PostgreSQL tables during the migration process.</p>"},{"location":"schema/table-mappings/#complete-table-mapping-reference","title":"Complete Table Mapping Reference","text":""},{"location":"schema/table-mappings/#core-entity-mappings","title":"Core Entity Mappings","text":"MySQL Table PostgreSQL Table Migration Type Notes <code>Donor_Group</code> (main_group=1) <code>organization</code> Direct Organizations only <code>Donor_Group</code> (main_group=0) <code>chapter_group</code> Direct Chapter groups with org mapping <code>Donor</code> <code>person</code> Enhanced Core person entity with UUID conversion <code>Member</code> <code>person_chapter_group</code> Many-to-Many Chapter membership relationships"},{"location":"schema/table-mappings/#contact-and-communication","title":"Contact and Communication","text":"MySQL Table PostgreSQL Table Migration Type Notes <code>Address</code> (primary) <code>address</code> Enhanced Main address to contact table <code>Address</code> (non-primary) <code>address</code> Enhanced Additional addresses <code>Email</code> <code>email</code> Direct Email data to contact table <code>Phone</code> <code>phone</code> Direct Phone data to contact table <code>Donor</code> (social fields) <code>social_media</code> Extracted Social media profiles <code>Contacted</code> <code>contact_log</code> Enhanced Contact tracking with follow-up features"},{"location":"schema/table-mappings/#events-and-participation","title":"Events and Participation","text":"MySQL Table PostgreSQL Table Migration Type Notes <code>Event</code> <code>event</code> Enhanced With organization mapping <code>Participates</code> <code>participates</code> Direct Event attendance with ID mapping"},{"location":"schema/table-mappings/#financial-data","title":"Financial Data","text":"MySQL Table PostgreSQL Table Migration Type Notes <code>Finance</code> <code>finance</code> Enhanced Gift and pledge information <code>Charge</code> <code>transaction</code> Combined Type: 'charge' <code>Payment</code> <code>transaction</code> Combined Type: 'payment'"},{"location":"schema/table-mappings/#relationships-and-history","title":"Relationships and History","text":"MySQL Table PostgreSQL Table Migration Type Notes <code>Family</code> <code>family</code> Direct Family and relationship data <code>Schools</code> <code>education</code> Direct Education history <code>Job</code> <code>employment</code> Direct Employment history"},{"location":"schema/table-mappings/#campaign-and-volunteer","title":"Campaign and Volunteer","text":"MySQL Table PostgreSQL Table Migration Type Notes <code>Prospect</code> <code>prospect</code> Direct Campaign prospects <code>Volunteer</code> <code>volunteer</code> Direct Volunteer information <code>Feasibility_Campaign_Info</code> <code>feasibility_campaign_info</code> Direct Campaign feasibility data"},{"location":"schema/table-mappings/#recognition-and-awards","title":"Recognition and Awards","text":"MySQL Table PostgreSQL Table Migration Type Notes <code>Hall_Of_Fame</code> <code>hall_of_fame</code> Direct Hall of fame records <code>Man_Of_Year</code> <code>man_of_year</code> Direct Man of the year awards <code>Leadership</code> <code>leadership</code> Direct Leadership roles <code>Donor_Status</code> <code>donor_status</code> Direct Donor recognition status <code>Key_Players</code> <code>key_players</code> Direct Key player designations"},{"location":"schema/table-mappings/#migration-type-definitions","title":"Migration Type Definitions","text":""},{"location":"schema/table-mappings/#direct-migration","title":"Direct Migration","text":"<p>Tables that are migrated with minimal structural changes: - Field names may be updated for consistency - Data types are converted to PostgreSQL equivalents - Primary keys converted from INT to UUID - Foreign keys updated to reference new UUIDs</p>"},{"location":"schema/table-mappings/#enhanced-migration","title":"Enhanced Migration","text":"<p>Tables that receive significant improvements: - Additional fields for enhanced functionality - Better data validation and constraints - Improved indexing strategies - Enhanced enum types and value validation</p>"},{"location":"schema/table-mappings/#extracted-migration","title":"Extracted Migration","text":"<p>Data extracted from one table into multiple normalized tables: - Improves data organization and reduces redundancy - Enables better querying and reporting - Maintains referential integrity through foreign keys</p>"},{"location":"schema/table-mappings/#combined-migration","title":"Combined Migration","text":"<p>Multiple tables combined into a single, more efficient structure: - Reduces complexity and improves performance - Maintains all original data through type fields - Simplifies queries and reporting</p>"},{"location":"schema/table-mappings/#many-to-many-migration","title":"Many-to-Many Migration","text":"<p>Relationship tables that connect entities: - Properly normalized many-to-many relationships - Enhanced with additional metadata where applicable - Foreign key constraints ensure data integrity</p>"},{"location":"schema/table-mappings/#field-naming-conventions","title":"Field Naming Conventions","text":""},{"location":"schema/table-mappings/#standardization-changes","title":"Standardization Changes","text":"<p>The migration applies consistent naming conventions:</p> MySQL Pattern PostgreSQL Pattern Example <code>camelCase</code> <code>snake_case</code> <code>firstName</code> \u2192 <code>first_name</code> <code>PascalCase</code> <code>snake_case</code> <code>LastName</code> \u2192 <code>last_name</code> <code>lowercase</code> <code>snake_case</code> <code>phonenumber</code> \u2192 <code>phone_number</code> <code>UPPERCASE</code> <code>lowercase</code> <code>EMAIL</code> \u2192 <code>email</code>"},{"location":"schema/table-mappings/#reserved-word-handling","title":"Reserved Word Handling","text":"<p>PostgreSQL reserved words are handled appropriately:</p> MySQL Field PostgreSQL Field Reason <code>order</code> <code>sort_order</code> <code>ORDER</code> is reserved in PostgreSQL <code>user</code> <code>user_name</code> <code>USER</code> is reserved in PostgreSQL <code>group</code> <code>group_name</code> <code>GROUP</code> is reserved in PostgreSQL"},{"location":"schema/table-mappings/#data-relationship-mapping","title":"Data Relationship Mapping","text":""},{"location":"schema/table-mappings/#primary-key-conversion","title":"Primary Key Conversion","text":"<p>All MySQL auto-increment primary keys are converted to PostgreSQL UUIDs:</p> <pre><code>-- MySQL\ndonor_id INT AUTO_INCREMENT PRIMARY KEY\n\n-- PostgreSQL\nid UUID PRIMARY KEY DEFAULT gen_random_uuid()\n</code></pre>"},{"location":"schema/table-mappings/#foreign-key-relationships","title":"Foreign Key Relationships","text":"<p>Foreign key relationships are maintained and enhanced:</p> <pre><code>-- MySQL\ndonor_id INT REFERENCES Donor(donor_id)\n\n-- PostgreSQL\nperson_id UUID REFERENCES person(id) ON DELETE CASCADE\n</code></pre>"},{"location":"schema/table-mappings/#composite-relationships","title":"Composite Relationships","text":"<p>Some tables require composite key handling:</p> <pre><code>-- Example: Event participation\n-- MySQL: (donor_id, event_id)\n-- PostgreSQL: (person_id, event_id) with UUIDs\n</code></pre>"},{"location":"schema/table-mappings/#special-handling-cases","title":"Special Handling Cases","text":""},{"location":"schema/table-mappings/#donor_group-split","title":"Donor_Group Split","text":"<p>The <code>Donor_Group</code> table is split based on the <code>main_group</code> field:</p> <pre><code>-- Organizations (main_group = 1)\nINSERT INTO organization (...)\nSELECT ... FROM Donor_Group WHERE main_group = 1;\n\n-- Chapter Groups (main_group = 0)\nINSERT INTO chapter_group (...)\nSELECT ... FROM Donor_Group WHERE main_group = 0;\n</code></pre>"},{"location":"schema/table-mappings/#address-normalization","title":"Address Normalization","text":"<p>Address data is normalized based on importance:</p> <pre><code>-- Primary address \u2192 contact table\n-- Additional addresses \u2192 address table\n</code></pre>"},{"location":"schema/table-mappings/#transaction-combination","title":"Transaction Combination","text":"<p>Financial transactions are combined with type discrimination:</p> <pre><code>-- Charges\nINSERT INTO transaction (type, ...)\nSELECT 'charge', ... FROM Charge;\n\n-- Payments\nINSERT INTO transaction (type, ...)\nSELECT 'payment', ... FROM Payment;\n</code></pre>"},{"location":"schema/table-mappings/#migration-order-dependencies","title":"Migration Order Dependencies","text":"<p>The migration order is critical due to foreign key dependencies:</p> <pre><code>graph TD\n    A[Organizations] --&gt; B[Persons]\n    B --&gt; C[Addresses]\n    B --&gt; D[Social Media]\n    B --&gt; E[Contact Info]\n    A --&gt; F[Events]\n    B --&gt; F\n    F --&gt; G[Participates]\n    B --&gt; H[Finance]\n    H --&gt; I[Transactions]\n    B --&gt; J[Family]\n    B --&gt; K[Education]\n    B --&gt; L[Employment]\n    B --&gt; M[Campaign Data]\n    B --&gt; N[Contact Log]\n</code></pre>"},{"location":"schema/table-mappings/#dependency-rules","title":"Dependency Rules","text":"<ol> <li>Organizations before Persons: Person records may reference organizations</li> <li>Persons before Everything Else: Most tables have foreign keys to person</li> <li>Events before Participates: Participation requires existing events</li> <li>Finance before Transactions: Transactions reference finance records</li> </ol>"},{"location":"schema/table-mappings/#validation-and-integrity","title":"Validation and Integrity","text":""},{"location":"schema/table-mappings/#post-migration-validation","title":"Post-Migration Validation","text":"<p>After migration, several validation checks ensure data integrity:</p>"},{"location":"schema/table-mappings/#1-record-count-validation","title":"1. Record Count Validation","text":"<pre><code>-- Verify all records migrated\nSELECT\n    'donor' as table_name,\n    COUNT(*) as mysql_count\nFROM mysql.Donor\nUNION ALL\nSELECT\n    'person' as table_name,\n    COUNT(*) as postgres_count\nFROM person;\n</code></pre>"},{"location":"schema/table-mappings/#2-foreign-key-integrity","title":"2. Foreign Key Integrity","text":"<pre><code>-- Check for orphaned records\nSELECT table_name, COUNT(*) as orphaned_records\nFROM (\n    SELECT 'address' as table_name\n    FROM address a\n    LEFT JOIN person p ON a.person_id = p.id\n    WHERE p.id IS NULL\n\n    UNION ALL\n\n    SELECT 'contact_log' as table_name\n    FROM contact_log cl\n    LEFT JOIN person p ON cl.person_id = p.id\n    WHERE p.id IS NULL\n\n    -- Additional orphan checks...\n) orphan_checks\nGROUP BY table_name;\n</code></pre>"},{"location":"schema/table-mappings/#3-data-quality-checks","title":"3. Data Quality Checks","text":"<pre><code>-- Verify data quality\nSELECT\n    'person' as table_name,\n    COUNT(CASE WHEN first_name IS NULL OR first_name = '' THEN 1 END) as missing_first_names,\n    COUNT(CASE WHEN last_name IS NULL OR last_name = '' THEN 1 END) as missing_last_names\nFROM person;\n</code></pre> <p>This mapping reference ensures that all data relationships are properly maintained during the migration from MySQL to PostgreSQL while taking advantage of modern database features and improved data organization.</p>"},{"location":"tables/address/","title":"Address Table Migration","text":"<p>The Address table represents the migration of non-primary address data from MySQL's <code>Address</code> table to PostgreSQL's <code>address</code> table, supporting multiple addresses per person with enhanced international address support.</p>"},{"location":"tables/address/#overview","title":"Overview","text":"<p>The address system is split during migration - primary addresses go to the <code>contact</code> table, while additional addresses are stored in the dedicated <code>address</code> table. This provides better normalization and supports multiple address types per person.</p>"},{"location":"tables/address/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/address/#mysql-source-table-address","title":"MySQL Source Table: <code>Address</code>","text":"<pre><code>CREATE TABLE `Address` (\n  `aid` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `donor_id` int(10) unsigned NOT NULL DEFAULT 0,\n  `street1` varchar(255) NOT NULL DEFAULT '',\n  `street2` varchar(255) NOT NULL DEFAULT '',\n  `city` varchar(45) NOT NULL DEFAULT '',\n  `state` enum('','AL','AK','AS','AZ','AR','CA','CO','CT','DE','DC','FL','GA','GU','HI','ID','IL','IN','IA','KS','KY','LA','ME','MD','MA','MI','MN','MS','MO','MT','NE','NV','NH','NJ','NM','NY','NC','ND','OH','OK','OR','PW','PA','PR','RI','SC','SD','SP','TN','TX','UT','VT','VI','VA','WA','WV','WI','WY') DEFAULT NULL,\n  `zip` varchar(45) NOT NULL DEFAULT '',\n  `entered_by` varchar(45) DEFAULT NULL,\n  `date` date DEFAULT NULL,\n  `main` tinyint(1) NOT NULL DEFAULT 0,\n  `valid` tinyint(1) DEFAULT NULL,\n  `comments` text NOT NULL DEFAULT '',\n  `last_changed` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),\n  `atype` enum('Home','Business','Summer Home','Winter Home','Other') NOT NULL DEFAULT 'Other',\n  `country` varchar(45) DEFAULT NULL,\n  PRIMARY KEY (`aid`),\n  KEY `Address_FK_Index` (`donor_id`),\n  CONSTRAINT `0_1653` FOREIGN KEY (`donor_id`) REFERENCES `Donor` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION\n) ENGINE=InnoDB AUTO_INCREMENT=389155 DEFAULT CHARSET=latin1 COLLATE=latin1_swedish_ci;\n</code></pre>"},{"location":"tables/address/#postgresql-target-table-address","title":"PostgreSQL Target Table: <code>address</code>","text":"<pre><code>CREATE TABLE IF NOT EXISTS address (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  person_id UUID REFERENCES person(id) ON DELETE CASCADE,\n  organization_id UUID REFERENCES organization(id) ON DELETE CASCADE,\n\n  -- Address components\n  organization text,                -- Organization name (if applicable)\n  street text[],                -- Street address (can be multiple lines)\n\n  -- Geographic components\n  locality VARCHAR(100) NOT NULL, -- City/Town\n  administrative_area VARCHAR(100), -- State/Province/Region\n  postal_code VARCHAR(20) NOT NULL,    -- ZIP/postal code\n  plus4 VARCHAR(10),                   -- ZIP+4 extension\n  country VARCHAR(100) DEFAULT 'United States',\n  country_code CHAR(2) DEFAULT 'US',   -- ISO country code\n\n  -- Geocoding and validation\n  latitude DECIMAL(10, 8),\n  longitude DECIMAL(11, 8),\n  geocode_accuracy geocode_accuracy_enum,        -- ROOFTOP, RANGE_INTERPOLATED, etc.\n\n  -- Address metadata\n  address_type address_type_enum NOT NULL DEFAULT 'Home',\n  is_primary BOOLEAN NOT NULL DEFAULT FALSE,\n  is_mailing BOOLEAN NOT NULL DEFAULT TRUE,\n  validation_status validation_status_enum,       -- VERIFIED, UNVERIFIED, INVALID\n  validation_date TIMESTAMP,\n\n  -- Administrative fields\n  effective_date DATE DEFAULT CURRENT_DATE,\n  end_date DATE,\n  entered_by VARCHAR(100),\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  comments TEXT,\n\n  -- Constraints\n  CONSTRAINT chk_address_owner CHECK (\n    (person_id IS NOT NULL AND organization_id IS NULL) OR\n    (person_id IS NULL AND organization_id IS NOT NULL)\n  ),\n  CONSTRAINT chk_date_range CHECK (end_date IS NULL OR effective_date &lt;= end_date),\n  CONSTRAINT chk_coordinates CHECK (\n    (latitude IS NULL AND longitude IS NULL) OR\n    (latitude IS NOT NULL AND longitude IS NOT NULL AND\n     latitude BETWEEN -90 AND 90 AND longitude BETWEEN -180 AND 180)\n  )\n);\n\n-- Create partial unique indexes for primary addresses (only applies when is_primary = true)\nCREATE UNIQUE INDEX idx_primary_address_person ON address (person_id) WHERE is_primary = true;\nCREATE UNIQUE INDEX idx_primary_address_org ON address (organization_id) WHERE is_primary = true;\n</code></pre>"},{"location":"tables/address/#postgresql-address-type-enum","title":"PostgreSQL Address Type Enum","text":"<pre><code>CREATE TYPE address_type_enum AS ENUM (\n  'Home', 'Business', 'Mailing', 'Billing', 'Shipping',\n  'Summer Home', 'Winter Home', 'Previous', 'Other'\n);\n</code></pre>"},{"location":"tables/address/#key-changes-and-improvements","title":"Key Changes and Improvements","text":""},{"location":"tables/address/#1-primary-key-modernization","title":"1. Primary Key Modernization","text":"<p>MySQL: Auto-increment integer <pre><code>aid INT AUTO_INCREMENT PRIMARY KEY\n</code></pre></p> <p>PostgreSQL: UUID for better distributed system support <pre><code>id UUID PRIMARY KEY DEFAULT gen_random_uuid()\n</code></pre></p>"},{"location":"tables/address/#2-enhanced-data-structure","title":"2. Enhanced Data Structure","text":""},{"location":"tables/address/#address-components-enhancement","title":"Address Components Enhancement","text":"<p>MySQL: Traditional street fields <pre><code>street1 varchar(255),\nstreet2 varchar(255),\ncity varchar(45)\n</code></pre></p> <p>PostgreSQL: Modern address structure with international support <pre><code>organization text,                     -- Organization name (if applicable)\nstreet text[],                        -- Street address (can be multiple lines)\nlocality VARCHAR(100) NOT NULL,       -- City/Town\nadministrative_area VARCHAR(100)      -- State/Province/Region\n</code></pre></p>"},{"location":"tables/address/#international-address-support","title":"International Address Support","text":"<p>MySQL: Limited postal code and country support <pre><code>state ENUM(...),\nzip varchar(45),\ncountry varchar(45)\n</code></pre></p> <p>PostgreSQL: Comprehensive international support <pre><code>postal_code VARCHAR(20) NOT NULL,     -- ZIP/postal code\nplus4 VARCHAR(10),                    -- ZIP+4 extension\ncountry VARCHAR(100) DEFAULT 'United States',\ncountry_code CHAR(2) DEFAULT 'US'     -- ISO country code\n</code></pre></p>"},{"location":"tables/address/#enhanced-address-types","title":"Enhanced Address Types","text":"<p>MySQL: Basic enum <pre><code>atype enum('Home','Business','Summer Home','Winter Home','Other')\n</code></pre></p> <p>PostgreSQL: Extended custom enum with additional types <pre><code>address_type address_type_enum NOT NULL DEFAULT 'Home'\n-- Includes: 'Home', 'Business', 'Mailing', 'Billing', 'Shipping',\n-- 'Summer Home', 'Winter Home', 'Previous', 'Other'\n</code></pre></p>"},{"location":"tables/address/#3-address-validation-and-geocoding","title":"3. Address Validation and Geocoding","text":""},{"location":"tables/address/#geocoding-and-location-data","title":"Geocoding and Location Data","text":"<p>MySQL: No geocoding support <pre><code>-- No geocoding fields\n</code></pre></p> <p>PostgreSQL: Comprehensive geocoding and validation support <pre><code>latitude DECIMAL(10, 8),\nlongitude DECIMAL(11, 8),\ngeocode_accuracy geocode_accuracy_enum,        -- ROOFTOP, RANGE_INTERPOLATED, etc.\nvalidation_status validation_status_enum,      -- VERIFIED, UNVERIFIED, INVALID\nvalidation_date TIMESTAMP\n</code></pre></p>"},{"location":"tables/address/#address-management-features","title":"Address Management Features","text":"<p>MySQL: Basic main address flag <pre><code>main tinyint(1) NOT NULL DEFAULT 0\n</code></pre></p> <p>PostgreSQL: Enhanced address management <pre><code>is_primary BOOLEAN NOT NULL DEFAULT FALSE,\nis_mailing BOOLEAN NOT NULL DEFAULT TRUE,\neffective_date DATE DEFAULT CURRENT_DATE,\nend_date DATE\n</code></pre></p>"},{"location":"tables/address/#4-audit-and-timestamps","title":"4. Audit and Timestamps","text":"<p>MySQL: Basic timestamp and entry tracking <pre><code>last_changed timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),\nentered_by varchar(45) DEFAULT NULL,\ndate date DEFAULT NULL\n</code></pre></p> <p>PostgreSQL: Enhanced audit trail with timezone support <pre><code>created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\nlast_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\nentered_by VARCHAR(100),\neffective_date DATE DEFAULT CURRENT_DATE,\nend_date DATE\n</code></pre></p>"},{"location":"tables/address/#migration-logic","title":"Migration Logic","text":""},{"location":"tables/address/#1-uuid-generation-and-mapping","title":"1. UUID Generation and Mapping","text":"<pre><code>-- Create mapping for address records\nINSERT INTO id_mapping (mysql_table, mysql_id, postgres_id)\nSELECT 'address', aid, gen_random_uuid()\nFROM mysql.Address\nWHERE NOT is_primary_address(donor_id, aid);\n</code></pre>"},{"location":"tables/address/#2-person-id-resolution","title":"2. Person ID Resolution","text":"<p>A mapping of <code>Donor.id</code> to <code>Person.id</code> is stored during the migration. This mapping is available in the <code>personMapping</code> field in the checkpoint file.</p>"},{"location":"tables/address/#3-data-validation-and-cleanup","title":"3. Data Validation and Cleanup","text":"<p>During migration the <code>github.com/Boostport/address</code> library is used to validate and normalize addresses from MySQL.</p>"},{"location":"tables/address/#field-mapping-reference","title":"Field Mapping Reference","text":""},{"location":"tables/address/#complete-mysql-to-postgresql-field-mapping","title":"Complete MySQL to PostgreSQL Field Mapping","text":"MySQL Field PostgreSQL Field Type Change Notes <code>aid</code> <code>id</code> INT \u2192 UUID Primary key conversion <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Foreign key with person mapping <code>street1</code>, <code>street2</code> <code>street</code> VARCHAR(255) \u2192 TEXT[] Array for multiple street lines <code>city</code> <code>locality</code> VARCHAR(45) \u2192 VARCHAR(100) Field renamed and expanded <code>state</code> <code>administrative_area</code> ENUM \u2192 VARCHAR(100) International support <code>zip</code> <code>postal_code</code> VARCHAR(45) \u2192 VARCHAR(20) Standardized postal code support <code>country</code> <code>country</code> VARCHAR(45) \u2192 VARCHAR(100) Enhanced country support <code>atype</code> <code>address_type</code> ENUM \u2192 CUSTOM ENUM Enhanced address types <code>main</code> <code>is_primary</code> TINYINT(1) \u2192 BOOLEAN Primary address designation <code>valid</code> <code>validation_status</code> TINYINT(1) \u2192 ENUM Enhanced validation tracking <code>date</code> <code>effective_date</code> DATE \u2192 DATE Field renamed <code>entered_by</code> <code>entered_by</code> VARCHAR(45) \u2192 VARCHAR(100) Increased capacity <code>last_changed</code> <code>created_at</code>, <code>last_changed</code> TIMESTAMP \u2192 TIMESTAMP Separate creation and update tracking <code>comments</code> <code>comments</code> TEXT \u2192 TEXT Direct mapping"},{"location":"tables/address/#new-fields-postgresql-only","title":"New Fields (PostgreSQL Only)","text":"Field Type Purpose <code>organization_id</code> UUID Support for organization addresses <code>organization</code> TEXT Organization name field <code>plus4</code> VARCHAR(10) ZIP+4 extension support <code>country_code</code> CHAR(2) ISO country code <code>latitude</code> DECIMAL(10, 8) Geocoding latitude <code>longitude</code> DECIMAL(11, 8) Geocoding longitude <code>geocode_accuracy</code> ENUM Geocoding accuracy level <code>is_mailing</code> BOOLEAN Mailing address designation <code>validation_date</code> TIMESTAMP Address validation timestamp <code>end_date</code> DATE Address validity end date"},{"location":"tables/address/#indexes-and-performance","title":"Indexes and Performance","text":""},{"location":"tables/address/#primary-and-foreign-key-indexes","title":"Primary and Foreign Key Indexes","text":"<pre><code>-- Primary key index (automatic)\n-- CREATE INDEX automatically created for PRIMARY KEY constraint\n\n-- Foreign key index for person lookups\nCREATE INDEX idx_address_person_id ON address(person_id);\n\n-- Unique indexes for primary addresses (only applies when is_primary = true)\nCREATE UNIQUE INDEX idx_primary_address_person ON address (person_id) WHERE is_primary = true;\nCREATE UNIQUE INDEX idx_primary_address_org ON address (organization_id) WHERE is_primary = true;\n</code></pre>"},{"location":"tables/address/#common-queries","title":"Common Queries","text":""},{"location":"tables/address/#person-address-management","title":"Person Address Management","text":"<pre><code>-- Get all addresses for a person\nSELECT id, address_type, street, locality, administrative_area, postal_code, country, is_primary\nFROM address\nWHERE person_id = $1\n  AND (validation_status IS NULL OR validation_status != 'INVALID')\nORDER BY is_primary DESC, address_type;\n\n-- Find primary address for a person\nSELECT street, locality, administrative_area, postal_code, country\nFROM address\nWHERE person_id = $1\n  AND is_primary = true\n  AND (validation_status IS NULL OR validation_status != 'INVALID');\n\n-- Count addresses per person\nSELECT person_id, COUNT(*) as address_count\nFROM address\nWHERE validation_status != 'INVALID' OR validation_status IS NULL\nGROUP BY person_id\nHAVING COUNT(*) &gt; 1\nORDER BY address_count DESC;\n</code></pre>"},{"location":"tables/address/#geographic-queries","title":"Geographic Queries","text":"<pre><code>-- Find people in a specific city/state\nSELECT DISTINCT p.first_name, p.last_name, a.locality, a.administrative_area\nFROM person p\nJOIN address a ON p.id = a.person_id\nWHERE a.locality = 'San Francisco'\n  AND a.administrative_area = 'CA'\n  AND (a.validation_status IS NULL OR a.validation_status != 'INVALID')\nORDER BY p.last_name, p.first_name;\n\n-- Address distribution by administrative area (state/province)\nSELECT administrative_area, COUNT(*) as address_count\nFROM address\nWHERE (validation_status IS NULL OR validation_status != 'INVALID')\n  AND country = 'United States'\nGROUP BY administrative_area\nORDER BY address_count DESC;\n\n-- International addresses\nSELECT country, COUNT(*) as address_count\nFROM address\nWHERE (validation_status IS NULL OR validation_status != 'INVALID')\n  AND country != 'United States'\nGROUP BY country\nORDER BY address_count DESC;\n\n-- Addresses within geographic bounds (using geocoding)\nSELECT id, street, locality, administrative_area, latitude, longitude\nFROM address\nWHERE latitude BETWEEN 37.7 AND 37.8\n  AND longitude BETWEEN -122.5 AND -122.4\n  AND latitude IS NOT NULL\nORDER BY latitude, longitude;\n</code></pre>"},{"location":"tables/address/#organization-address-queries","title":"Organization Address Queries","text":"<pre><code>-- Get all addresses for an organization\nSELECT id, address_type, street, locality, administrative_area, postal_code\nFROM address\nWHERE organization_id = $1\n  AND (validation_status IS NULL OR validation_status != 'INVALID')\nORDER BY is_primary DESC, address_type;\n\n-- Organizations with multiple locations\nSELECT organization_id, COUNT(*) as location_count\nFROM address\nWHERE organization_id IS NOT NULL\n  AND (validation_status IS NULL OR validation_status != 'INVALID')\nGROUP BY organization_id\nHAVING COUNT(*) &gt; 1\nORDER BY location_count DESC;\n</code></pre>"},{"location":"tables/address/#data-quality-queries","title":"Data Quality Queries","text":"<pre><code>-- Addresses needing verification\nSELECT a.id, p.first_name, p.last_name, a.street, a.locality, a.administrative_area\nFROM address a\nLEFT JOIN person p ON a.person_id = p.id\nWHERE (a.validation_status IS NULL OR a.validation_status = 'UNVERIFIED')\n  AND (a.validation_date IS NULL OR a.validation_date &lt; NOW() - INTERVAL '1 year')\nORDER BY a.validation_date NULLS FIRST;\n\n-- Invalid or problematic addresses\nSELECT a.id,\n       COALESCE(p.first_name || ' ' || p.last_name, o.title) as owner,\n       a.street, a.locality, a.comments\nFROM address a\nLEFT JOIN person p ON a.person_id = p.id\nLEFT JOIN organization o ON a.organization_id = o.id\nWHERE a.validation_status = 'INVALID'\nORDER BY a.last_changed DESC;\n</code></pre>"},{"location":"tables/address/#data-quality-improvements","title":"Data Quality Improvements","text":""},{"location":"tables/address/#1-address-validation","title":"1. Address Validation","text":"<pre><code>-- Add postal code format constraints\nALTER TABLE address\nADD CONSTRAINT chk_address_postal_code_format\nCHECK (\n    (country = 'United States' AND postal_code ~ '^\\d{5}(-\\d{4})?$') OR\n    country != 'United States' OR\n    postal_code IS NULL\n);\n\n-- Ensure required fields\nALTER TABLE address\nADD CONSTRAINT chk_address_required_fields\nCHECK (\n    street IS NOT NULL AND\n    array_length(street, 1) &gt; 0 AND\n    locality IS NOT NULL AND\n    trim(locality) != ''\n);\n\n-- Validate geocoding coordinates (already included in table definition)\n-- latitude BETWEEN -90 AND 90 AND longitude BETWEEN -180 AND 180\n</code></pre>"},{"location":"tables/address/#2-primary-address-management","title":"2. Primary Address Management","text":"<pre><code>-- Function to ensure only one primary address per person\nCREATE OR REPLACE FUNCTION ensure_single_primary_address()\nRETURNS TRIGGER AS $$\nBEGIN\n    IF NEW.is_primary = true THEN\n        -- Set all other addresses for this person to non-primary\n        UPDATE address\n        SET is_primary = false\n        WHERE person_id = NEW.person_id\n          AND id != NEW.id;\n    END IF;\n\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE TRIGGER address_primary_management\n    AFTER INSERT OR UPDATE ON address\n    FOR EACH ROW\n    WHEN (NEW.is_primary = true)\n    EXECUTE FUNCTION ensure_single_primary_address();\n</code></pre>"},{"location":"tables/address/#3-international-address-support","title":"3. International Address Support","text":"<pre><code>// Go functions for international address handling\nfunc normalizePostalCode(code, country string) string {\n    switch country {\n    case \"United States\":\n        return normalizeUSZipCode(code)\n    case \"Canada\":\n        return normalizeCanadianPostalCode(code)\n    case \"United Kingdom\":\n        return normalizeUKPostcode(code)\n    default:\n        return strings.TrimSpace(strings.ToUpper(code))\n    }\n}\n\nfunc isValidCountry(country string) bool {\n    validCountries := []string{\n        \"United States\", \"Canada\", \"United Kingdom\",\n        \"Australia\", \"New Zealand\", \"Germany\", \"France\",\n        // ... additional countries\n    }\n\n    for _, valid := range validCountries {\n        if strings.EqualFold(country, valid) {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>"},{"location":"tables/address/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/address/#common-migration-issues","title":"Common Migration Issues","text":""},{"location":"tables/address/#1-missing-person-references","title":"1. Missing Person References","text":"<pre><code>-- Find addresses with missing person references\nSELECT a.id, a.street1, a.city, a.state\nFROM address a\nLEFT JOIN person p ON a.person_id = p.id\nWHERE p.id IS NULL;\n</code></pre>"},{"location":"tables/address/#2-multiple-primary-addresses","title":"2. Multiple Primary Addresses","text":"<pre><code>-- Check for people with multiple primary addresses\nSELECT person_id, COUNT(*) as primary_count\nFROM address\nWHERE is_primary = true\nGROUP BY person_id\nHAVING COUNT(*) &gt; 1;\n</code></pre>"},{"location":"tables/address/#3-invalid-address-data","title":"3. Invalid Address Data","text":"<pre><code>-- Find addresses with potential data quality issues\nSELECT id, street, locality, administrative_area, postal_code, country\nFROM address\nWHERE (street IS NULL OR array_length(street, 1) = 0)\n   OR (locality IS NULL OR trim(locality) = '')\n   OR (country = 'United States' AND (administrative_area IS NULL OR length(administrative_area) != 2))\n   OR (country = 'United States' AND postal_code !~ '^\\d{5}(-\\d{4})?$')\n   OR (validation_status = 'INVALID');\n</code></pre>"},{"location":"tables/address/#performance-optimization","title":"Performance Optimization","text":""},{"location":"tables/address/#query-optimization","title":"Query Optimization","text":"<ul> <li>Use person_id index for person-based address lookups</li> <li>Use composite indexes for location-based searches</li> <li>Consider partial indexes for frequently queried address types</li> </ul>"},{"location":"tables/address/#data-management","title":"Data Management","text":"<ul> <li>Regular address validation and cleanup processes</li> <li>Batch updates for address verification status</li> <li>Archive old or invalid addresses instead of deleting</li> </ul> <p>This address table migration provides comprehensive support for multiple addresses per person with enhanced international capabilities and robust data quality management.</p>"},{"location":"tables/contact-log/","title":"Contact Log Migration","text":"<p>The Contact Log migration represents one of the most significant enhancements in the PostgreSQL schema, transforming the basic MySQL <code>Contacted</code> table into a comprehensive contact tracking and follow-up management system.</p>"},{"location":"tables/contact-log/#overview","title":"Overview","text":"<p>The new <code>contact_log</code> table includes substantial improvements over the original MySQL <code>Contacted</code> table, providing enhanced tracking capabilities, outcome management, and follow-up scheduling.</p>"},{"location":"tables/contact-log/#schema-improvements","title":"Schema Improvements","text":""},{"location":"tables/contact-log/#1-modern-postgresql-design","title":"1. Modern PostgreSQL Design","text":"<p>The Contact Log table adopts modern PostgreSQL best practices:</p> <ul> <li>UUID Primary Keys: Uses UUID instead of auto-incrementing integers for better distributed system support</li> <li>Proper Foreign Keys: Enhanced relationships with cascading deletes and referential integrity</li> <li>Type Safety: PostgreSQL ENUMs for contact types and outcomes instead of magic numbers</li> <li>Timezone Support: Proper timestamp handling with timezone awareness</li> </ul>"},{"location":"tables/contact-log/#2-enhanced-contact-types","title":"2. Enhanced Contact Types","text":"<p>The migration replaces the generic integer <code>ctype</code> field with a descriptive <code>contact_type_enum</code> that supports:</p> Contact Type Description Use Case Phone Call Voice communication Direct conversations, follow-ups Email Electronic mail Documentation, formal communication Letter Physical mail Official correspondence In-Person Meeting Face-to-face interaction Important discussions, events Text Message SMS communication Quick updates, reminders Social Media Social platform interaction Informal engagement Video Call Virtual meeting Remote meetings, interviews Voicemail Voice message When direct contact unavailable Event Contact Contact at events Networking, social functions Newsletter Newsletter communication Regular updates, campaigns Donation Thank You Appreciation communication Donor stewardship Other Miscellaneous contact Custom or unique situations"},{"location":"tables/contact-log/#3-contact-outcome-tracking","title":"3. Contact Outcome Tracking","text":"<p>A major enhancement is the addition of <code>contact_outcome_enum</code> to track interaction results:</p> Outcome Description Next Steps Successful Contact achieved intended goal Document results, schedule follow-up if needed No Answer Contact attempt failed - no response Schedule callback, try alternative method Busy Contact unavailable at time of call Reschedule for later Invalid Contact Info Contact information incorrect/outdated Update contact information Declined Contact declined to engage Respect preference, update records Callback Requested Contact requested to be called back Schedule callback at requested time Follow-up Needed Additional contact required Schedule appropriate follow-up Completed Interaction fully completed Archive, no further action needed"},{"location":"tables/contact-log/#4-better-field-organization","title":"4. Better Field Organization","text":"<p>The new schema provides more structured and flexible data organization:</p>"},{"location":"tables/contact-log/#core-contact-information","title":"Core Contact Information","text":"<ul> <li><code>contact_date</code> (required): The date the contact occurred</li> <li><code>contact_time</code> (optional): Specific time with timezone support</li> <li><code>contact_type</code> (enum): Type of contact method used</li> <li><code>contact_outcome</code> (enum): Result of the contact attempt</li> </ul>"},{"location":"tables/contact-log/#content-and-notes","title":"Content and Notes","text":"<ul> <li><code>quick_note</code> (255 chars): Brief summary for quick reference</li> <li><code>detailed_comments</code> (text): Comprehensive notes and details</li> <li><code>is_restricted</code> (boolean): Privacy flag for sensitive information</li> </ul>"},{"location":"tables/contact-log/#metadata-and-audit","title":"Metadata and Audit","text":"<ul> <li><code>entered_by</code> (varchar): Who recorded this contact</li> <li><code>created_at</code> / <code>updated_at</code>: Automatic timestamp tracking</li> </ul>"},{"location":"tables/contact-log/#5-follow-up-management","title":"5. Follow-up Management","text":"<p>One of the most significant enhancements is the built-in follow-up management system:</p> <ul> <li><code>follow_up_needed</code> (boolean): Flag indicating if follow-up is required</li> <li><code>follow_up_date</code> (date): When follow-up should occur</li> <li><code>duration_minutes</code> (integer): Length of calls/meetings for time tracking</li> </ul> <p>This allows for:</p> <ul> <li>Systematic follow-up scheduling</li> <li>Workload planning and time management</li> <li>Performance metrics and reporting</li> <li>Automated reminder systems</li> </ul>"},{"location":"tables/contact-log/#6-audit-trail-and-history","title":"6. Audit Trail and History","text":"<p>The enhanced audit capabilities include:</p> <ul> <li>Automatic Timestamps: <code>created_at</code> and <code>updated_at</code> with automatic updates</li> <li>Change Tracking: Integration with history logging systems</li> <li>User Attribution: Track who entered or modified each record</li> <li>Compliance Support: Maintain comprehensive interaction history</li> </ul>"},{"location":"tables/contact-log/#migration-logic-and-process","title":"Migration Logic and Process","text":""},{"location":"tables/contact-log/#data-transformation","title":"Data Transformation","text":"<p>The migration process handles several complex transformations:</p>"},{"location":"tables/contact-log/#1-contact-type-mapping","title":"1. Contact Type Mapping","text":"<p>MySQL integer <code>ctype</code> values are mapped to PostgreSQL enum values:</p> <pre><code>-- Example mapping logic\nCASE\n    WHEN ctype = 1 THEN 'Phone Call'\n    WHEN ctype = 2 THEN 'Email'\n    WHEN ctype = 3 THEN 'Letter'\n    WHEN ctype = 4 THEN 'In-Person Meeting'\n    -- ... additional mappings\n    ELSE 'Other'\nEND\n</code></pre>"},{"location":"tables/contact-log/#2-date-and-time-handling","title":"2. Date and Time Handling","text":"<p>The migration includes robust date handling:</p> <ul> <li>Null Date Management: Converts MySQL null/invalid dates to appropriate defaults</li> <li>Timezone Conversion: Properly handles timezone information</li> <li>Date Validation: Ensures all dates are valid and reasonable</li> </ul>"},{"location":"tables/contact-log/#3-foreign-key-resolution","title":"3. Foreign Key Resolution","text":"<p>Critical ID mapping from MySQL to PostgreSQL:</p> <ul> <li>Person Mapping: Converts MySQL <code>donor_id</code> to PostgreSQL <code>person_id</code> using the person mapping table</li> <li>Orphan Handling: Skips records with missing person references</li> <li>Validation: Ensures all foreign key relationships are valid</li> </ul>"},{"location":"tables/contact-log/#migration-performance","title":"Migration Performance","text":"<p>The Contact Log migration includes several performance optimizations:</p>"},{"location":"tables/contact-log/#strategic-indexing","title":"Strategic Indexing","text":"<p>The table includes optimized indexes for common query patterns:</p> <pre><code>-- Primary access patterns\nCREATE INDEX idx_contact_log_person_id ON contact_log(person_id);\nCREATE INDEX idx_contact_log_contact_date ON contact_log(contact_date);\nCREATE INDEX idx_contact_log_contact_type ON contact_log(contact_type);\n\n-- Follow-up management\nCREATE INDEX idx_contact_log_follow_up ON contact_log(follow_up_needed, follow_up_date);\n\n-- Audit and reporting\nCREATE INDEX idx_contact_log_created_at ON contact_log(created_at);\nCREATE INDEX idx_contact_log_entered_by ON contact_log(entered_by);\n</code></pre>"},{"location":"tables/contact-log/#batch-processing","title":"Batch Processing","text":"<ul> <li>Configurable batch sizes for memory optimization</li> <li>Progress tracking with detailed logging</li> <li>Error handling with checkpoint recovery</li> </ul>"},{"location":"tables/contact-log/#field-mapping-reference","title":"Field Mapping Reference","text":""},{"location":"tables/contact-log/#complete-mysql-to-postgresql-field-mapping","title":"Complete MySQL to PostgreSQL Field Mapping","text":"MySQL Field PostgreSQL Field Type Change Notes <code>contact_id</code> <code>id</code> INT AUTO_INCREMENT \u2192 UUID Primary key modernization <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Foreign key with mapping resolution <code>date_contacted</code> <code>contact_date</code> DATE \u2192 DATE Null handling and validation <code>restricted</code> <code>is_restricted</code> TINYINT(1) \u2192 BOOLEAN Native boolean type <code>ctype</code> <code>contact_type</code> INT \u2192 ENUM Type-safe enumeration <code>enteredBy</code> <code>entered_by</code> CHAR(3) \u2192 VARCHAR(45) Expanded field size <code>qnote</code> <code>quick_note</code> VARCHAR(255) \u2192 VARCHAR(255) No change <code>comments</code> <code>detailed_comments</code> TEXT \u2192 TEXT No change <code>lastupdated</code> <code>created_at</code>, <code>updated_at</code> TIMESTAMP \u2192 TIMESTAMPTZ Timezone support, separate fields"},{"location":"tables/contact-log/#new-fields-postgresql-only","title":"New Fields (PostgreSQL Only)","text":"Field Type Purpose <code>contact_time</code> TIME WITH TIME ZONE Specific time of contact <code>contact_outcome</code> ENUM Track interaction results <code>follow_up_needed</code> BOOLEAN Flag for required follow-up <code>follow_up_date</code> DATE Scheduled follow-up date <code>duration_minutes</code> INTEGER Contact duration tracking"},{"location":"tables/contact-log/#usage-examples","title":"Usage Examples","text":""},{"location":"tables/contact-log/#common-queries","title":"Common Queries","text":""},{"location":"tables/contact-log/#find-all-contacts-needing-follow-up","title":"Find All Contacts Needing Follow-up","text":"<pre><code>SELECT\n    cl.id,\n    p.first_name,\n    p.last_name,\n    cl.contact_date,\n    cl.follow_up_date,\n    cl.quick_note\nFROM contact_log cl\nJOIN person p ON cl.person_id = p.id\nWHERE cl.follow_up_needed = true\n  AND cl.follow_up_date &lt;= CURRENT_DATE\nORDER BY cl.follow_up_date;\n</code></pre>"},{"location":"tables/contact-log/#contact-summary-by-type","title":"Contact Summary by Type","text":"<pre><code>SELECT\n    contact_type,\n    COUNT(*) as total_contacts,\n    COUNT(CASE WHEN contact_outcome = 'Successful' THEN 1 END) as successful_contacts\nFROM contact_log\nWHERE contact_date &gt;= '2024-01-01'\nGROUP BY contact_type\nORDER BY total_contacts DESC;\n</code></pre>"},{"location":"tables/contact-log/#follow-up-success-rate","title":"Follow-up Success Rate","text":"<pre><code>SELECT\n    DATE_TRUNC('month', contact_date) as month,\n    COUNT(*) as total_contacts,\n    COUNT(CASE WHEN follow_up_needed = false THEN 1 END) as completed_contacts,\n    ROUND(\n        COUNT(CASE WHEN follow_up_needed = false THEN 1 END) * 100.0 / COUNT(*),\n        2\n    ) as completion_rate\nFROM contact_log\nGROUP BY DATE_TRUNC('month', contact_date)\nORDER BY month;\n</code></pre>"},{"location":"tables/contact-log/#migration-validation","title":"Migration Validation","text":""},{"location":"tables/contact-log/#data-integrity-checks","title":"Data Integrity Checks","text":"<p>After migration, validate the data integrity:</p>"},{"location":"tables/contact-log/#1-record-count-verification","title":"1. Record Count Verification","text":"<pre><code>-- Compare record counts\nSELECT 'MySQL' as source, COUNT(*) as count FROM mysql_contacted\nUNION ALL\nSELECT 'PostgreSQL' as source, COUNT(*) as count FROM contact_log;\n</code></pre>"},{"location":"tables/contact-log/#2-foreign-key-validation","title":"2. Foreign Key Validation","text":"<pre><code>-- Check for orphaned records\nSELECT COUNT(*) as orphaned_contacts\nFROM contact_log cl\nLEFT JOIN person p ON cl.person_id = p.id\nWHERE p.id IS NULL;\n</code></pre>"},{"location":"tables/contact-log/#3-data-quality-validation","title":"3. Data Quality Validation","text":"<pre><code>-- Check for data quality issues\nSELECT\n    COUNT(CASE WHEN contact_date IS NULL THEN 1 END) as null_dates,\n    COUNT(CASE WHEN contact_type IS NULL THEN 1 END) as null_types,\n    COUNT(CASE WHEN person_id IS NULL THEN 1 END) as null_person_ids\nFROM contact_log;\n</code></pre>"},{"location":"tables/contact-log/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/contact-log/#common-migration-issues","title":"Common Migration Issues","text":""},{"location":"tables/contact-log/#1-missing-person-references","title":"1. Missing Person References","text":"<p>Problem: Contact records reference non-existent persons Solution: The migration automatically skips orphaned records and logs them</p>"},{"location":"tables/contact-log/#2-invalid-date-values","title":"2. Invalid Date Values","text":"<p>Problem: MySQL contains invalid dates (e.g., '0000-00-00') Solution: The migration converts invalid dates to NULL or current date based on context</p>"},{"location":"tables/contact-log/#3-contact-type-mapping","title":"3. Contact Type Mapping","text":"<p>Problem: Unknown contact type values in MySQL Solution: Unmapped values are assigned to 'Other' type with logging</p>"},{"location":"tables/contact-log/#performance-considerations","title":"Performance Considerations","text":""},{"location":"tables/contact-log/#large-dataset-migration","title":"Large Dataset Migration","text":"<p>For organizations with extensive contact histories:</p> <ol> <li>Increase Batch Size: For systems with ample memory</li> <li>Monitor Progress: Use the built-in progress tracking</li> <li>Schedule Downtime: Plan for extended migration time</li> <li>Index Creation: Indexes are created after data migration for optimal performance</li> </ol>"},{"location":"tables/contact-log/#memory-usage","title":"Memory Usage","text":"<p>The migration is optimized for memory efficiency:</p> <ul> <li>Batch processing prevents memory overflow</li> <li>Streaming results instead of loading entire datasets</li> <li>Configurable batch sizes based on system capabilities</li> </ul> <p>The Contact Log migration represents a significant upgrade in contact management capabilities, providing enhanced tracking, follow-up management, and reporting features while maintaining full compatibility with existing data.</p>"},{"location":"tables/education/","title":"Education Table Migration","text":""},{"location":"tables/education/#overview","title":"Overview","text":"<p>The <code>Education</code> table migration transforms the MySQL <code>Schools</code> table into a comprehensive PostgreSQL education tracking system with enhanced degree classification, institution management, and academic achievement tracking.</p> <p>Note: This documentation reflects the current state of the education table. The <code>is_graduated</code> column has been removed as graduation status can be inferred from the presence of a <code>grad_date</code> value.</p>"},{"location":"tables/education/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/education/#mysql-source-table","title":"MySQL Source Table","text":"<ul> <li><code>Schools</code> - Basic education records</li> </ul>"},{"location":"tables/education/#postgresql-target-table","title":"PostgreSQL Target Table","text":"<ul> <li><code>education</code> - Enhanced education tracking with standardized degrees and institutions</li> </ul>"},{"location":"tables/education/#field-mappings","title":"Field Mappings","text":""},{"location":"tables/education/#core-education-fields","title":"Core Education Fields","text":"MySQL Field PostgreSQL Field Type Change Notes <code>sid</code> <code>id</code> INT \u2192 UUID Primary key conversion <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Foreign key to person table <code>college</code> <code>institution_name</code> VARCHAR(45) \u2192 TEXT Institution name field <code>degree</code> <code>degree</code> VARCHAR(45) \u2192 TEXT Original degree text preserved N/A <code>degree_type</code> N/A \u2192 degree_type_enum Derived from degree field <code>grad_date</code> <code>grad_date</code> YEAR(4) \u2192 INTEGER Graduation year <code>student_id</code> <code>student_id</code> VARCHAR(45) \u2192 TEXT Student ID preservation"},{"location":"tables/education/#enhanced-fields-new-in-postgresql","title":"Enhanced Fields (New in PostgreSQL)","text":"Field Type Purpose <code>institution_type</code> institution_type_enum Type of educational institution (derived) <code>degree_level</code> degree_level_enum Academic level classification (derived) <code>major</code> VARCHAR(100) Academic major field <code>minor</code> VARCHAR(100) Academic minor field <code>concentration</code> VARCHAR(100) Area of concentration/specialization <code>honors</code> honors_enum Academic honors received <code>gpa</code> DECIMAL(5,2) Grade point average <code>gpa_scale</code> DECIMAL(3,1) GPA scale (default 4.0) <code>start_date</code> DATE Estimated program start date <code>end_date</code> DATE Program completion date <code>thesis_title</code> TEXT Thesis or dissertation title <code>advisor</code> VARCHAR(100) Academic advisor name <code>last_changed</code> TIMESTAMP Last modification timestamp"},{"location":"tables/education/#table-schema","title":"Table Schema","text":""},{"location":"tables/education/#current-postgresql-education-table","title":"Current PostgreSQL Education Table","text":"<pre><code>CREATE TABLE IF NOT EXISTS education (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  person_id UUID NOT NULL REFERENCES person(id) ON DELETE CASCADE,\n  degree TEXT,\n  degree_type degree_type_enum,\n  institution_name TEXT,\n  institution_type institution_type_enum,\n  degree_level degree_level_enum,\n  major VARCHAR(100),\n  minor VARCHAR(100),\n  concentration VARCHAR(100),\n  honors honors_enum,\n  gpa DECIMAL(5,2),\n  gpa_scale DECIMAL(3,1) DEFAULT 4.0,\n  grad_date INTEGER,\n  start_date DATE,\n  end_date DATE,\n  student_id TEXT,\n  thesis_title TEXT,\n  advisor VARCHAR(100),\n  last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  CONSTRAINT valid_date_order CHECK (start_date &lt;= COALESCE(end_date, CURRENT_DATE)),\n  CONSTRAINT valid_grad_date CHECK (grad_date &gt;= start_date),\n  CONSTRAINT valid_gpa CHECK (gpa &gt;= 0 AND gpa &lt;= gpa_scale)\n);\n</code></pre>"},{"location":"tables/education/#constraints","title":"Constraints","text":"<ol> <li>Date Constraints</li> <li><code>valid_date_order</code>: Start date must be before or equal to end date</li> <li> <p><code>valid_grad_date</code>: Graduation year must be after start date</p> </li> <li> <p>GPA Constraints</p> </li> <li><code>valid_gpa</code>: GPA must be between 0 and the specified GPA scale</li> <li>GPA scale defaults to 4.0 but can be adjusted for different systems</li> </ol>"},{"location":"tables/education/#data-type-enums","title":"Data Type Enums","text":""},{"location":"tables/education/#degree-type-enum","title":"Degree Type Enum","text":"<pre><code>CREATE TYPE degree_type_enum AS ENUM (\n    'high_school_diploma',\n    'ged',\n    'associate',\n    'bachelor',\n    'master',\n    'doctoral',\n    'professional',\n    'certificate',\n    'diploma',\n    'post_doctoral',\n    'honorary',\n    'other'\n);\n</code></pre>"},{"location":"tables/education/#institution-type-enum","title":"Institution Type Enum","text":"<pre><code>CREATE TYPE institution_type_enum AS ENUM (\n    'public_university',\n    'private_university',\n    'community_college',\n    'technical_college',\n    'trade_school',\n    'military_academy',\n    'theological_seminary',\n    'art_institute',\n    'medical_school',\n    'law_school',\n    'business_school',\n    'high_school',\n    'prep_school',\n    'international',\n    'online',\n    'other'\n);\n</code></pre>"},{"location":"tables/education/#degree-level-enum","title":"Degree Level Enum","text":"<pre><code>CREATE TYPE degree_level_enum AS ENUM (\n    'secondary',\n    'undergraduate',\n    'graduate',\n    'doctoral',\n    'professional',\n    'certificate',\n    'continuing_education',\n    'other'\n);\n</code></pre>"},{"location":"tables/education/#honors-enum","title":"Honors Enum","text":"<pre><code>CREATE TYPE honors_enum AS ENUM (\n    'summa_cum_laude',\n    'magna_cum_laude',\n    'cum_laude',\n    'phi_beta_kappa',\n    'deans_list',\n    'honors_program',\n    'valedictorian',\n    'salutatorian',\n    'distinction',\n    'high_distinction',\n    'other'\n);\n</code></pre>"},{"location":"tables/education/#key-improvements","title":"Key Improvements","text":""},{"location":"tables/education/#educational-tracking-enhancements","title":"Educational Tracking Enhancements","text":"<ol> <li>Comprehensive Degree Classification</li> <li>Standardized degree types with enum validation</li> <li>Degree level categorization for reporting</li> <li>Professional and honorary degree tracking</li> <li> <p>Original degree text preserved alongside enum classification</p> </li> <li> <p>Enhanced Institution Management</p> </li> <li>Institution type classification with enum validation</li> <li>Support for various institution types including international</li> <li> <p>Online education tracking capabilities</p> </li> <li> <p>Academic Achievement Tracking</p> </li> <li>Honors and academic distinctions with enum validation</li> <li>GPA tracking with configurable scale validation</li> <li>Thesis and research documentation fields</li> <li> <p>Academic advisor tracking</p> </li> <li> <p>Improved Date and Timeline Tracking</p> </li> <li>Graduation year tracking (<code>grad_date</code>)</li> <li>Estimated program start and end dates</li> <li>Comprehensive date validation constraints</li> <li>Student ID preservation from original systems</li> </ol>"},{"location":"tables/education/#indexes-and-performance","title":"Indexes and Performance","text":""},{"location":"tables/education/#primary-indexes","title":"Primary Indexes","text":"<pre><code>-- Primary key\nCREATE UNIQUE INDEX idx_education_pk ON education(id);\n\n-- Foreign key indexes\nCREATE INDEX idx_education_person_id ON education(person_id);\n</code></pre>"},{"location":"tables/education/#performance-indexes","title":"Performance Indexes","text":"<pre><code>-- Institution-based queries\nCREATE INDEX idx_education_institution ON education(institution_name);\nCREATE INDEX idx_education_institution_type ON education(institution_type);\n\n-- Degree-based queries\nCREATE INDEX idx_education_degree_type ON education(degree_type);\nCREATE INDEX idx_education_degree_level ON education(degree_level);\n\n-- Year-based queries\nCREATE INDEX idx_education_grad_date ON education(grad_date);\n\n-- Composite indexes for common queries\nCREATE INDEX idx_education_person_level ON education(person_id, degree_level);\nCREATE INDEX idx_education_institution_year ON education(institution_name, grad_date);\n</code></pre>"},{"location":"tables/education/#common-queries","title":"Common Queries","text":""},{"location":"tables/education/#alumni-by-institution","title":"Alumni by Institution","text":"<pre><code>SELECT\n    institution_name,\n    COUNT(*) as alumni_count,\n    COUNT(DISTINCT person_id) as unique_alumni\nFROM education\nGROUP BY institution_name\nORDER BY alumni_count DESC;\n</code></pre>"},{"location":"tables/education/#degree-distribution","title":"Degree Distribution","text":"<pre><code>SELECT\n    degree_type,\n    degree_level,\n    COUNT(*) as count,\n    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER(), 2) as percentage\nFROM education\nGROUP BY degree_type, degree_level\nORDER BY count DESC;\n</code></pre>"},{"location":"tables/education/#recent-graduates","title":"Recent Graduates","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    e.institution_name,\n    e.degree_type,\n    e.major,\n    e.grad_date\nFROM education e\nJOIN person p ON e.person_id = p.id\nWHERE e.grad_date &gt;= EXTRACT(YEAR FROM CURRENT_DATE) - 5\nORDER BY e.grad_date DESC, e.institution_name;\n</code></pre>"},{"location":"tables/education/#academic-honors-recipients","title":"Academic Honors Recipients","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    e.institution_name,\n    e.degree_type,\n    e.honors,\n    e.gpa\nFROM education e\nJOIN person p ON e.person_id = p.id\nWHERE e.honors IS NOT NULL\nORDER BY e.grad_date DESC;\n</code></pre>"},{"location":"tables/education/#multi-degree-holders","title":"Multi-Degree Holders","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    COUNT(*) as degree_count,\n    STRING_AGG(e.degree_type || ' - ' || e.institution_name, '; ' ORDER BY e.grad_date) as degrees\nFROM education e\nJOIN person p ON e.person_id = p.id\nGROUP BY p.id, p.first_name, p.last_name\nHAVING COUNT(*) &gt; 1\nORDER BY degree_count DESC;\n</code></pre>"},{"location":"tables/education/#data-quality-improvements","title":"Data Quality Improvements","text":""},{"location":"tables/education/#validation-rules","title":"Validation Rules","text":"<ol> <li>Degree Validation</li> <li>Degree type must match approved enum values</li> <li>Degree level must correspond to degree type</li> <li> <p>Professional degrees require appropriate institutions</p> </li> <li> <p>Date Validation</p> </li> <li>Graduation year cannot be in the future</li> <li>Start date must precede end date (if both provided)</li> <li> <p>Graduation year must be after start date (if both provided)</p> </li> <li> <p>GPA Validation</p> </li> <li>GPA must be between 0.0 and the specified GPA scale</li> <li>GPA precision limited to 2 decimal places</li> <li>GPA scale defaults to 4.0 but can be adjusted</li> <li> <p>Null values allowed for unknown GPAs</p> </li> <li> <p>Institution Validation</p> </li> <li>Institution names can be free text</li> <li>Institution type must match approved enum values</li> <li>International institutions properly classified</li> </ol>"},{"location":"tables/education/#data-cleanup-during-migration","title":"Data Cleanup During Migration","text":"<ol> <li> <p>Institution Name Standardization <pre><code>-- Standardize common institution name variations\nUPDATE education_temp SET institution_name = 'University of California, Berkeley'\nWHERE institution_name IN ('UC Berkeley', 'Cal', 'Berkeley');\n\nUPDATE education_temp SET institution_name = 'Massachusetts Institute of Technology'\nWHERE institution_name IN ('MIT', 'M.I.T.');\n</code></pre></p> </li> <li> <p>Degree Abbreviation Expansion <pre><code>-- Expand common degree abbreviations\nUPDATE education_temp SET degree_type = 'bachelor'\nWHERE degree IN ('BS', 'BA', 'BSc', 'Bachelor');\n\nUPDATE education_temp SET degree_type = 'master'\nWHERE degree IN ('MS', 'MA', 'MSc', 'Master');\n</code></pre></p> </li> <li> <p>Data Anomaly Detection <pre><code>-- Flag unusual graduation years for review\nSELECT * FROM education_temp\nWHERE grad_date &lt; 1950 OR grad_date &gt; EXTRACT(YEAR FROM CURRENT_DATE) + 10;\n\n-- Flag unusual GPA values\nSELECT * FROM education_temp\nWHERE gpa &gt; gpa_scale OR gpa &lt; 0.0;\n</code></pre></p> </li> </ol>"},{"location":"tables/education/#institutional-partnerships","title":"Institutional Partnerships","text":""},{"location":"tables/education/#alumni-engagement-enhancement","title":"Alumni Engagement Enhancement","text":"<ol> <li> <p>Institutional Grouping <pre><code>-- Create institution groups for targeted communications\nCREATE VIEW institution_groups AS\nSELECT\n    CASE\n        WHEN institution_type = 'public_university' THEN 'Public Universities'\n        WHEN institution_type = 'private_university' THEN 'Private Universities'\n        WHEN institution_type = 'community_college' THEN 'Community Colleges'\n        ELSE 'Other Institutions'\n    END as institution_group,\n    institution_name,\n    COUNT(*) as alumni_count\nFROM education\nGROUP BY institution_group, institution_name;\n</code></pre></p> </li> <li> <p>Class Year Reunions <pre><code>-- Identify reunion year classes\nSELECT\n    grad_date,\n    institution_name,\n    COUNT(*) as class_size,\n    CASE\n        WHEN (EXTRACT(YEAR FROM CURRENT_DATE) - grad_date) % 5 = 0\n        THEN 'Reunion Year'\n        ELSE 'Regular Year'\n    END as reunion_status\nFROM education\nWHERE grad_date IS NOT NULL\nGROUP BY grad_date, institution_name\nHAVING COUNT(*) &gt;= 3;\n</code></pre></p> </li> </ol>"},{"location":"tables/education/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/education/#common-migration-issues","title":"Common Migration Issues","text":"<ol> <li> <p>Invalid Degree Types <pre><code>Error: invalid input value for enum degree_type_enum\nSolution: Update degree type mapping to handle all variations\n</code></pre></p> </li> <li> <p>GPA Scale Variations <pre><code>Error: GPA values outside expected range\nSolution: Implement GPA scale conversion for different systems\n</code></pre></p> </li> <li> <p>Institution Name Duplicates <pre><code>Error: Multiple variations of same institution name\nSolution: Implement institution name standardization lookup\n</code></pre></p> </li> <li> <p>Missing Person References <pre><code>Error: foreign key constraint violation\nSolution: Ensure all donor_id values exist in person table\n</code></pre></p> </li> </ol>"},{"location":"tables/education/#validation-queries","title":"Validation Queries","text":"<pre><code>-- Check for missing foreign key references\nSELECT COUNT(*) FROM education_temp et\nLEFT JOIN person p ON et.person_id = p.id\nWHERE p.id IS NULL;\n\n-- Verify degree type distribution\nSELECT degree_type, COUNT(*)\nFROM education\nGROUP BY degree_type\nORDER BY count DESC;\n\n-- Check for data anomalies\nSELECT\n    COUNT(*) as total_records,\n    COUNT(CASE WHEN gpa IS NOT NULL THEN 1 END) as records_with_gpa,\n    COUNT(CASE WHEN honors IS NOT NULL THEN 1 END) as records_with_honors,\n    COUNT(CASE WHEN grad_date IS NOT NULL THEN 1 END) as records_with_year\nFROM education;\n</code></pre>"},{"location":"tables/education/#post-migration-verification","title":"Post-Migration Verification","text":""},{"location":"tables/education/#data-integrity-checks","title":"Data Integrity Checks","text":"<ol> <li> <p>Record Count Verification <pre><code>-- Compare record counts\nSELECT 'MySQL' as source, COUNT(*) FROM Schools\nUNION ALL\nSELECT 'PostgreSQL' as source, COUNT(*) FROM education;\n</code></pre></p> </li> <li> <p>Degree Distribution Verification <pre><code>-- Verify degree type distribution matches\nSELECT degree_type, COUNT(*) FROM education\nGROUP BY degree_type\nORDER BY degree_type;\n</code></pre></p> </li> <li> <p>Institution Verification <pre><code>-- Check for proper institution name standardization\nSELECT institution_name, COUNT(*)\nFROM education\nGROUP BY institution_name\nHAVING COUNT(*) &gt; 1\nORDER BY count DESC;\n</code></pre></p> </li> </ol>"},{"location":"tables/education/#performance-considerations","title":"Performance Considerations","text":""},{"location":"tables/education/#optimization-strategies","title":"Optimization Strategies","text":"<ol> <li>Index Strategy</li> <li>Create indexes on frequently queried fields</li> <li>Use composite indexes for complex queries</li> <li> <p>Consider partial indexes for filtered queries</p> </li> <li> <p>Query Optimization</p> </li> <li>Use appropriate joins for alumni queries</li> <li>Implement pagination for large result sets</li> <li> <p>Cache common institution statistics</p> </li> <li> <p>Data Archival</p> </li> <li>Consider archiving very old education records</li> <li>Maintain summary statistics for historical data</li> <li>Implement data retention policies</li> </ol> <p>This comprehensive education table migration ensures robust academic history tracking with enhanced degree classification, improved institution management, and better alumni engagement capabilities.</p>"},{"location":"tables/employment/","title":"Employment Table Migration","text":""},{"location":"tables/employment/#overview","title":"Overview","text":"<p>The <code>Employment</code> table migration transforms the simple MySQL <code>Job</code> table into a PostgreSQL employment tracking system with basic employment information and enhanced data normalization.</p>"},{"location":"tables/employment/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/employment/#mysql-source-table-job","title":"MySQL Source Table: <code>Job</code>","text":"<pre><code>CREATE TABLE `Job` (\n  `donor_id` int(10) unsigned NOT NULL DEFAULT 0,\n  `company` varchar(45) NOT NULL DEFAULT '',\n  `position` varchar(120) DEFAULT NULL,\n  `past_company` varchar(45) DEFAULT NULL,\n  `past_position` varchar(120) DEFAULT NULL,\n  `category` varchar(45) DEFAULT NULL,\n  `address` varchar(255) DEFAULT NULL,\n  `phone` varchar(45) DEFAULT NULL,\n  `url` varchar(45) DEFAULT NULL,\n  `comments` text DEFAULT NULL,\n  `job_cat` varchar(45) DEFAULT NULL,\n  `last_changed` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),\n  PRIMARY KEY (`donor_id`)\n);\n</code></pre>"},{"location":"tables/employment/#postgresql-target-table-employment","title":"PostgreSQL Target Table: <code>employment</code>","text":"<pre><code>CREATE TABLE IF NOT EXISTS employment (\n  person_id UUID PRIMARY KEY REFERENCES person(id) ON DELETE CASCADE,\n  company TEXT NOT NULL DEFAULT '',\n  position TEXT,\n  soc_code VARCHAR(7),\n  naics_code VARCHAR(6),\n  category VARCHAR(45),\n  url TEXT,\n  comments TEXT,\n  achievements TEXT[],\n  responsibilities TEXT[],\n  employment_status employment_status_enum,\n  work_arrangement work_arrangement_enum,\n  start_date DATE,\n  end_date DATE,\n  last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n</code></pre>"},{"location":"tables/employment/#field-mappings","title":"Field Mappings","text":""},{"location":"tables/employment/#direct-field-mappings","title":"Direct Field Mappings","text":"MySQL Field PostgreSQL Field Type Change Notes <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Primary key, references person table <code>company</code> <code>company</code> VARCHAR(45) \u2192 TEXT Company name <code>position</code> <code>position</code> VARCHAR(120) \u2192 TEXT Job position/title <code>category</code> <code>category</code> VARCHAR(45) \u2192 VARCHAR(45) Employment category <code>url</code> <code>url</code> VARCHAR(45) \u2192 TEXT Company/job URL <code>comments</code> <code>comments</code> TEXT \u2192 TEXT Additional comments <code>last_changed</code> <code>last_changed</code> TIMESTAMP \u2192 TIMESTAMP Last modification time"},{"location":"tables/employment/#fields-not-migrated-from-mysql","title":"Fields Not Migrated from MySQL","text":"<p>The following MySQL fields are not migrated to PostgreSQL:</p> <ul> <li><code>past_company</code> - Historical employment not captured in current schema</li> <li><code>past_position</code> - Historical employment not captured in current schema</li> <li><code>address</code> - Handled separately in address table with type 'Business'</li> <li><code>phone</code> - Handled separately in phone_number table with type 'Work'</li> <li><code>job_cat</code> - Used as fallback for category if category is NULL</li> </ul>"},{"location":"tables/employment/#new-postgresql-fields-set-to-null-during-migration","title":"New PostgreSQL Fields (Set to NULL during migration)","text":"PostgreSQL Field Type Purpose Migration Value <code>soc_code</code> VARCHAR(7) Standard Occupational Classification NULL <code>naics_code</code> VARCHAR(6) North American Industry Classification NULL <code>achievements</code> TEXT[] Notable achievements NULL <code>responsibilities</code> TEXT[] Job responsibilities NULL <code>employment_status</code> employment_status_enum Employment status NULL <code>work_arrangement</code> work_arrangement_enum Work arrangement type NULL <code>start_date</code> DATE Employment start date NULL <code>end_date</code> DATE Employment end date NULL"},{"location":"tables/employment/#data-type-enums","title":"Data Type Enums","text":"<p>The PostgreSQL employment table uses the following enum types:</p>"},{"location":"tables/employment/#employment-status-enum","title":"Employment Status Enum","text":"<pre><code>CREATE TYPE employment_status_enum AS ENUM (\n    'Full-time',\n    'Part-time',\n    'Contract',\n    'Consulting',\n    'Retired',\n    'Self-employed',\n    'Unemployed',\n    'Student'\n);\n</code></pre>"},{"location":"tables/employment/#work-arrangement-enum","title":"Work Arrangement Enum","text":"<pre><code>CREATE TYPE work_arrangement_enum AS ENUM (\n    'On-site',\n    'Remote',\n    'Hybrid',\n    'Travel',\n    'Field-based'\n);\n</code></pre>"},{"location":"tables/employment/#migration-logic","title":"Migration Logic","text":""},{"location":"tables/employment/#data-transformation-process","title":"Data Transformation Process","text":"<ol> <li> <p>Basic Field Mapping <pre><code>// Map donor_id to person_id using person mapping\npersonID, ok := m.personMapping.Get(donorID)\nif !ok {\n    // Skip record if person not found\n    continue\n}\n\n// Use job_cat as fallback if category is NULL\nfinalCategory := category\nif !category.Valid &amp;&amp; jobCat.Valid {\n    finalCategory = jobCat\n}\n</code></pre></p> </li> <li> <p>Business Address Handling <pre><code>// Insert business address separately if available\nif address.Valid &amp;&amp; address.String != \"\" {\n    // Parse and insert into address table with type 'Business'\n    // This is handled in the address migration logic\n}\n</code></pre></p> </li> <li> <p>Phone Number Handling <pre><code>// Insert work phone separately if available\nif phone.Valid &amp;&amp; phone.String != \"\" {\n    // Insert into phone_number table with type 'Work'\n    // This is handled in the phone migration logic\n}\n</code></pre></p> </li> </ol>"},{"location":"tables/employment/#key-improvements","title":"Key Improvements","text":""},{"location":"tables/employment/#data-normalization","title":"Data Normalization","text":"<ol> <li> <p>Separated Contact Information</p> <ul> <li>Work addresses moved to dedicated address table</li> <li>Work phone numbers moved to dedicated phone_number table</li> <li>Maintains referential integrity with proper foreign keys</li> </ul> </li> <li> <p>Enhanced Data Types</p> <ul> <li>UUIDs for better distributed system support</li> <li>TEXT fields for unlimited content length</li> <li>Array types for multi-value fields</li> </ul> </li> <li> <p>Enum Validation</p> <ul> <li>Standardized employment status values</li> <li>Consistent work arrangement classifications</li> </ul> </li> </ol>"},{"location":"tables/employment/#migration-notes","title":"Migration Notes","text":""},{"location":"tables/employment/#data-quality-considerations","title":"Data Quality Considerations","text":"<ol> <li> <p>Simple Source Data</p> <ul> <li>MySQL Job table contains minimal employment information</li> <li>Many PostgreSQL fields will be NULL after initial migration</li> <li>Future enhancements can populate additional fields</li> </ul> </li> <li> <p>Category Field Logic</p> <ul> <li>Uses <code>category</code> field if available</li> <li>Falls back to <code>job_cat</code> field if <code>category</code> is NULL</li> <li>Both fields can contain employment categorization information</li> </ul> </li> <li> <p>Historical Employment</p> <ul> <li><code>past_company</code> and <code>past_position</code> fields not migrated</li> <li>Current schema focuses on current employment only</li> <li>Historical employment tracking would require schema enhancement</li> </ul> </li> </ol>"},{"location":"tables/employment/#indexes-and-performance","title":"Indexes and Performance","text":""},{"location":"tables/employment/#primary-indexes","title":"Primary Indexes","text":"<pre><code>-- Primary key constraint automatically creates index\n-- employment_pkey on employment(person_id)\n</code></pre>"},{"location":"tables/employment/#recommended-indexes-for-performance","title":"Recommended Indexes for Performance","text":"<pre><code>-- Company-based queries\nCREATE INDEX IF NOT EXISTS idx_employment_company ON employment(company);\n\n-- Category-based queries\nCREATE INDEX IF NOT EXISTS idx_employment_category ON employment(category);\n\n-- URL-based queries\nCREATE INDEX IF NOT EXISTS idx_employment_url ON employment(url) WHERE url IS NOT NULL;\n\n-- Last changed timestamp for audit queries\nCREATE INDEX IF NOT EXISTS idx_employment_last_changed ON employment(last_changed);\n</code></pre>"},{"location":"tables/employment/#common-queries","title":"Common Queries","text":""},{"location":"tables/employment/#basic-employment-information","title":"Basic Employment Information","text":"<pre><code>-- Get all employment records with person details\nSELECT\n    p.first_name,\n    p.last_name,\n    e.company,\n    e.position,\n    e.category,\n    e.last_changed\nFROM employment e\nJOIN person p ON e.person_id = p.id\nORDER BY e.last_changed DESC;\n</code></pre>"},{"location":"tables/employment/#company-based-analysis","title":"Company-Based Analysis","text":"<pre><code>-- Count employees by company\nSELECT\n    company,\n    COUNT(*) as employee_count\nFROM employment\nWHERE company IS NOT NULL AND company != ''\nGROUP BY company\nORDER BY employee_count DESC;\n</code></pre>"},{"location":"tables/employment/#employment-by-category","title":"Employment by Category","text":"<pre><code>-- Analyze employment by category\nSELECT\n    COALESCE(category, 'Unknown') as employment_category,\n    COUNT(*) as count\nFROM employment\nGROUP BY category\nORDER BY count DESC;\n</code></pre>"},{"location":"tables/employment/#recent-employment-updates","title":"Recent Employment Updates","text":"<pre><code>-- Find recently updated employment records\nSELECT\n    p.first_name,\n    p.last_name,\n    e.company,\n    e.position,\n    e.last_changed\nFROM employment e\nJOIN person p ON e.person_id = p.id\nWHERE e.last_changed &gt;= CURRENT_DATE - INTERVAL '30 days'\nORDER BY e.last_changed DESC;\n</code></pre>"},{"location":"tables/employment/#migration-verification","title":"Migration Verification","text":""},{"location":"tables/employment/#data-integrity-checks","title":"Data Integrity Checks","text":"<ol> <li> <p>Record Count Verification <pre><code>-- Compare record counts between source and target\nSELECT 'MySQL Job' as source, COUNT(*) as count FROM Job\nUNION ALL\nSELECT 'PostgreSQL employment' as source, COUNT(*) as count FROM employment;\n</code></pre></p> </li> <li> <p>Field Population Analysis <pre><code>-- Check field population rates\nSELECT\n    COUNT(*) as total_records,\n    COUNT(company) as company_populated,\n    COUNT(position) as position_populated,\n    COUNT(category) as category_populated,\n    COUNT(url) as url_populated,\n    COUNT(comments) as comments_populated,\n    ROUND(COUNT(company) * 100.0 / COUNT(*), 2) as company_percentage,\n    ROUND(COUNT(position) * 100.0 / COUNT(*), 2) as position_percentage\nFROM employment;\n</code></pre></p> </li> <li> <p>Foreign Key Validation <pre><code>-- Verify all employment records have valid person references\nSELECT COUNT(*) as orphaned_records\nFROM employment e\nLEFT JOIN person p ON e.person_id = p.id\nWHERE p.id IS NULL;\n</code></pre></p> </li> </ol>"},{"location":"tables/employment/#data-quality-improvements","title":"Data Quality Improvements","text":""},{"location":"tables/employment/#validation-rules","title":"Validation Rules","text":"<ol> <li>Basic Data Validation</li> <li>Company name should not be empty string if populated</li> <li>URL format validation for web addresses</li> <li> <p>Category values should be standardized</p> </li> <li> <p>Referential Integrity</p> </li> <li>All person_id values must exist in person table</li> <li>Foreign key constraints ensure data consistency</li> </ol>"},{"location":"tables/employment/#data-cleanup-opportunities","title":"Data Cleanup Opportunities","text":"<ol> <li> <p>Company Name Standardization <pre><code>-- Find potential duplicate companies with different formatting\nSELECT company, COUNT(*)\nFROM employment\nWHERE company IS NOT NULL AND company != ''\nGROUP BY LOWER(TRIM(company))\nHAVING COUNT(*) &gt; 1\nORDER BY COUNT(*) DESC;\n</code></pre></p> </li> <li> <p>Category Standardization <pre><code>-- Analyze category values for standardization opportunities\nSELECT category, COUNT(*)\nFROM employment\nWHERE category IS NOT NULL\nGROUP BY category\nORDER BY COUNT(*) DESC;\n</code></pre></p> </li> </ol>"},{"location":"tables/employment/#future-enhancements","title":"Future Enhancements","text":""},{"location":"tables/employment/#additional-data-sources","title":"Additional Data Sources","text":"<ul> <li>Import employment history from LinkedIn or similar professional networks</li> <li>Integrate with HR systems for current employees</li> <li>Add salary information from compensation surveys</li> </ul>"},{"location":"tables/employment/#schema-enhancements","title":"Schema Enhancements","text":"<ul> <li>Add employment duration calculations</li> <li>Include industry classification fields</li> <li>Add location/geography information</li> <li>Track career progression over time</li> </ul> <p>This employment table migration provides a solid foundation for basic employment tracking while maintaining the ability to enhance the schema with additional employment-related information in the future.</p>"},{"location":"tables/events/","title":"Events Table Migration","text":"<p>The Events table represents the migration from MySQL's <code>Event</code> table to PostgreSQL's <code>event</code> table, managing fraternity events, activities, and gatherings with enhanced organization mapping and improved event management capabilities.</p>"},{"location":"tables/events/#overview","title":"Overview","text":"<p>Events are activities organized by fraternities, chapters, and alumni associations. The migration enhances the original MySQL structure with better organization relationships, improved data types, and enhanced event management features.</p>"},{"location":"tables/events/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/events/#mysql-source-table-event","title":"MySQL Source Table: <code>Event</code>","text":"<pre><code>CREATE TABLE Event (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    group_id INT,\n    title VARCHAR(45) NOT NULL DEFAULT '',\n    date DATE NOT NULL,\n    contact VARCHAR(100),\n    contact_phone VARCHAR(25),\n    contact_email VARCHAR(100),\n    description TEXT,\n    online TINYINT(1) DEFAULT 0,\n    export TINYINT(1) DEFAULT 1,\n    last_changed TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n    FOREIGN KEY (group_id) REFERENCES Donor_Group(id) ON DELETE CASCADE\n);\n</code></pre>"},{"location":"tables/events/#postgresql-target-table-event","title":"PostgreSQL Target Table: <code>event</code>","text":"<pre><code>CREATE TABLE IF NOT EXISTS event (\n    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n    organization_id UUID REFERENCES organization(id) ON DELETE CASCADE,\n    title VARCHAR(45) NOT NULL DEFAULT '',\n    date DATE NOT NULL,\n    contact VARCHAR(100),\n    contact_phone VARCHAR(25),\n    contact_email VARCHAR(100),\n    description TEXT,\n    online BOOLEAN DEFAULT FALSE,\n    export BOOLEAN DEFAULT TRUE,\n    last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n</code></pre>"},{"location":"tables/events/#key-changes-and-improvements","title":"Key Changes and Improvements","text":""},{"location":"tables/events/#1-primary-key-modernization","title":"1. Primary Key Modernization","text":"<p>MySQL: Auto-increment integer <pre><code>id INT AUTO_INCREMENT PRIMARY KEY\n</code></pre></p> <p>PostgreSQL: UUID for better distributed system support <pre><code>id UUID PRIMARY KEY DEFAULT uuid_generate_v4()\n</code></pre></p>"},{"location":"tables/events/#2-organization-reference-mapping","title":"2. Organization Reference Mapping","text":"<p>MySQL: References Donor_Group table <pre><code>group_id INT REFERENCES Donor_Group(id)\n</code></pre></p> <p>PostgreSQL: References organization table with UUIDs <pre><code>organization_id UUID REFERENCES organization(id) ON DELETE CASCADE\n</code></pre></p>"},{"location":"tables/events/#3-boolean-field-modernization","title":"3. Boolean Field Modernization","text":"<p>MySQL: TINYINT for boolean values <pre><code>online TINYINT(1) DEFAULT 0,\nexport TINYINT(1) DEFAULT 1\n</code></pre></p> <p>PostgreSQL: Native boolean types <pre><code>online BOOLEAN DEFAULT FALSE,\nexport BOOLEAN DEFAULT TRUE\n</code></pre></p>"},{"location":"tables/events/#4-improved-title-field","title":"4. Improved Title Field","text":"<p>MySQL: Basic title field <pre><code>title VARCHAR(45) NOT NULL DEFAULT ''\n</code></pre></p> <p>PostgreSQL: Enhanced title field (same size, consistent behavior) <pre><code>title VARCHAR(45) NOT NULL DEFAULT ''\n</code></pre></p>"},{"location":"tables/events/#migration-logic","title":"Migration Logic","text":"<p>The actual migration implementation from <code>migrate.go</code> handles the following:</p>"},{"location":"tables/events/#1-organization-id-mapping","title":"1. Organization ID Mapping","text":"<p>Events are mapped from MySQL <code>group_id</code> to PostgreSQL <code>organization_id</code> using the organization mapping:</p> <pre><code>// Map group_id to organization_id\nvar orgID *string\nif groupID.Valid {\n    if oid, ok := m.orgMapping.Get(int(groupID.Int64)); ok {\n        orgID = &amp;oid\n    }\n}\n</code></pre>"},{"location":"tables/events/#2-contact-phone-normalization","title":"2. Contact Phone Normalization","text":"<p>Contact phone numbers are normalized during migration:</p> <pre><code>// Normalize contact phone number if present\nvar normalizedContactPhone sql.NullString\nif contactPhone.Valid &amp;&amp; contactPhone.String != \"\" {\n    normalized := m.phoneNormalizer.NormalizePhone(contactPhone.String)\n    normalizedContactPhone = sql.NullString{String: normalized, Valid: true}\n}\n</code></pre>"},{"location":"tables/events/#3-event-id-mapping-for-related-tables","title":"3. Event ID Mapping for Related Tables","text":"<p>Event IDs are mapped to UUIDs and stored for use in related table migrations:</p> <pre><code>eventID := generateUUID()\neventMapping[id] = eventID // MySQL ID -&gt; PostgreSQL UUID\n\n// Later used in participates and volunteer migrations\n// Save event mapping for participates migration\nfor k, v := range m.eventMapping.Iterator() {\n    m.eventMapping.Set(k, v)\n}\n</code></pre>"},{"location":"tables/events/#4-data-insertion","title":"4. Data Insertion","text":"<p>The migration inserts data with proper handling of nullable fields:</p> <pre><code>sql := `\n    INSERT INTO event (\n        id, organization_id, title, date, contact, contact_phone, contact_email, description, online, export, last_changed\n    ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11)\n    ON CONFLICT (id) DO NOTHING\n`\n\nif _, err := tx.Exec(ctx, sql,\n    eventID,\n    orgID,\n    title,\n    date,\n    contact,\n    normalizedContactPhone,\n    contactEmail,\n    description,\n    getBoolOrDefault(online, false),\n    getBoolOrDefault(export, true),\n    lastChanged,\n); err != nil {\n    return fmt.Errorf(\"failed to insert event: %w\", err)\n}\n</code></pre>"},{"location":"tables/events/#field-mapping-reference","title":"Field Mapping Reference","text":""},{"location":"tables/events/#complete-mysql-to-postgresql-field-mapping","title":"Complete MySQL to PostgreSQL Field Mapping","text":"MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID Primary key conversion <code>group_id</code> <code>organization_id</code> INT \u2192 UUID Foreign key with organization mapping <code>title</code> <code>title</code> VARCHAR(45) \u2192 VARCHAR(45) No change in size, enhanced default handling <code>date</code> <code>date</code> DATE \u2192 DATE No change <code>contact</code> <code>contact</code> VARCHAR(100) \u2192 VARCHAR(100) No change <code>contact_phone</code> <code>contact_phone</code> VARCHAR(25) \u2192 VARCHAR(25) Phone normalization during migration <code>contact_email</code> <code>contact_email</code> VARCHAR(100) \u2192 VARCHAR(100) No change <code>description</code> <code>description</code> TEXT \u2192 TEXT No change <code>online</code> <code>online</code> TINYINT(1) \u2192 BOOLEAN Native boolean type <code>export</code> <code>export</code> TINYINT(1) \u2192 BOOLEAN Native boolean type <code>last_changed</code> <code>last_changed</code> TIMESTAMP \u2192 TIMESTAMP No change"},{"location":"tables/events/#migration-process","title":"Migration Process","text":"<p>The migration process handles:</p> <ol> <li>UUID Generation: Each MySQL event.id is mapped to a new PostgreSQL UUID</li> <li>Organization Mapping: MySQL group_id is mapped to PostgreSQL organization_id using the organization mapping table</li> <li>Phone Normalization: Contact phone numbers are normalized using the phone normalizer</li> <li>Boolean Conversion: MySQL TINYINT(1) values are converted to PostgreSQL BOOLEAN</li> <li>Conflict Handling: Uses <code>ON CONFLICT (id) DO NOTHING</code> to prevent duplicate inserts</li> <li>Event Mapping Storage: Stores the MySQL ID \u2192 PostgreSQL UUID mapping for use in related table migrations (participates, volunteer)</li> </ol>"},{"location":"tables/events/#indexes-and-performance","title":"Indexes and Performance","text":""},{"location":"tables/events/#current-indexes","title":"Current Indexes","text":"<p>The current implementation has basic indexing:</p> <pre><code>-- Primary key index (automatic)\nCREATE INDEX IF NOT EXISTS event_pkey ON event(id);\n\n-- Foreign key index for organization lookups (recommended)\nCREATE INDEX IF NOT EXISTS idx_event_organization_id ON event(organization_id);\n\n-- Date-based queries (recommended)\nCREATE INDEX IF NOT EXISTS idx_event_date ON event(date);\n\n-- Title searches (recommended)\nCREATE INDEX IF NOT EXISTS idx_event_title ON event(title);\n</code></pre>"},{"location":"tables/events/#performance-considerations","title":"Performance Considerations","text":"<p>With the current simple schema:</p> <ol> <li>Organization-based queries: Use the organization_id index for filtering events by organization</li> <li>Date-range queries: Use the date index for finding events in specific time periods</li> <li>Title searches: Use the title index for event name lookups</li> <li>Combined queries: Consider composite indexes for common query patterns</li> </ol>"},{"location":"tables/events/#common-queries","title":"Common Queries","text":"<p>With the actual simple event schema, common queries focus on the basic fields available:</p>"},{"location":"tables/events/#event-listing-and-search","title":"Event Listing and Search","text":"<pre><code>-- Upcoming events for an organization\nSELECT e.title, e.date, e.contact, e.contact_phone, e.contact_email\nFROM event e\nWHERE e.organization_id = $1\n  AND e.date &gt;= CURRENT_DATE\nORDER BY e.date;\n\n-- Events in a date range\nSELECT e.title, e.date, e.description, e.contact\nFROM event e\nWHERE e.date BETWEEN $1 AND $2\nORDER BY e.date;\n\n-- Search events by title or description\nSELECT e.title, e.date, e.description, e.contact\nFROM event e\nWHERE e.title ILIKE '%' || $1 || '%'\n   OR e.description ILIKE '%' || $1 || '%'\nORDER BY e.date;\n\n-- Online vs in-person events\nSELECT e.title, e.date, e.online, e.contact\nFROM event e\nWHERE e.online = $1  -- true for online, false for in-person\nORDER BY e.date;\n</code></pre>"},{"location":"tables/events/#event-management-queries","title":"Event Management Queries","text":"<pre><code>-- Events with participation\nSELECT e.title, e.date, e.contact,\n       COUNT(p.id) as participant_count,\n       COUNT(CASE WHEN p.attended &gt; 0 THEN 1 END) as attended_count\nFROM event e\nLEFT JOIN participates p ON e.id = p.event_id\nGROUP BY e.id, e.title, e.date, e.contact\nORDER BY e.date;\n\n-- Recently updated events\nSELECT e.title, e.date, e.last_changed, e.contact\nFROM event e\nORDER BY e.last_changed DESC\nLIMIT 20;\n\n-- Events by organization\nSELECT o.title as organization_name,\n       COUNT(e.id) as event_count,\n       MIN(e.date) as first_event,\n       MAX(e.date) as last_event\nFROM organization o\nLEFT JOIN event e ON o.id = e.organization_id\nGROUP BY o.id, o.title\nORDER BY event_count DESC;\n</code></pre>"},{"location":"tables/events/#contact-information-queries","title":"Contact Information Queries","text":"<pre><code>-- Events with contact information\nSELECT e.title, e.date, e.contact, e.contact_phone, e.contact_email\nFROM event e\nWHERE e.contact IS NOT NULL\n   OR e.contact_phone IS NOT NULL\n   OR e.contact_email IS NOT NULL\nORDER BY e.date;\n\n-- Events missing contact information\nSELECT e.title, e.date,\n       CASE WHEN e.contact IS NULL THEN 'Missing contact name' END as contact_issue,\n       CASE WHEN e.contact_phone IS NULL THEN 'Missing phone' END as phone_issue,\n       CASE WHEN e.contact_email IS NULL THEN 'Missing email' END as email_issue\nFROM event e\nWHERE e.contact IS NULL\n   AND e.contact_phone IS NULL\n   AND e.contact_email IS NULL\nORDER BY e.date;\n</code></pre>"},{"location":"tables/events/#data-quality-improvements","title":"Data Quality Improvements","text":"<p>With the actual simple event schema, data quality improvements focus on the basic validation available:</p>"},{"location":"tables/events/#1-basic-event-validation","title":"1. Basic Event Validation","text":"<pre><code>-- Date validation (reasonable date range)\nALTER TABLE event\nADD CONSTRAINT chk_event_date_reasonable\nCHECK (date &gt;= '1900-01-01' AND date &lt;= CURRENT_DATE + INTERVAL '10 years');\n\n-- Title validation (not empty)\nALTER TABLE event\nADD CONSTRAINT chk_event_title_not_empty\nCHECK (title IS NOT NULL AND trim(title) != '');\n</code></pre>"},{"location":"tables/events/#2-contact-information-validation","title":"2. Contact Information Validation","text":"<pre><code>-- Email format validation (if provided)\nALTER TABLE event\nADD CONSTRAINT chk_event_contact_email_format\nCHECK (contact_email IS NULL OR contact_email ~ '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$');\n\n-- Phone format validation (basic check if provided)\nALTER TABLE event\nADD CONSTRAINT chk_event_contact_phone_format\nCHECK (contact_phone IS NULL OR length(trim(contact_phone)) &gt;= 10);\n</code></pre>"},{"location":"tables/events/#3-data-consistency-checks","title":"3. Data Consistency Checks","text":"<pre><code>-- Find events with missing key information\nSELECT e.id, e.title, e.date,\n       CASE WHEN e.contact IS NULL THEN 'Missing contact' END as contact_issue,\n       CASE WHEN e.description IS NULL THEN 'Missing description' END as description_issue\nFROM event e\nWHERE e.contact IS NULL OR e.description IS NULL\nORDER BY e.date;\n\n-- Find events with default/empty values\nSELECT e.id, e.title, e.date\nFROM event e\nWHERE trim(e.title) = ''\n   OR e.date = '0000-00-00'  -- Check for MySQL default dates\nORDER BY e.date;\n</code></pre>"},{"location":"tables/events/#advanced-features","title":"Advanced Features","text":"<p>With the current simple event schema, advanced features are limited but some useful capabilities can be built:</p>"},{"location":"tables/events/#1-event-reporting-and-analytics","title":"1. Event Reporting and Analytics","text":"<pre><code>-- Basic event analytics view\nCREATE VIEW event_analytics AS\nSELECT\n    DATE_TRUNC('month', date) as month,\n    COUNT(*) as total_events,\n    COUNT(CASE WHEN online THEN 1 END) as online_events,\n    COUNT(CASE WHEN NOT online THEN 1 END) as in_person_events,\n    COUNT(DISTINCT organization_id) as organizing_entities\nFROM event\nGROUP BY DATE_TRUNC('month', date)\nORDER BY month;\n\n-- Organization event summary\nCREATE VIEW organization_event_summary AS\nSELECT\n    o.title as organization_name,\n    COUNT(e.id) as total_events,\n    COUNT(CASE WHEN e.date &gt;= CURRENT_DATE THEN 1 END) as upcoming_events,\n    MIN(e.date) as first_event_date,\n    MAX(e.date) as latest_event_date\nFROM organization o\nLEFT JOIN event e ON o.id = e.organization_id\nGROUP BY o.id, o.title;\n</code></pre>"},{"location":"tables/events/#2-event-search-enhancement","title":"2. Event Search Enhancement","text":"<pre><code>-- Create text search index for better searching\nCREATE INDEX idx_event_text_search\nON event USING GIN (to_tsvector('english', title || ' ' || COALESCE(description, '')));\n\n-- Enhanced search function\nCREATE OR REPLACE FUNCTION search_events(search_term TEXT)\nRETURNS TABLE (\n    event_id UUID,\n    title VARCHAR(45),\n    date DATE,\n    description TEXT,\n    rank REAL\n) AS $$\nBEGIN\n    RETURN QUERY\n    SELECT\n        e.id,\n        e.title,\n        e.date,\n        e.description,\n        ts_rank(to_tsvector('english', e.title || ' ' || COALESCE(e.description, '')),\n                plainto_tsquery('english', search_term)) as rank\n    FROM event e\n    WHERE to_tsvector('english', e.title || ' ' || COALESCE(e.description, ''))\n          @@ plainto_tsquery('english', search_term)\n    ORDER BY rank DESC, e.date;\nEND;\n$$ LANGUAGE plpgsql;\n</code></pre>"},{"location":"tables/events/#3-contact-management-integration","title":"3. Contact Management Integration","text":"<pre><code>-- View combining event and organization contact information\nCREATE VIEW event_contact_info AS\nSELECT\n    e.id,\n    e.title,\n    e.date,\n    e.contact as event_contact,\n    e.contact_phone as event_phone,\n    e.contact_email as event_email,\n    o.title as organization_name,\n    o.email as org_email,\n    o.work as org_phone\nFROM event e\nLEFT JOIN organization o ON e.organization_id = o.id;\n</code></pre>"},{"location":"tables/events/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/events/#common-migration-issues","title":"Common Migration Issues","text":""},{"location":"tables/events/#1-missing-organization-references","title":"1. Missing Organization References","text":"<pre><code>-- Find events with missing organization references\nSELECT e.id, e.title, e.date\nFROM event e\nLEFT JOIN organization o ON e.organization_id = o.id\nWHERE o.id IS NULL;\n</code></pre>"},{"location":"tables/events/#2-invalid-event-dates","title":"2. Invalid Event Dates","text":"<pre><code>-- Find events with problematic dates\nSELECT id, title, date, last_changed\nFROM event\nWHERE date &lt; '1950-01-01'\n   OR date &gt; CURRENT_DATE + INTERVAL '20 years'\n   OR date = '0000-00-00';\n</code></pre>"},{"location":"tables/events/#3-missing-event-information","title":"3. Missing Event Information","text":"<pre><code>-- Events missing basic information\nSELECT id, title, date,\n       CASE WHEN contact IS NULL AND contact_phone IS NULL AND contact_email IS NULL\n            THEN 'Missing all contact info' END as contact_issue,\n       CASE WHEN description IS NULL OR trim(description) = ''\n            THEN 'Missing description' END as description_issue\nFROM event\nWHERE (contact IS NULL AND contact_phone IS NULL AND contact_email IS NULL)\n   OR description IS NULL\n   OR trim(description) = '';\n</code></pre>"},{"location":"tables/events/#4-data-type-issues","title":"4. Data Type Issues","text":"<pre><code>-- Check for MySQL boolean conversion issues\nSELECT id, title, online, export\nFROM event\nWHERE online NOT IN (true, false)\n   OR export NOT IN (true, false);\n\n-- Check for empty string vs NULL inconsistencies\nSELECT id, title, date,\n       CASE WHEN title = '' THEN 'Empty title' END as title_issue,\n       CASE WHEN contact = '' THEN 'Empty contact' END as contact_issue\nFROM event\nWHERE title = '' OR contact = '';\n</code></pre>"},{"location":"tables/events/#performance-optimization","title":"Performance Optimization","text":""},{"location":"tables/events/#query-performance","title":"Query Performance","text":"<ul> <li>Use the organization_id index for organization-based event lookups</li> <li>Use the date index for date-range queries</li> <li>Consider creating composite indexes for common query patterns</li> </ul>"},{"location":"tables/events/#data-management","title":"Data Management","text":"<ul> <li>Regular cleanup of very old events that are no longer relevant</li> <li>Monitor for events with invalid dates or missing required information</li> <li>Validate contact information formats during data entry</li> </ul>"},{"location":"tables/events/#common-fixes","title":"Common Fixes","text":""},{"location":"tables/events/#fix-invalid-dates","title":"Fix Invalid Dates","text":"<pre><code>-- Update events with default MySQL dates\nUPDATE event\nSET date = CURRENT_DATE\nWHERE date = '0000-00-00';\n</code></pre>"},{"location":"tables/events/#clean-empty-strings","title":"Clean Empty Strings","text":"<pre><code>-- Convert empty strings to NULL for consistency\nUPDATE event\nSET contact = NULL\nWHERE contact = '';\n\nUPDATE event\nSET description = NULL\nWHERE description = '';\n</code></pre> <p>This events table migration provides basic event management capabilities with organization relationships and simple contact tracking. The streamlined schema focuses on essential event information while maintaining data integrity and migration reliability.</p>"},{"location":"tables/family/","title":"Family Table Migration","text":""},{"location":"tables/family/#overview","title":"Overview","text":"<p>The <code>Family</code> table migration transforms the MySQL <code>Family</code> table into a PostgreSQL <code>family</code> table, maintaining basic family information including spouse details, marital status, and children information with improved data types and UUID primary keys.</p>"},{"location":"tables/family/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/family/#mysql-source-table","title":"MySQL Source Table","text":"<ul> <li><code>Family</code> - Basic family information records</li> </ul>"},{"location":"tables/family/#postgresql-target-table","title":"PostgreSQL Target Table","text":"<ul> <li><code>family</code> - Basic family information with modernized data types</li> </ul>"},{"location":"tables/family/#field-mappings","title":"Field Mappings","text":""},{"location":"tables/family/#mysql-to-postgresql-field-mapping","title":"MySQL to PostgreSQL Field Mapping","text":"MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID Primary key conversion <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Foreign key to person table <code>mar_status</code> <code>marital_status</code> ENUM('S','M','W','D','?') \u2192 marital_status_enum Standardized enum values <code>spouse</code> <code>spouse</code> VARCHAR(45) \u2192 VARCHAR(45) No change <code>spouse_dob</code> <code>spouse_dob</code> DATE \u2192 DATE No change <code>spouse_dod</code> <code>spouse_dod</code> DATE \u2192 DATE No change <code>sorority</code> <code>sorority</code> VARCHAR(255) \u2192 VARCHAR(255) No change <code>spouse_position</code> <code>spouse_position</code> VARCHAR(255) \u2192 VARCHAR(255) No change <code>spouse_employer</code> <code>spouse_employer</code> VARCHAR(255) \u2192 VARCHAR(255) No change <code>notes</code> <code>notes</code> TEXT \u2192 TEXT No change <code>last_changed</code> <code>last_changed</code> TIMESTAMP \u2192 TIMESTAMP No change <code>children</code> <code>children</code> TEXT \u2192 TEXT No change"},{"location":"tables/family/#postgresql-table-schema","title":"PostgreSQL Table Schema","text":"<pre><code>CREATE TABLE IF NOT EXISTS family (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  person_id UUID NOT NULL REFERENCES person(id) ON DELETE CASCADE,\n  marital_status marital_status_enum,\n  spouse VARCHAR(45),\n  spouse_dob DATE,\n  spouse_dod DATE,\n  sorority VARCHAR(255),\n  spouse_position VARCHAR(255),\n  spouse_employer VARCHAR(255),\n  notes TEXT,\n  last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  children TEXT\n);\n</code></pre>"},{"location":"tables/family/#marital-status-enum","title":"Marital Status Enum","text":"<pre><code>CREATE TYPE marital_status_enum AS ENUM ('Single','Married','Widowed','Divorced','Unknown');\n</code></pre> <p>The enum values map from MySQL as follows:</p> <ul> <li>'S' \u2192 'Single'</li> <li>'M' \u2192 'Married'</li> <li>'W' \u2192 'Widowed'</li> <li>'D' \u2192 'Divorced'</li> <li>'?' \u2192 'Unknown'</li> </ul>"},{"location":"tables/family/#migration-logic","title":"Migration Logic","text":"<p>The family migration process performs a simple 1:1 mapping from MySQL to PostgreSQL:</p> <pre><code>func (m *Migrator) MigrateFamily(ctx context.Context, tx pgx.Tx) error {\n    // Query all family records from MySQL\n    query := `SELECT id, donor_id, mar_status, spouse, spouse_dob, spouse_dod,\n                     sorority, spouse_position, spouse_employer, notes,\n                     last_changed, children FROM Family`\n\n    // For each record:\n    // 1. Map donor_id to person_id using person mapping\n    // 2. Convert marital status enum values\n    // 3. Insert with new UUID primary key\n\n    familyID := generateUUID()\n    if _, err := tx.Exec(ctx, `\n        INSERT INTO family (id, person_id, marital_status, spouse, spouse_dob, spouse_dod,\n                           sorority, spouse_position, spouse_employer, notes,\n                           last_changed, children)\n        VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)\n        ON CONFLICT (id) DO NOTHING\n    `, familyID, personID, convertMaritalStatus(marStatus.String),\n       spouse, spouseDob, spouseDod, sorority, spousePosition,\n       spouseEmployer, notes, lastChanged, children)\n}\n</code></pre>"},{"location":"tables/family/#marital-status-conversion","title":"Marital Status Conversion","text":"<pre><code>func convertMaritalStatus(mysqlStatus string) string {\n    switch mysqlStatus {\n    case \"S\":\n        return \"Single\"\n    case \"M\":\n        return \"Married\"\n    case \"W\":\n        return \"Widowed\"\n    case \"D\":\n        return \"Divorced\"\n    case \"?\":\n        return \"Unknown\"\n    default:\n        return \"Unknown\"\n    }\n}\n</code></pre>"},{"location":"tables/family/#key-changes-and-improvements","title":"Key Changes and Improvements","text":""},{"location":"tables/family/#1-primary-key-modernization","title":"1. Primary Key Modernization","text":"<p>MySQL: Auto-increment integer <pre><code>id INT AUTO_INCREMENT PRIMARY KEY\n</code></pre></p> <p>PostgreSQL: UUID for better distributed system support <pre><code>id UUID PRIMARY KEY DEFAULT uuid_generate_v4()\n</code></pre></p>"},{"location":"tables/family/#2-foreign-key-enhancement","title":"2. Foreign Key Enhancement","text":"<p>MySQL: References Donor table <pre><code>donor_id INT REFERENCES Donor(id)\n</code></pre></p> <p>PostgreSQL: References person table with enhanced constraints <pre><code>person_id UUID NOT NULL REFERENCES person(id) ON DELETE CASCADE\n</code></pre></p>"},{"location":"tables/family/#3-enum-type-standardization","title":"3. Enum Type Standardization","text":"<p>MySQL: String-based enum with shorthand codes <pre><code>mar_status ENUM('S','M','W','D','?')\n</code></pre></p> <p>PostgreSQL: Descriptive enum type <pre><code>marital_status marital_status_enum -- ('Single','Married','Widowed','Divorced','Unknown')\n</code></pre></p>"},{"location":"tables/family/#4-data-consistency","title":"4. Data Consistency","text":"<ul> <li>Timestamp Support: Enhanced timestamp handling with <code>DEFAULT CURRENT_TIMESTAMP</code></li> <li>Constraint Validation: Foreign key constraints ensure data integrity</li> <li>NULL Handling: Improved NULL value handling for optional fields</li> </ul>"},{"location":"tables/family/#indexes-and-performance","title":"Indexes and Performance","text":""},{"location":"tables/family/#primary-indexes","title":"Primary Indexes","text":"<pre><code>-- Primary key\nCREATE UNIQUE INDEX idx_family_pk ON family(id);\n\n-- Foreign key index\nCREATE INDEX idx_family_person_id ON family(person_id);\n</code></pre>"},{"location":"tables/family/#recommended-indexes","title":"Recommended Indexes","text":"<pre><code>-- Marital status queries\nCREATE INDEX idx_family_marital_status ON family(marital_status);\n\n-- Spouse name searches\nCREATE INDEX idx_family_spouse ON family(spouse) WHERE spouse IS NOT NULL;\n\n-- Date-based queries\nCREATE INDEX idx_family_spouse_dob ON family(spouse_dob) WHERE spouse_dob IS NOT NULL;\nCREATE INDEX idx_family_last_changed ON family(last_changed);\n</code></pre>"},{"location":"tables/family/#common-queries","title":"Common Queries","text":""},{"location":"tables/family/#find-family-information-by-person","title":"Find Family Information by Person","text":"<pre><code>SELECT\n    p.first_name || ' ' || p.last_name as person_name,\n    f.marital_status,\n    f.spouse,\n    f.spouse_dob,\n    f.spouse_position,\n    f.spouse_employer,\n    f.children,\n    f.notes\nFROM family f\nJOIN person p ON f.person_id = p.id\nWHERE p.id = $1;\n</code></pre>"},{"location":"tables/family/#find-all-married-people","title":"Find All Married People","text":"<pre><code>SELECT\n    p.first_name || ' ' || p.last_name as person_name,\n    f.spouse,\n    f.spouse_dob,\n    EXTRACT(YEAR FROM AGE(CURRENT_DATE, f.spouse_dob)) as spouse_age\nFROM family f\nJOIN person p ON f.person_id = p.id\nWHERE f.marital_status = 'Married'\n  AND f.spouse IS NOT NULL\nORDER BY p.last_name, p.first_name;\n</code></pre>"},{"location":"tables/family/#find-people-with-children","title":"Find People with Children","text":"<pre><code>SELECT\n    p.first_name || ' ' || p.last_name as person_name,\n    f.children,\n    f.spouse\nFROM family f\nJOIN person p ON f.person_id = p.id\nWHERE f.children IS NOT NULL\n  AND f.children != ''\nORDER BY p.last_name, p.first_name;\n</code></pre>"},{"location":"tables/family/#spouse-birthday-reminders","title":"Spouse Birthday Reminders","text":"<pre><code>SELECT\n    p.first_name || ' ' || p.last_name as person_name,\n    f.spouse,\n    f.spouse_dob,\n    CASE\n        WHEN EXTRACT(DOY FROM f.spouse_dob) = EXTRACT(DOY FROM CURRENT_DATE)\n        THEN 'Today!'\n        WHEN EXTRACT(DOY FROM f.spouse_dob) BETWEEN\n             EXTRACT(DOY FROM CURRENT_DATE) AND\n             EXTRACT(DOY FROM CURRENT_DATE) + 30\n        THEN 'Upcoming'\n        ELSE 'Not Soon'\n    END as birthday_status\nFROM family f\nJOIN person p ON f.person_id = p.id\nWHERE f.spouse_dob IS NOT NULL\n  AND EXTRACT(DOY FROM f.spouse_dob) BETWEEN\n      EXTRACT(DOY FROM CURRENT_DATE) AND\n      EXTRACT(DOY FROM CURRENT_DATE) + 30\nORDER BY EXTRACT(DOY FROM f.spouse_dob);\n</code></pre>"},{"location":"tables/family/#data-quality-improvements","title":"Data Quality Improvements","text":""},{"location":"tables/family/#validation-rules","title":"Validation Rules","text":"<ol> <li> <p>Marital Status Validation</p> <ul> <li>Enum ensures only valid marital status values</li> <li>Unknown ('?') values are converted to 'Unknown' for clarity</li> </ul> </li> <li> <p>Date Validation</p> <ul> <li>Spouse birth dates must be realistic (not in future)</li> <li>Death dates must be after birth dates when both present</li> </ul> </li> <li> <p>Text Field Normalization</p> <ul> <li>Trim whitespace from spouse names and positions</li> <li>Standardize empty text fields to NULL</li> </ul> </li> </ol>"},{"location":"tables/family/#data-cleanup-during-migration","title":"Data Cleanup During Migration","text":"<pre><code>-- Example data cleanup\nUPDATE family_temp\nSET spouse = TRIM(spouse)\nWHERE spouse IS NOT NULL;\n\nUPDATE family_temp\nSET spouse = NULL\nWHERE spouse = '';\n\nUPDATE family_temp\nSET children = NULL\nWHERE children = '';\n</code></pre>"},{"location":"tables/family/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/family/#common-migration-issues","title":"Common Migration Issues","text":"<ol> <li> <p>Missing Person References <pre><code>Error: INSERT violates foreign key constraint \"family_person_id_fkey\"\nSolution: Ensure all donor_id values exist in the person mapping\n</code></pre></p> </li> <li> <p>Invalid Marital Status Values <pre><code>Error: invalid input value for enum marital_status_enum\nSolution: Update conversion function to handle all MySQL enum variations\n</code></pre></p> </li> <li> <p>Date Format Issues <pre><code>Error: invalid input syntax for type date\nSolution: Validate and clean date values during migration\n</code></pre></p> </li> </ol>"},{"location":"tables/family/#validation-queries","title":"Validation Queries","text":"<pre><code>-- Check for missing foreign key references\nSELECT COUNT(*) FROM family f\nLEFT JOIN person p ON f.person_id = p.id\nWHERE p.id IS NULL;\n\n-- Verify marital status distribution\nSELECT\n    marital_status,\n    COUNT(*) as count\nFROM family\nGROUP BY marital_status\nORDER BY count DESC;\n\n-- Check for invalid dates\nSELECT COUNT(*) FROM family\nWHERE spouse_dob &gt; CURRENT_DATE\n   OR (spouse_dod IS NOT NULL AND spouse_dob IS NOT NULL AND spouse_dod &lt;= spouse_dob);\n</code></pre>"},{"location":"tables/family/#post-migration-verification","title":"Post-Migration Verification","text":""},{"location":"tables/family/#data-integrity-checks","title":"Data Integrity Checks","text":"<ol> <li> <p>Record Count Verification <pre><code>-- Compare record counts\nSELECT 'MySQL' as source, COUNT(*) FROM mysql_family\nUNION ALL\nSELECT 'PostgreSQL' as source, COUNT(*) FROM family;\n</code></pre></p> </li> <li> <p>Marital Status Distribution <pre><code>-- Verify marital status conversion\nSELECT marital_status, COUNT(*) FROM family\nGROUP BY marital_status\nORDER BY count DESC;\n</code></pre></p> </li> <li> <p>Foreign Key Integrity <pre><code>-- Check all family records have valid person references\nSELECT\n    COUNT(*) as total_records,\n    COUNT(p.id) as valid_person_refs,\n    COUNT(*) - COUNT(p.id) as orphaned_records\nFROM family f\nLEFT JOIN person p ON f.person_id = p.id;\n</code></pre></p> </li> </ol>"},{"location":"tables/family/#performance-considerations","title":"Performance Considerations","text":""},{"location":"tables/family/#optimization-strategies","title":"Optimization Strategies","text":"<ol> <li>Basic Queries</li> <li>Index on <code>person_id</code> for joining with person table</li> <li>Index on <code>marital_status</code> for marital status filtering</li> <li> <p>Index on <code>last_changed</code> for recent updates</p> </li> <li> <p>Text Searches</p> </li> <li>Consider full-text search indexes for spouse names if needed</li> <li> <p>Use appropriate indexes for children text field searches</p> </li> <li> <p>Date Operations</p> </li> <li>Index spouse birth/death dates for birthday and anniversary queries</li> <li>Use date functions efficiently for age calculations</li> </ol> <p>This family table migration maintains essential family relationship data with a simple, straightforward structure that supports basic family information tracking and spouse/children management for constituent relationship management.</p>"},{"location":"tables/finance/","title":"Finance Table Migration","text":""},{"location":"tables/finance/#overview","title":"Overview","text":"<p>The <code>Finance</code> table migration transfers financial data from the MySQL database to a simplified PostgreSQL finance table. This is a direct field mapping migration with minimal transformation.</p>"},{"location":"tables/finance/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/finance/#mysql-source-tables","title":"MySQL Source Tables","text":"<ul> <li><code>Finance</code> - Financial records with gift information</li> <li><code>Charge</code> - Individual charge transactions</li> <li><code>Payment</code> - Individual payment transactions</li> </ul>"},{"location":"tables/finance/#postgresql-target-tables","title":"PostgreSQL Target Tables","text":"<ul> <li><code>finance</code> - Direct mapping of finance data (one record per person)</li> <li><code>transaction</code> - Consolidated charges and payments with transaction type discrimination</li> </ul>"},{"location":"tables/finance/#transaction-table-integration","title":"Transaction Table Integration","text":""},{"location":"tables/finance/#charge-and-payment-consolidation","title":"Charge and Payment Consolidation","text":"<p>The MySQL <code>Charge</code> and <code>Payment</code> tables are consolidated into a unified <code>transaction</code> table in PostgreSQL with type discrimination to distinguish between charges and payments.</p>"},{"location":"tables/finance/#mysql-source-schemas","title":"MySQL Source Schemas","text":"<p>Charge Table: <pre><code>CREATE TABLE Charge (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  donor_id INT NOT NULL,\n  campaign_id INT NOT NULL,\n  account INT NOT NULL,\n  amount DOUBLE NOT NULL DEFAULT 0,\n  billed TINYINT(1),\n  date DATE NOT NULL,\n  comments TINYTEXT,\n  entered_by VARCHAR(45),\n  last_changed TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n</code></pre></p> <p>Payment Table: <pre><code>CREATE TABLE Payment (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  donor_id INT NOT NULL,\n  campaign_id INT NOT NULL,\n  account INT NOT NULL,\n  batch INT NOT NULL DEFAULT 0,\n  amount DOUBLE NOT NULL DEFAULT 0,\n  post TINYINT(1),\n  billed TINYINT(1),\n  date DATE NOT NULL,\n  entered_by VARCHAR(45),\n  comments VARCHAR(255),\n  thankyou TINYINT(1) NOT NULL DEFAULT 0,\n  last_changed TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n);\n</code></pre></p>"},{"location":"tables/finance/#postgresql-transaction-table-schema","title":"PostgreSQL Transaction Table Schema","text":"<pre><code>CREATE TABLE transaction (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  person_id UUID NOT NULL REFERENCES person(id) ON DELETE CASCADE,\n  account VARCHAR(45) NOT NULL,\n  type VARCHAR(20) NOT NULL CHECK (type IN ('payment', 'charge')),\n  batch INTEGER,\n  amount NUMERIC(18,2) NOT NULL DEFAULT 0,\n  post BOOLEAN,\n  billed BOOLEAN,\n  date DATE NOT NULL,\n  entered_by VARCHAR(45),\n  comments TEXT,\n  thankyou BOOLEAN,\n  last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n</code></pre>"},{"location":"tables/finance/#transaction-migration-logic","title":"Transaction Migration Logic","text":"<p>The migration consolidates both Charge and Payment records into the transaction table:</p> <pre><code>// Migration handles both Charge and Payment tables\ntypes := []struct {\n    table   string\n    typeVal string\n}{\n    {\"Charge\", \"charge\"},\n    {\"Payment\", \"payment\"},\n}\n\n// For each table, insert records with appropriate type\nINSERT INTO transaction (\n    id, person_id, account, type, batch, amount, post, billed,\n    date, entered_by, comments, thankyou, last_changed\n) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13)\n</code></pre>"},{"location":"tables/finance/#field-mappings-for-transaction-table","title":"Field Mappings for Transaction Table","text":""},{"location":"tables/finance/#charge-table-mapping","title":"Charge Table Mapping","text":"MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID New UUID primary key <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Maps to person table <code>account</code> <code>account</code> INT \u2192 VARCHAR(45) Account reference simplified - <code>type</code> - Set to 'charge' - <code>batch</code> - NULL for charges <code>amount</code> <code>amount</code> DOUBLE \u2192 NUMERIC(18,2) Enhanced precision - <code>post</code> - NULL for charges <code>billed</code> <code>billed</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>date</code> <code>date</code> DATE \u2192 DATE Direct mapping <code>entered_by</code> <code>entered_by</code> VARCHAR(45) \u2192 VARCHAR(45) Direct mapping <code>comments</code> <code>comments</code> TINYTEXT \u2192 TEXT Enhanced capacity - <code>thankyou</code> - NULL for charges <code>last_changed</code> <code>last_changed</code> TIMESTAMP \u2192 TIMESTAMP Direct mapping"},{"location":"tables/finance/#payment-table-mapping","title":"Payment Table Mapping","text":"MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID New UUID primary key <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Maps to person table <code>account</code> <code>account</code> INT \u2192 VARCHAR(45) Account reference simplified - <code>type</code> - Set to 'payment' <code>batch</code> <code>batch</code> INT \u2192 INTEGER Direct mapping <code>amount</code> <code>amount</code> DOUBLE \u2192 NUMERIC(18,2) Enhanced precision <code>post</code> <code>post</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>billed</code> <code>billed</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>date</code> <code>date</code> DATE \u2192 DATE Direct mapping <code>entered_by</code> <code>entered_by</code> VARCHAR(45) \u2192 VARCHAR(45) Direct mapping <code>comments</code> <code>comments</code> VARCHAR(255) \u2192 TEXT Enhanced capacity <code>thankyou</code> <code>thankyou</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>last_changed</code> <code>last_changed</code> TIMESTAMP \u2192 TIMESTAMP Direct mapping"},{"location":"tables/finance/#transaction-table-benefits","title":"Transaction Table Benefits","text":"<ol> <li> <p>Unified Financial Transaction Tracking</p> <ul> <li>Single table for all financial transactions</li> <li>Type field distinguishes charges from payments</li> <li>Simplified querying and reporting</li> </ul> </li> <li> <p>Enhanced Data Types</p> <ul> <li>UUID primary keys for better distributed system support</li> <li>NUMERIC(18,2) for precise monetary calculations</li> <li>Native BOOLEAN types instead of TINYINT</li> </ul> </li> <li> <p>Improved Referential Integrity</p> <ul> <li>Foreign key to person table ensures data consistency</li> <li>Cascade deletes maintain referential integrity</li> </ul> </li> <li> <p>Flexible Transaction Management</p> <ul> <li>Supports both charge and payment workflows</li> <li>Batch processing support for payments</li> <li>Thank you tracking for payments</li> </ul> </li> </ol>"},{"location":"tables/finance/#postgresql-table-schema","title":"PostgreSQL Table Schema","text":"<pre><code>CREATE TABLE IF NOT EXISTS finance (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  person_id UUID NOT NULL REFERENCES person(id) ON DELETE CASCADE,\n  gift_date DATE,\n  amount NUMERIC(18,2),\n  amount_owed NUMERIC(18,2),\n  matching BOOLEAN,\n  matching_comment VARCHAR(45),\n  perpetual BOOLEAN,\n  perpetual_comment VARCHAR(45),\n  planned BOOLEAN,\n  planned_comment VARCHAR(45),\n  recognition VARCHAR(45),\n  thank_you BOOLEAN,\n  statements BOOLEAN,\n  naming VARCHAR(45),\n  last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  UNIQUE (person_id)\n);\n</code></pre>"},{"location":"tables/finance/#field-mappings","title":"Field Mappings","text":""},{"location":"tables/finance/#direct-field-mappings","title":"Direct Field Mappings","text":"MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID Primary key with new UUID <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Foreign key to person table <code>gift_date</code> <code>gift_date</code> DATE \u2192 DATE Direct mapping <code>amount</code> <code>amount</code> DOUBLE \u2192 NUMERIC(18,2) Enhanced precision <code>amount_owed</code> <code>amount_owed</code> DOUBLE \u2192 NUMERIC(18,2) Enhanced precision <code>matching</code> <code>matching</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>matching_comment</code> <code>matching_comment</code> VARCHAR(45) \u2192 VARCHAR(45) Direct mapping <code>perpetual</code> <code>perpetual</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>perpetual_comment</code> <code>perpetual_comment</code> VARCHAR(45) \u2192 VARCHAR(45) Direct mapping <code>planned</code> <code>planned</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>planned_comment</code> <code>planned_comment</code> VARCHAR(45) \u2192 VARCHAR(45) Direct mapping <code>recognition</code> <code>recognition</code> VARCHAR(45) \u2192 VARCHAR(45) Direct mapping <code>thank_you</code> <code>thank_you</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>statements</code> <code>statements</code> TINYINT(1) \u2192 BOOLEAN Boolean conversion <code>naming</code> <code>naming</code> VARCHAR(45) \u2192 VARCHAR(45) Direct mapping <code>last_changed</code> <code>last_changed</code> TIMESTAMP \u2192 TIMESTAMP Direct mapping"},{"location":"tables/finance/#fields-not-migrated","title":"Fields Not Migrated","text":"<ul> <li><code>campaign_id</code> - Not included in PostgreSQL schema</li> </ul>"},{"location":"tables/finance/#key-constraints","title":"Key Constraints","text":"<ul> <li>UNIQUE constraint on person_id: Only one finance record per person</li> <li>Foreign key to person table: Links finance data to individual records</li> </ul>"},{"location":"tables/finance/#migration-logic","title":"Migration Logic","text":""},{"location":"tables/finance/#data-transformation-process","title":"Data Transformation Process","text":"<ol> <li> <p>Person ID Mapping <pre><code>personID, ok := m.personMapping.Get(donorID)\nif !ok {\n    skipped++\n    continue\n}\n</code></pre></p> </li> <li> <p>Direct Field Transfer <pre><code>// Direct mapping of all fields from MySQL to PostgreSQL\nfinanceID := generateUUID()\nsql := `\n    INSERT INTO finance (\n        id, person_id, gift_date, amount, amount_owed, matching, matching_comment,\n        perpetual, perpetual_comment, planned, planned_comment, recognition,\n        thank_you, statements, naming, last_changed\n    ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16)\n    ON CONFLICT (id) DO NOTHING\n`\n</code></pre></p> </li> <li> <p>Boolean Conversion</p> </li> <li>MySQL TINYINT(1) values converted to PostgreSQL BOOLEAN</li> <li> <p>NULL values preserved</p> </li> <li> <p>Precision Enhancement</p> </li> <li>DOUBLE values converted to NUMERIC(18,2) for better precision</li> </ol>"},{"location":"tables/finance/#key-features","title":"Key Features","text":""},{"location":"tables/finance/#simple-financial-tracking","title":"Simple Financial Tracking","text":"<ol> <li> <p>One Record Per Person</p> <ul> <li>Unique constraint ensures single finance record per person</li> <li>Consolidates financial information for each individual</li> </ul> </li> <li> <p>Basic Gift Information</p> <ul> <li>Gift date, amount, and amount owed tracking</li> <li>Boolean flags for matching, perpetual, and planned gifts</li> <li>Comments for matching, perpetual, and planned giving</li> </ul> </li> <li> <p>Recognition and Communication</p> <ul> <li>Recognition level tracking</li> <li>Thank you and statement preferences</li> <li>Naming rights information</li> </ul> </li> </ol>"},{"location":"tables/finance/#indexes-and-performance","title":"Indexes and Performance","text":""},{"location":"tables/finance/#primary-indexes","title":"Primary Indexes","text":"<pre><code>-- Automatically created indexes\nCREATE UNIQUE INDEX finance_pkey ON finance(id);\nCREATE UNIQUE INDEX finance_person_id_key ON finance(person_id);\nCREATE INDEX idx_finance_person_id ON finance(person_id);\n</code></pre>"},{"location":"tables/finance/#common-queries","title":"Common Queries","text":""},{"location":"tables/finance/#basic-finance-report","title":"Basic Finance Report","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    f.amount,\n    f.gift_date,\n    f.recognition\nFROM finance f\nJOIN person p ON f.person_id = p.id\nWHERE f.amount IS NOT NULL\nORDER BY f.amount DESC;\n</code></pre>"},{"location":"tables/finance/#matching-gift-summary","title":"Matching Gift Summary","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    f.amount,\n    f.matching_comment\nFROM finance f\nJOIN person p ON f.person_id = p.id\nWHERE f.matching = true\nORDER BY f.amount DESC;\n</code></pre>"},{"location":"tables/finance/#outstanding-amounts","title":"Outstanding Amounts","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    f.amount_owed,\n    f.gift_date\nFROM finance f\nJOIN person p ON f.person_id = p.id\nWHERE f.amount_owed &gt; 0\nORDER BY f.amount_owed DESC;\n</code></pre>"},{"location":"tables/finance/#transaction-analysis-queries","title":"Transaction Analysis Queries","text":""},{"location":"tables/finance/#payment-vs-charge-summary","title":"Payment vs Charge Summary","text":"<pre><code>SELECT\n    t.type,\n    COUNT(*) as transaction_count,\n    SUM(t.amount) as total_amount,\n    AVG(t.amount) as average_amount\nFROM transaction t\nGROUP BY t.type\nORDER BY t.type;\n</code></pre>"},{"location":"tables/finance/#person-transaction-history","title":"Person Transaction History","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    t.type,\n    t.amount,\n    t.date,\n    t.comments\nFROM transaction t\nJOIN person p ON t.person_id = p.id\nWHERE p.id = $1  -- Replace with specific person UUID\nORDER BY t.date DESC;\n</code></pre>"},{"location":"tables/finance/#outstanding-charges-unbilled","title":"Outstanding Charges (Unbilled)","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    t.amount,\n    t.date,\n    t.account\nFROM transaction t\nJOIN person p ON t.person_id = p.id\nWHERE t.type = 'charge'\n  AND (t.billed = false OR t.billed IS NULL)\nORDER BY t.date ASC;\n</code></pre>"},{"location":"tables/finance/#payment-batch-summary","title":"Payment Batch Summary","text":"<pre><code>SELECT\n    t.batch,\n    COUNT(*) as payment_count,\n    SUM(t.amount) as batch_total,\n    MIN(t.date) as earliest_payment,\n    MAX(t.date) as latest_payment\nFROM transaction t\nWHERE t.type = 'payment'\n  AND t.batch IS NOT NULL\nGROUP BY t.batch\nORDER BY t.batch;\n</code></pre>"},{"location":"tables/finance/#combined-finance-and-transaction-report","title":"Combined Finance and Transaction Report","text":"<pre><code>SELECT\n    p.first_name,\n    p.last_name,\n    f.amount as total_gift_amount,\n    f.amount_owed,\n    (\n        SELECT COUNT(*)\n        FROM transaction t\n        WHERE t.person_id = p.id AND t.type = 'charge'\n    ) as total_charges,\n    (\n        SELECT COUNT(*)\n        FROM transaction t\n        WHERE t.person_id = p.id AND t.type = 'payment'\n    ) as total_payments,\n    (\n        SELECT SUM(t.amount)\n        FROM transaction t\n        WHERE t.person_id = p.id AND t.type = 'payment'\n    ) as total_payments_amount\nFROM finance f\nJOIN person p ON f.person_id = p.id\nORDER BY f.amount DESC;\n</code></pre>"},{"location":"tables/finance/#data-quality-improvements","title":"Data Quality Improvements","text":""},{"location":"tables/finance/#validation-rules","title":"Validation Rules","text":"<ol> <li> <p>Amount Validation</p> <ul> <li>Amount and amount_owed use NUMERIC(18,2) for precise decimal handling</li> <li>Currency precision limited to 2 decimal places</li> </ul> </li> <li> <p>Date Validation</p> <ul> <li>Gift dates validated during migration</li> <li>Last_changed timestamps preserved from source</li> </ul> </li> <li> <p>Boolean Validation</p> <ul> <li>MySQL TINYINT(1) values properly converted to PostgreSQL BOOLEAN</li> <li>NULL values preserved where appropriate</li> </ul> </li> </ol>"},{"location":"tables/finance/#data-cleanup-during-migration","title":"Data Cleanup During Migration","text":"<ol> <li> <p>Person ID Validation <pre><code>-- Verify all finance records have valid person references\nSELECT COUNT(*) FROM finance f\nLEFT JOIN person p ON f.person_id = p.id\nWHERE p.id IS NULL;\n</code></pre></p> </li> <li> <p>Unique Constraint Enforcement <pre><code>-- Check for multiple finance records per person (should be 0)\nSELECT person_id, COUNT(*)\nFROM finance\nGROUP BY person_id\nHAVING COUNT(*) &gt; 1;\n</code></pre></p> </li> </ol>"},{"location":"tables/finance/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/finance/#common-migration-issues","title":"Common Migration Issues","text":"<ol> <li> <p>Person Reference Errors <pre><code>Error: foreign key constraint violation\nSolution: Ensure all donor_id values from MySQL exist in person table\n</code></pre></p> </li> <li> <p>UUID Generation Issues <pre><code>Error: duplicate key value violates unique constraint\nSolution: Check UUID generation function availability\n</code></pre></p> </li> <li> <p>Boolean Conversion Issues <pre><code>Error: invalid input syntax for type boolean\nSolution: Verify TINYINT(1) values are 0, 1, or NULL\n</code></pre></p> </li> <li> <p>Amount Precision Issues <pre><code>Error: numeric field overflow\nSolution: Check for amounts exceeding NUMERIC(18,2) precision\n</code></pre></p> </li> </ol>"},{"location":"tables/finance/#validation-queries","title":"Validation Queries","text":"<pre><code>-- Check for missing person references before migration\nSELECT COUNT(*) FROM mysql_finance mf\nLEFT JOIN person p ON mf.donor_id = p.original_mysql_id\nWHERE p.id IS NULL;\n\n-- Verify amount ranges are reasonable\nSELECT\n    COUNT(*) as total_records,\n    MIN(amount) as min_amount,\n    MAX(amount) as max_amount,\n    AVG(amount) as avg_amount\nFROM finance;\n\n-- Check boolean field conversions\nSELECT\n    matching,\n    perpetual,\n    planned,\n    thank_you,\n    statements,\n    COUNT(*)\nFROM finance\nGROUP BY matching, perpetual, planned, thank_you, statements;\n</code></pre>"},{"location":"tables/finance/#post-migration-verification","title":"Post-Migration Verification","text":""},{"location":"tables/finance/#data-integrity-checks","title":"Data Integrity Checks","text":"<ol> <li> <p>Record Count Verification <pre><code>-- Compare finance record counts between source and target\nSELECT 'MySQL Finance' as source, COUNT(*) FROM mysql_finance\nUNION ALL\nSELECT 'PostgreSQL Finance' as source, COUNT(*) FROM finance;\n</code></pre></p> </li> <li> <p>Transaction Record Count Verification <pre><code>-- Compare transaction record counts between source and target\nSELECT 'MySQL Charge' as source, COUNT(*) FROM mysql_charge\nUNION ALL\nSELECT 'MySQL Payment' as source, COUNT(*) FROM mysql_payment\nUNION ALL\nSELECT 'PostgreSQL Charge' as source, COUNT(*) FROM transaction WHERE type = 'charge'\nUNION ALL\nSELECT 'PostgreSQL Payment' as source, COUNT(*) FROM transaction WHERE type = 'payment';\n</code></pre></p> </li> <li> <p>Amount Total Verification <pre><code>-- Verify total amounts match between systems\nSELECT 'MySQL Finance' as source, SUM(amount) FROM mysql_finance\nUNION ALL\nSELECT 'PostgreSQL Finance' as source, SUM(amount) FROM finance\nUNION ALL\nSELECT 'MySQL Charge Total' as source, SUM(amount) FROM mysql_charge\nUNION ALL\nSELECT 'MySQL Payment Total' as source, SUM(amount) FROM mysql_payment\nUNION ALL\nSELECT 'PostgreSQL Charge Total' as source, SUM(amount) FROM transaction WHERE type = 'charge'\nUNION ALL\nSELECT 'PostgreSQL Payment Total' as source, SUM(amount) FROM transaction WHERE type = 'payment';\n</code></pre></p> </li> <li> <p>Person Mapping Verification <pre><code>-- Verify all finance records have valid person references\nSELECT\n    COUNT(*) as total_finance_records,\n    COUNT(p.id) as records_with_person,\n    COUNT(*) - COUNT(p.id) as orphaned_records\nFROM finance f\nLEFT JOIN person p ON f.person_id = p.id;\n\n-- Verify all transaction records have valid person references\nSELECT\n    COUNT(*) as total_transaction_records,\n    COUNT(p.id) as records_with_person,\n    COUNT(*) - COUNT(p.id) as orphaned_records\nFROM transaction t\nLEFT JOIN person p ON t.person_id = p.id;\n</code></pre></p> </li> <li> <p>Transaction Type Distribution <pre><code>-- Check transaction type distribution\nSELECT\n    type,\n    COUNT(*) as count,\n    SUM(amount) as total_amount,\n    AVG(amount) as avg_amount\nFROM transaction\nGROUP BY type\nORDER BY type;\n</code></pre></p> </li> <li> <p>Field Value Verification <pre><code>-- Check boolean field distributions in finance table\nSELECT\n    'matching' as field,\n    matching as value,\n    COUNT(*) as count\nFROM finance\nGROUP BY matching\nUNION ALL\nSELECT\n    'perpetual' as field,\n    perpetual::text as value,\n    COUNT(*) as count\nFROM finance\nGROUP BY perpetual\nORDER BY field, value;\n\n-- Check boolean field distributions in transaction table\nSELECT\n    'post' as field,\n    post::text as value,\n    COUNT(*) as count\nFROM transaction\nGROUP BY post\nUNION ALL\nSELECT\n    'billed' as field,\n    billed::text as value,\n    COUNT(*) as count\nFROM transaction\nGROUP BY billed\nUNION ALL\nSELECT\n    'thankyou' as field,\n    thankyou::text as value,\n    COUNT(*) as count\nFROM transaction\nGROUP BY thankyou\nORDER BY field, value;\n</code></pre></p> </li> </ol>"},{"location":"tables/finance/#performance-considerations","title":"Performance Considerations","text":""},{"location":"tables/finance/#optimization-strategies","title":"Optimization Strategies","text":"<ol> <li>Finance Table Index Usage</li> <li>Primary key index on <code>id</code> for fast lookups</li> <li>Unique index on <code>person_id</code> enforces one record per person</li> <li> <p>Foreign key index improves join performance with person table</p> </li> <li> <p>Transaction Table Index Recommendations <pre><code>-- Recommended indexes for transaction table\nCREATE INDEX idx_transaction_person_id ON transaction(person_id);\nCREATE INDEX idx_transaction_type ON transaction(type);\nCREATE INDEX idx_transaction_date ON transaction(date);\nCREATE INDEX idx_transaction_account ON transaction(account);\nCREATE INDEX idx_transaction_type_date ON transaction(type, date);\n\n-- For payment batch queries\nCREATE INDEX idx_transaction_batch ON transaction(batch) WHERE batch IS NOT NULL;\n\n-- For billing status queries\nCREATE INDEX idx_transaction_billed ON transaction(billed, type) WHERE billed IS NOT NULL;\n</code></pre></p> </li> <li> <p>Query Optimization</p> </li> <li>Use person_id for direct lookups rather than joins when possible</li> <li>Consider covering indexes for frequently accessed field combinations</li> <li>Monitor query performance for reporting queries involving both finance and transaction tables</li> <li> <p>Use transaction type filters early in WHERE clauses</p> </li> <li> <p>Data Management</p> </li> <li>Regular VACUUM and ANALYZE operations for optimal performance</li> <li>Consider partitioning transaction table by date for very large datasets</li> <li>Monitor table growth and plan for scaling</li> <li>Archive old transaction records based on business requirements</li> </ol>"},{"location":"tables/finance/#maintenance-recommendations","title":"Maintenance Recommendations","text":"<ol> <li> <p>Regular Statistics Updates <pre><code>-- Update table statistics for optimal query planning\nANALYZE finance;\nANALYZE transaction;\n</code></pre></p> </li> <li> <p>Index Maintenance <pre><code>-- Monitor index usage for finance table\nSELECT\n    schemaname,\n    tablename,\n    indexname,\n    idx_scan,\n    idx_tup_read,\n    idx_tup_fetch\nFROM pg_stat_user_indexes\nWHERE tablename = 'finance';\n\n-- Monitor index usage for transaction table\nSELECT\n    schemaname,\n    tablename,\n    indexname,\n    idx_scan,\n    idx_tup_read,\n    idx_tup_fetch\nFROM pg_stat_user_indexes\nWHERE tablename = 'transaction';\n</code></pre></p> </li> <li> <p>Transaction Table Partitioning (Optional for Large Datasets) <pre><code>-- Example: Partition transaction table by year for performance\nCREATE TABLE transaction_2024 PARTITION OF transaction\nFOR VALUES FROM ('2024-01-01') TO ('2025-01-01');\n\nCREATE TABLE transaction_2025 PARTITION OF transaction\nFOR VALUES FROM ('2025-01-01') TO ('2026-01-01');\n</code></pre></p> </li> </ol> <p>This finance and transaction table migration provides a comprehensive foundation for financial data management with proper constraints, data integrity, transaction tracking, and performance optimization.</p>"},{"location":"tables/organization/","title":"Organization Table Migration","text":"<p>The Organization table represents the transformation from MySQL's <code>Donor_Group</code> table (where <code>main = 1</code>) to PostgreSQL's <code>organization</code> table, serving as the foundation for managing fraternity chapters, alumni associations, and other organizational entities.</p>"},{"location":"tables/organization/#overview","title":"Overview","text":"<p>Organizations are the primary entities that manage chapters, events, and member relationships. The migration enhances the original MySQL structure with improved data types, better international support, and enhanced audit capabilities.</p>"},{"location":"tables/organization/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/organization/#mysql-source-table-donor_group-main_group1","title":"MySQL Source Table: <code>Donor_Group</code> (main_group=1)","text":"<pre><code>CREATE TABLE `Donor_Group` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `title` varchar(45) NOT NULL DEFAULT '',\n  `main_group` int(10) unsigned DEFAULT NULL,\n  `description` text DEFAULT NULL,\n  `main` tinyint(1) NOT NULL DEFAULT 0,\n  `active` tinyint(1) unsigned NOT NULL DEFAULT 1,\n  `lastchanged` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=6009 DEFAULT CHARSET=latin1 COLLATE=latin1_swedish_ci;\n</code></pre>"},{"location":"tables/organization/#postgresql-target-table-organization","title":"PostgreSQL Target Table: <code>organization</code>","text":"<pre><code>CREATE TABLE IF NOT EXISTS organization (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  shortcode VARCHAR(16) UNIQUE,\n  title VARCHAR(45),\n  description TEXT,\n  poc VARCHAR(45),\n  email TEXT,\n  work VARCHAR(25),\n  fax VARCHAR(25),\n  website TEXT,\n  year_type year_type_enum DEFAULT 'Initiation',\n  comments TEXT,\n  is_enabled BOOLEAN DEFAULT true,\n  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n  last_changed TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n</code></pre>"},{"location":"tables/organization/#key-changes-and-improvements","title":"Key Changes and Improvements","text":""},{"location":"tables/organization/#1-primary-key-modernization","title":"1. Primary Key Modernization","text":"<p>MySQL: Auto-increment integer <pre><code>id int(10) unsigned NOT NULL AUTO_INCREMENT\n</code></pre></p> <p>PostgreSQL: UUID for better distributed system support <pre><code>id UUID PRIMARY KEY DEFAULT uuid_generate_v4()\n</code></pre></p> <p>Benefits: - Globally unique identifiers - Better for distributed systems - Enhanced security (non-sequential) - Easier data merging and synchronization</p>"},{"location":"tables/organization/#2-enhanced-data-organization","title":"2. Enhanced Data Organization","text":""},{"location":"tables/organization/#new-organizational-fields","title":"New Organizational Fields","text":"<p>PostgreSQL adds several new fields for better organization management: <pre><code>shortcode VARCHAR(16) UNIQUE,      -- Short identifier code\npoc VARCHAR(45),                   -- Point of contact\nyear_type year_type_enum DEFAULT 'Initiation',  -- Year type classification\n</code></pre></p>"},{"location":"tables/organization/#status-management-enhancement","title":"Status Management Enhancement","text":"<p>MySQL: Basic active flag <pre><code>active tinyint(1) unsigned NOT NULL DEFAULT 1\n</code></pre></p> <p>PostgreSQL: Enhanced status tracking <pre><code>is_enabled BOOLEAN DEFAULT true\n</code></pre></p>"},{"location":"tables/organization/#3-contact-information-enhancement","title":"3. Contact Information Enhancement","text":""},{"location":"tables/organization/#phone-and-communication","title":"Phone and Communication","text":"<p>PostgreSQL adds dedicated contact fields: <pre><code>work VARCHAR(25),                  -- Work phone number\nfax VARCHAR(25),                   -- Fax number\nemail TEXT,                        -- Email address\nwebsite TEXT                       -- Website URL\n</code></pre></p>"},{"location":"tables/organization/#4-audit-and-timestamp-tracking","title":"4. Audit and Timestamp Tracking","text":""},{"location":"tables/organization/#enhanced-timestamp-management","title":"Enhanced Timestamp Management","text":"<p>MySQL: Basic timestamp tracking <pre><code>lastchanged timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()\n</code></pre></p> <p>PostgreSQL: Comprehensive audit trail with timezone support <pre><code>created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\nlast_changed TIMESTAMPTZ NOT NULL DEFAULT NOW()\n</code></pre></p>"},{"location":"tables/organization/#5-improved-data-structure","title":"5. Improved Data Structure","text":""},{"location":"tables/organization/#description-and-comments","title":"Description and Comments","text":"<p>MySQL: Basic description <pre><code>description text DEFAULT NULL\n</code></pre></p> <p>PostgreSQL: Enhanced description and comments structure <pre><code>description TEXT,\ncomments TEXT\n</code></pre></p>"},{"location":"tables/organization/#field-mapping-reference","title":"Field Mapping Reference","text":""},{"location":"tables/organization/#complete-mysql-to-postgresql-field-mapping","title":"Complete MySQL to PostgreSQL Field Mapping","text":"MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID Primary key conversion <code>title</code> <code>title</code> VARCHAR(45) \u2192 VARCHAR(45) Same size, but enhanced validation <code>description</code> <code>description</code> TEXT \u2192 TEXT Direct mapping <code>active</code> <code>is_enabled</code> TINYINT(1) \u2192 BOOLEAN Status field renamed and type improved <code>lastchanged</code> <code>last_changed</code> TIMESTAMP \u2192 TIMESTAMPTZ Timezone support added N/A <code>created_at</code> New TIMESTAMPTZ Creation timestamp tracking"},{"location":"tables/organization/#new-fields-postgresql-only","title":"New Fields (PostgreSQL Only)","text":"Field Type Purpose <code>shortcode</code> VARCHAR(16) UNIQUE Short identifier code for organizations <code>poc</code> VARCHAR(45) Point of contact person <code>email</code> TEXT Organization email address <code>work</code> VARCHAR(25) Work phone number <code>fax</code> VARCHAR(25) Fax number <code>website</code> TEXT Organization website URL <code>year_type</code> year_type_enum Year type classification (defaults to 'Initiation') <code>comments</code> TEXT Additional comments and notes"},{"location":"tables/organization/#filtered-fields-not-migrated","title":"Filtered Fields (Not Migrated)","text":"MySQL Field Reason Not Migrated <code>main_group</code> Used only for linking, not needed in target <code>main</code> Legacy field, functionality replaced by other mechanisms"},{"location":"tables/organization/#migration-logic","title":"Migration Logic","text":""},{"location":"tables/organization/#1-filtering-and-selection","title":"1. Filtering and Selection","text":"<p>Only organizations (not chapter groups) are migrated:</p> <pre><code>SELECT * FROM Donor_Group\nWHERE main = 1\n</code></pre>"},{"location":"tables/organization/#2-uuid-generation-and-mapping","title":"2. UUID Generation and Mapping","text":"<p>Each MySQL <code>id</code> is mapped to a new PostgreSQL UUID:</p> <pre><code>-- Create mapping for reference by other tables\nINSERT INTO id_mapping (mysql_table, mysql_id, postgres_id)\nSELECT 'donor_group', id, gen_random_uuid()\nFROM mysql.Donor_Group WHERE main = 1;\n</code></pre>"},{"location":"tables/organization/#3-default-value-application","title":"3. Default Value Application","text":"<pre><code>-- Set default values during migration\nUPDATE organization\nSET\n    is_enabled = COALESCE(is_enabled, true),\n    year_type = COALESCE(year_type, 'Initiation'),\n    title = CASE\n        WHEN title IS NULL OR title = ''\n        THEN 'Organization ' || id::TEXT\n        ELSE title\n    END;\n</code></pre>"},{"location":"tables/organization/#organization-management","title":"Organization Management","text":"<pre><code>-- Find active organizations\nSELECT id, title, shortcode, poc\nFROM organization\nWHERE is_enabled = true\nORDER BY title;\n\n-- Search organizations by shortcode\nSELECT id, title, description, poc, email\nFROM organization\nWHERE shortcode = 'ALPHA'\n  AND is_enabled = true;\n\n-- Find organizations by name pattern\nSELECT id, title, shortcode, website\nFROM organization\nWHERE title ILIKE '%alpha%'\n   AND is_enabled = true\nORDER BY title;\n\n-- Organizations by year type\nSELECT id, title, year_type, poc\nFROM organization\nWHERE year_type = 'Initiation'\n  AND is_enabled = true\nORDER BY title;\n</code></pre>"},{"location":"tables/organization/#contact-information-queries","title":"Contact Information Queries","text":"<pre><code>-- Organizations with complete contact info\nSELECT id, title, poc, email, work, website\nFROM organization\nWHERE is_enabled = true\n  AND poc IS NOT NULL\n  AND email IS NOT NULL\nORDER BY title;\n\n-- Organizations needing contact update\nSELECT id, title, shortcode\nFROM organization\nWHERE is_enabled = true\n  AND (poc IS NULL OR email IS NULL)\nORDER BY title;\n\n-- Organizations with websites\nSELECT id, title, website, email\nFROM organization\nWHERE is_enabled = true\n  AND website IS NOT NULL\nORDER BY title;\n</code></pre>"},{"location":"tables/organization/#administrative-queries","title":"Administrative Queries","text":"<pre><code>-- Recently created organizations\nSELECT id, title, shortcode, created_at\nFROM organization\nWHERE created_at &gt;= CURRENT_DATE - INTERVAL '30 days'\nORDER BY created_at DESC;\n\n-- Recently updated organizations\nSELECT id, title, last_changed\nFROM organization\nWHERE last_changed &gt;= CURRENT_DATE - INTERVAL '7 days'\nORDER BY last_changed DESC;\n</code></pre>"},{"location":"tables/organization/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/organization/#common-migration-issues","title":"Common Migration Issues","text":""},{"location":"tables/organization/#1-duplicate-titles","title":"1. Duplicate Titles","text":"<pre><code>-- Check for potential title conflicts\nSELECT title, COUNT(*) as count\nFROM organization\nGROUP BY title\nHAVING COUNT(*) &gt; 1;\n</code></pre>"},{"location":"tables/organization/#2-duplicate-shortcodes","title":"2. Duplicate Shortcodes","text":"<pre><code>-- Check for shortcode conflicts (should be unique)\nSELECT shortcode, COUNT(*) as count\nFROM organization\nWHERE shortcode IS NOT NULL\nGROUP BY shortcode\nHAVING COUNT(*) &gt; 1;\n</code></pre>"},{"location":"tables/organization/#3-invalid-contact-information","title":"3. Invalid Contact Information","text":"<pre><code>-- Find organizations with invalid data\nSELECT id, title, email, website, work\nFROM organization\nWHERE (email IS NOT NULL AND email !~ '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$')\n   OR (website IS NOT NULL AND website !~ '^https?://')\n   OR (work IS NOT NULL AND LENGTH(work) &lt; 10);\n</code></pre>"},{"location":"tables/organization/#4-missing-required-data","title":"4. Missing Required Data","text":"<pre><code>-- Organizations missing critical information\nSELECT id, title, shortcode,\n       CASE\n         WHEN title IS NULL OR title = '' THEN 'Missing title'\n         WHEN shortcode IS NULL OR shortcode = '' THEN 'Missing shortcode'\n       END as issue\nFROM organization\nWHERE title IS NULL OR title = '' OR shortcode IS NULL OR shortcode = '';\n</code></pre> <p>This organization table migration provides a robust foundation for managing fraternity organizations with enhanced data quality, international support, and modern PostgreSQL features.</p>"},{"location":"tables/other-tables/","title":"Other Tables Migration","text":""},{"location":"tables/other-tables/#overview","title":"Overview","text":"<p>This document covers the migration of additional tables that provide specialized functionality for campaign management, volunteer tracking, recognition programs, and donor analytics. These tables maintain their core structure while receiving enhancements for better data integrity and reporting capabilities.</p>"},{"location":"tables/other-tables/#campaign-and-prospect-management","title":"Campaign and Prospect Management","text":""},{"location":"tables/other-tables/#prospect-table","title":"Prospect Table","text":"<p>Purpose: Tracks potential donors with detailed prospect research and wealth analysis</p> MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID Primary key conversion <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Foreign key to person table <code>campaign_id</code> Campaign linked via context INT \u2192 UUID Campaign association <code>loyal</code> <code>loyal</code> BOOLEAN Loyalty indicator <code>loyal_comment</code> <code>loyal_comment</code> VARCHAR(255) Loyalty assessment notes <code>leader</code> <code>leader</code> BOOLEAN Leadership potential indicator <code>leader_comment</code> <code>leader_comment</code> VARCHAR(255) Leadership assessment notes <code>lots_of_money</code> <code>lots_of_money</code> BOOLEAN High wealth indicator <code>lots_of_money_comment</code> <code>lots_of_money_comment</code> VARCHAR(255) Wealth assessment notes <code>is_low_priority</code> <code>is_low_priority</code> BOOLEAN Low priority flag <code>low_priority_comment</code> <code>low_priority_comment</code> VARCHAR(255) Low priority reasoning <code>5L</code> <code>five_l</code> SMALLINT Five L rating score <code>study_action</code> <code>study_action</code> SMALLINT Study action code (-1 default) <code>study_status</code> <code>study_status</code> SMALLINT Study status code (-1 default) <code>willingness</code> <code>willingness</code> SMALLINT Willingness to give score (-1 default) <code>range_start</code> <code>range_start</code> INTEGER Gift range minimum <code>range_end</code> <code>range_end</code> INTEGER Gift range maximum <code>capability</code> <code>capability</code> SMALLINT Giving capability score (8 default) <code>ask</code> <code>ask</code> NUMERIC(18,2) Suggested ask amount <code>campaign_status</code> <code>campaign_status</code> SMALLINT Campaign-specific status <code>pkg_sent</code> <code>pkg_sent</code> DATE Package sent date <code>section</code> <code>section</code> SMALLINT Campaign section assignment <code>solicitor</code> <code>solicitor</code> UUID Assigned solicitor (person reference) <code>comments</code> <code>comments</code> VARCHAR(255) General comments <code>donor_score</code> <code>donor_score</code> SMALLINT Donor scoring (-1 default) <code>ds_rating</code> <code>ds_rating</code> SMALLINT DonorSearch rating (-1 default) <code>real_estate_count</code> <code>real_estate_count</code> SMALLINT Number of real estate properties <code>real_estate_total</code> <code>real_estate_total</code> INTEGER Total real estate value <code>capacity_to_give</code> <code>capacity_to_give</code> SMALLINT Capacity assessment score <code>wealth_score</code> <code>wealth_score</code> SMALLINT Overall wealth score <code>networth</code> <code>networth</code> NUMERIC(18,2) Estimated net worth <code>donates_to_charity</code> <code>donates_to_charity</code> SMALLINT Charitable giving indicator <code>income</code> <code>income</code> NUMERIC(18,2) Estimated annual income <code>top_percent_flag</code> <code>top_percent_flag</code> BOOLEAN Top percentage wealth indicator <code>af_score</code> <code>af_score</code> INTEGER AF scoring system value <code>mg_score</code> <code>mg_score</code> INTEGER MG scoring system value <code>number_of_gifts</code> <code>number_of_gifts</code> INTEGER Historical gift count (-1 default) <p>Key Features: - Comprehensive wealth and capacity analysis - Multiple scoring systems (5L, donor_score, wealth_score, etc.) - Campaign-specific prospect management - Detailed assessment comments for each category</p>"},{"location":"tables/other-tables/#feasibility-campaign-info-table","title":"Feasibility Campaign Info Table","text":"<p>Purpose: Tracks campaign milestone dates and project management timelines</p> MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID Primary key conversion <code>group_id</code> <code>organization_id</code> INT \u2192 UUID Foreign key to organization table <code>feasibility_study_contract_start_date</code> <code>feasibility_study_contract_start_date</code> DATE Feasibility study contract start <code>feasibility_study_contract_sent</code> <code>feasibility_study_contract_sent</code> DATE Contract sent date <code>campaign_contract_start_date</code> <code>campaign_contract_start_date</code> DATE Campaign contract start <code>date_project_summary_brochure_complete</code> <code>date_project_summary_brochure_complete</code> DATE Project summary brochure completion <code>date_project_summary_brochure_posted_to_web</code> <code>date_project_summary_brochure_posted_to_web</code> DATE Brochure web posting date <code>date_printed_alumni_feasibility_survey</code> <code>date_printed_alumni_feasibility_survey</code> DATE Alumni survey printing date <code>date_alumni_feasibility_survey_posted_to_web</code> <code>date_alumni_feasibility_survey_posted_to_web</code> DATE Survey web posting date <code>date_feasibility_website_complete</code> <code>date_feasibility_website_complete</code> DATE Feasibility website completion <code>date_campaign_website_complete</code> <code>date_campaign_website_complete</code> DATE Campaign website completion <code>date_contact_research_complete</code> <code>date_contact_research_complete</code> DATE Contact research completion <code>date_prospect_research_complete</code> <code>date_prospect_research_complete</code> DATE Prospect research completion <code>date_printed_campaign_brochure</code> <code>date_printed_campaign_brochure</code> DATE Campaign brochure printing <code>date_posted_campaign_brochure_to_web</code> <code>date_posted_campaign_brochure_to_web</code> DATE Brochure web posting <code>date_printed_pledge_form</code> <code>date_printed_pledge_form</code> DATE Pledge form printing <code>date_pledge_form_posted_to_web</code> <code>date_pledge_form_posted_to_web</code> DATE Pledge form web posting <code>date_last_campaign_update</code> <code>date_last_campaign_update</code> DATE Last campaign update <code>date_last_volunteer_update</code> <code>date_last_volunteer_update</code> DATE Last volunteer update <code>comments</code> <code>comments</code> TEXT General comments <code>campaign_contract_sent</code> <code>campaign_contract_sent</code> DATE Campaign contract sent date <p>Key Features: - Comprehensive project milestone tracking - Web and print material management - Research completion tracking - Organization-level campaign management</p>"},{"location":"tables/other-tables/#volunteer-management","title":"Volunteer Management","text":""},{"location":"tables/other-tables/#volunteer-table","title":"Volunteer Table","text":"<p>Purpose: Tracks campaign-specific volunteer activities and training</p> MySQL Field PostgreSQL Field Type Change Notes <code>id</code> <code>id</code> INT \u2192 UUID Primary key conversion <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Foreign key to person table <code>campaign_id</code> Campaign linked via context INT \u2192 UUID Campaign-specific volunteer record <code>rank</code> <code>rank</code> SMALLINT Volunteer ranking/level <code>chairman</code> <code>chairman</code> INTEGER Chairman year designation <code>volunteer_date</code> <code>volunteer_date</code> DATE Date volunteered <code>study_training</code> <code>study_training</code> DATE Study training completion date <code>cc_training</code> <code>cc_training</code> DATE CC training completion date <code>sol_pkg_sent</code> <code>sol_pkg_sent</code> DATE Solicitor package sent date <code>pros_pkg</code> <code>pros_pkg</code> DATE Prospect package date <code>comments</code> <code>comments</code> TEXT Volunteer notes and comments <p>Key Features: - Campaign-specific volunteer tracking - Training milestone management - Package distribution tracking - Volunteer ranking system - Unique constraint on (donor_id, campaign_id) to prevent duplicates</p>"},{"location":"tables/other-tables/#recognition-and-awards","title":"Recognition and Awards","text":"<p>Important Note: In the MySQL source system, all recognition data is stored in a single <code>Detail_Frat_Info</code> table. The PostgreSQL target system normalizes this into separate, focused tables for better data integrity and query performance.</p>"},{"location":"tables/other-tables/#hall-of-fame-table","title":"Hall of Fame Table","text":"<p>Purpose: Tracks Hall of Fame nominees and inductees</p> <p>MySQL Source: Part of <code>Detail_Frat_Info</code> table</p> MySQL Field PostgreSQL Field Type Change Notes <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Primary key and foreign key to person <code>hof_hoh_nominee</code> <code>is_nominee</code> BOOLEAN Nominee status <code>hof_hoh_nominee_comment</code> <code>nominee_comment</code> VARCHAR(45) Nominee comments <code>hoh_hof_nominee_date</code> <code>nominee_date</code> DATE Nomination date <code>hof_hoh_inductee</code> <code>is_inductee</code> BOOLEAN Inductee status <code>hof_hoh_inductee_comment</code> <code>inductee_comment</code> VARCHAR(45) Inductee comments <code>hof_hoh_inductee_date</code> <code>inductee_date</code> DATE Induction date <code>hof_hoh_inductee_date_bio_mailed</code> <code>bio_mailed_date</code> DATE Biography mailing date <code>hof_hoh_inductee_date_bio_received</code> <code>bio_received_date</code> DATE Biography received date"},{"location":"tables/other-tables/#man-of-the-year-table","title":"Man of the Year Table","text":"<p>Purpose: Tracks Man of the Year award recipients</p> <p>MySQL Source: Part of <code>Detail_Frat_Info</code> table</p> MySQL Field PostgreSQL Field Type Change Notes <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Primary key and foreign key to person <code>man_of_year</code> <code>is_recipient</code> BOOLEAN Award recipient status <code>man_of_year_comment</code> <code>comment</code> VARCHAR(45) Award comments <code>man_of_year_date</code> <code>award_date</code> DATE Award date"},{"location":"tables/other-tables/#leadership-table","title":"Leadership Table","text":"<p>Purpose: Tracks officer and board member roles</p> <p>MySQL Source: Part of <code>Detail_Frat_Info</code> table</p> MySQL Field PostgreSQL Field Type Change Notes Auto-generated <code>id</code> - \u2192 UUID Primary key (new) <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Foreign key to person <code>officer</code> <code>position_type</code> = 'OFFICER' BOOLEAN \u2192 CHECK Officer role indicator <code>officer_comment</code> <code>comment</code> VARCHAR(45) Position comments <code>officer_start</code> <code>start_year</code> YEAR \u2192 INTEGER Start year <code>officer_end</code> <code>end_year</code> YEAR \u2192 INTEGER End year <code>board_member</code> <code>position_type</code> = 'BOARD_MEMBER' BOOLEAN \u2192 CHECK Board member role indicator <code>board_member_comment</code> <code>comment</code> VARCHAR(45) Position comments <code>board_member_start</code> <code>start_year</code> YEAR \u2192 INTEGER Start year <code>board_member_end</code> <code>end_year</code> YEAR \u2192 INTEGER End year <p>Migration Logic: The single MySQL record with officer and board_member flags creates separate PostgreSQL records when both positions exist.</p>"},{"location":"tables/other-tables/#donor-status-table","title":"Donor Status Table","text":"<p>Purpose: Tracks donor recognition and giving status</p> <p>MySQL Source: Part of <code>Detail_Frat_Info</code> table</p> MySQL Field PostgreSQL Field Type Change Notes <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Primary key and foreign key to person <code>ug_chap_donor</code> <code>is_ug_chapter_donor</code> BOOLEAN Undergraduate chapter donor <code>ug_chap_donor_comment</code> <code>ug_chapter_comment</code> VARCHAR(45) UG chapter donor comments <code>school_donor</code> <code>is_school_donor</code> BOOLEAN School donor status <code>school_donor_comment</code> <code>school_comment</code> VARCHAR(45) School donor comments <code>hq_donor</code> <code>is_hq_donor</code> BOOLEAN Headquarters donor status <code>hq_donor_comment</code> <code>hq_comment</code> VARCHAR(45) HQ donor comments"},{"location":"tables/other-tables/#key-players-table","title":"Key Players Table","text":"<p>Purpose: Identifies key contacts and special roles</p> MySQL Field PostgreSQL Field Type Change Notes <code>donor_id</code> <code>person_id</code> INT \u2192 UUID Primary key and foreign key to person <code>title</code> <code>title</code> VARCHAR(45) \u2192 VARCHAR(100) Role title or designation <code>html</code> Converted to <code>description</code> BOOLEAN \u2192 TEXT HTML flag converted to description field <p>Key Features: - Simple structure focusing on role identification - One key player record per person (primary key constraint) - Title describes the special role or designation - HTML flag in MySQL indicates display formatting preferences</p> <p>Migration Notes: - The MySQL <code>html</code> boolean flag is converted to a more flexible <code>description</code> text field - Primary key constraint ensures one key player record per person - Title field expanded from 45 to 100 characters for better flexibility</p>"},{"location":"tables/other-tables/#data-type-enums","title":"Data Type Enums","text":"<p>The PostgreSQL implementation uses standard types rather than complex enums for most fields, maintaining simplicity and flexibility:</p>"},{"location":"tables/other-tables/#core-data-types-used","title":"Core Data Types Used","text":"<ul> <li>UUID: All primary keys and foreign key references</li> <li>BOOLEAN: Simple true/false flags (loyal, leader, lots_of_money, etc.)</li> <li>SMALLINT: Numeric scores and ratings (-1 to indicate unset/default)</li> <li>INTEGER: Counts, years, and larger numeric values</li> <li>NUMERIC(18,2): Monetary amounts and precise decimal values</li> <li>VARCHAR(n): Text fields with specific length limits</li> <li>TEXT: Longer text content and comments</li> <li>DATE: Date values without time components</li> <li>TIMESTAMP: Full date and time with timezone support</li> </ul>"},{"location":"tables/other-tables/#mysql-to-postgresql-type-mappings","title":"MySQL to PostgreSQL Type Mappings","text":"<ul> <li><code>tinyint(1)</code> \u2192 <code>BOOLEAN</code> (0/1 values become true/false)</li> <li><code>tinyint(3)</code> \u2192 <code>SMALLINT</code> (small numeric values)</li> <li><code>int(10)</code> \u2192 <code>INTEGER</code> or <code>UUID</code> (depending on usage)</li> <li><code>double</code> \u2192 <code>NUMERIC(18,2)</code> (precise decimal arithmetic)</li> <li><code>varchar(n)</code> \u2192 <code>VARCHAR(n)</code> (text with length limits)</li> <li><code>text</code> \u2192 <code>TEXT</code> (unlimited text)</li> <li><code>date</code> \u2192 <code>DATE</code> (date only)</li> <li><code>timestamp</code> \u2192 <code>TIMESTAMP</code> (date and time)</li> <li><code>year(4)</code> \u2192 <code>INTEGER</code> (year values as integers)</li> </ul>"},{"location":"tables/other-tables/#common-queries","title":"Common Queries","text":""},{"location":"tables/other-tables/#prospect-analysis-by-wealth-indicators","title":"Prospect Analysis by Wealth Indicators","text":"<pre><code>-- Analyze prospects by wealth scoring and capacity\nSELECT\n    p.first_name,\n    p.last_name,\n    pr.loyal,\n    pr.leader,\n    pr.lots_of_money,\n    pr.wealth_score,\n    pr.capacity_to_give,\n    pr.networth,\n    pr.income,\n    pr.ask,\n    pr.range_start,\n    pr.range_end\nFROM prospect pr\nJOIN person p ON pr.person_id = p.id\nWHERE pr.wealth_score &gt; 5\n   OR pr.lots_of_money = true\n   OR pr.networth &gt; 1000000\nORDER BY pr.wealth_score DESC, pr.networth DESC;\n</code></pre>"},{"location":"tables/other-tables/#volunteer-training-status-report","title":"Volunteer Training Status Report","text":"<pre><code>-- Track volunteer training completion across campaigns\nSELECT\n    p.first_name,\n    p.last_name,\n    v.volunteer_date,\n    v.study_training,\n    v.cc_training,\n    v.sol_pkg_sent,\n    v.chairman,\n    v.rank,\n    CASE\n        WHEN v.study_training IS NOT NULL AND v.cc_training IS NOT NULL\n        THEN 'Fully Trained'\n        WHEN v.study_training IS NOT NULL\n        THEN 'Study Training Only'\n        WHEN v.cc_training IS NOT NULL\n        THEN 'CC Training Only'\n        ELSE 'No Training'\n    END as training_status\nFROM volunteer v\nJOIN person p ON v.person_id = p.id\nORDER BY v.volunteer_date DESC, p.last_name;\n</code></pre>"},{"location":"tables/other-tables/#recognition-summary-report","title":"Recognition Summary Report","text":"<pre><code>-- Comprehensive recognition status across all categories\nSELECT\n    p.first_name,\n    p.last_name,\n    hof.is_nominee as hof_nominee,\n    hof.is_inductee as hof_inductee,\n    hof.inductee_date as hof_date,\n    moy.is_recipient as man_of_year,\n    moy.award_date as moy_date,\n    l.position_type as leadership_position,\n    l.start_year as leadership_start,\n    l.end_year as leadership_end,\n    ds.is_ug_chapter_donor,\n    ds.is_school_donor,\n    ds.is_hq_donor,\n    kp.title as key_player_title\nFROM person p\nLEFT JOIN hall_of_fame hof ON p.id = hof.person_id\nLEFT JOIN man_of_year moy ON p.id = moy.person_id\nLEFT JOIN leadership l ON p.id = l.person_id\nLEFT JOIN donor_status ds ON p.id = ds.person_id\nLEFT JOIN key_players kp ON p.id = kp.person_id\nWHERE hof.person_id IS NOT NULL\n   OR moy.person_id IS NOT NULL\n   OR l.person_id IS NOT NULL\n   OR kp.person_id IS NOT NULL\nORDER BY p.last_name, p.first_name;\n</code></pre>"},{"location":"tables/other-tables/#campaign-milestone-tracking","title":"Campaign Milestone Tracking","text":"<pre><code>-- Track feasibility campaign milestones and completion status\nSELECT\n    o.organization_name,\n    fci.feasibility_study_contract_start_date,\n    fci.feasibility_study_contract_sent,\n    fci.campaign_contract_start_date,\n    fci.date_feasibility_website_complete,\n    fci.date_campaign_website_complete,\n    fci.date_prospect_research_complete,\n    fci.date_last_campaign_update,\n    CASE\n        WHEN fci.date_campaign_website_complete IS NOT NULL\n         AND fci.date_prospect_research_complete IS NOT NULL\n        THEN 'Campaign Ready'\n        WHEN fci.date_feasibility_website_complete IS NOT NULL\n        THEN 'Feasibility Complete'\n        WHEN fci.feasibility_study_contract_start_date IS NOT NULL\n        THEN 'In Progress'\n        ELSE 'Not Started'\n    END as campaign_status\nFROM feasibility_campaign_info fci\nJOIN organization o ON fci.organization_id = o.id\nORDER BY fci.campaign_contract_start_date DESC NULLS LAST;\n</code></pre>"},{"location":"tables/other-tables/#migration-logic-and-data-transformation","title":"Migration Logic and Data Transformation","text":""},{"location":"tables/other-tables/#recognition-table-normalization-strategy","title":"Recognition Table Normalization Strategy","text":"<p>The most complex aspect of this migration is handling the <code>Detail_Frat_Info</code> table from MySQL, which stores all recognition data in a single denormalized table. The PostgreSQL target system normalizes this into separate tables for better data integrity.</p>"},{"location":"tables/other-tables/#mysql-source-structure","title":"MySQL Source Structure","text":"<pre><code>-- Single table with boolean flags for different recognition types\nCREATE TABLE Detail_Frat_Info (\n    donor_id INT,\n    hof_hoh_nominee BOOLEAN,\n    hof_hoh_nominee_comment VARCHAR(45),\n    hof_hoh_inductee BOOLEAN,\n    hof_hoh_inductee_comment VARCHAR(45),\n    man_of_year BOOLEAN,\n    man_of_year_comment VARCHAR(45),\n    officer BOOLEAN,\n    officer_comment VARCHAR(45),\n    board_member BOOLEAN,\n    board_member_comment VARCHAR(45),\n    -- ... other fields\n);\n</code></pre>"},{"location":"tables/other-tables/#postgresql-target-structure","title":"PostgreSQL Target Structure","text":"<pre><code>-- Separate normalized tables\nCREATE TABLE hall_of_fame (\n    person_id UUID PRIMARY KEY,\n    is_nominee BOOLEAN,\n    nominee_comment VARCHAR(45),\n    -- ... other hof fields\n);\n\nCREATE TABLE man_of_year (\n    person_id UUID PRIMARY KEY,\n    is_recipient BOOLEAN,\n    comment VARCHAR(45),\n    -- ... other moy fields\n);\n\nCREATE TABLE leadership (\n    id UUID PRIMARY KEY,\n    person_id UUID,\n    position_type VARCHAR(20) CHECK (position_type IN ('OFFICER', 'BOARD_MEMBER')),\n    -- ... other leadership fields\n);\n</code></pre>"},{"location":"tables/other-tables/#migration-transformation-logic","title":"Migration Transformation Logic","text":"<pre><code>// Pseudo-code for recognition data migration\nfunc migrateRecognitionData(mysqlRecord DetailFratInfo) error {\n    personID := convertToUUID(mysqlRecord.DonorID)\n\n    // Migrate Hall of Fame data if any HOF fields are set\n    if mysqlRecord.HofHohNominee || mysqlRecord.HofHohInductee {\n        hofRecord := HallOfFame{\n            PersonID: personID,\n            IsNominee: mysqlRecord.HofHohNominee,\n            NomineeComment: mysqlRecord.HofHohNomineeComment,\n            IsInductee: mysqlRecord.HofHohInductee,\n            InducteeComment: mysqlRecord.HofHohInducteeComment,\n            // ... other fields\n        }\n        insertHallOfFameRecord(hofRecord)\n    }\n\n    // Migrate Man of Year data if set\n    if mysqlRecord.ManOfYear {\n        moyRecord := ManOfYear{\n            PersonID: personID,\n            IsRecipient: mysqlRecord.ManOfYear,\n            Comment: mysqlRecord.ManOfYearComment,\n            // ... other fields\n        }\n        insertManOfYearRecord(moyRecord)\n    }\n\n    // Migrate leadership data - create separate records for officer and board member\n    if mysqlRecord.Officer {\n        leadershipRecord := Leadership{\n            ID: generateUUID(),\n            PersonID: personID,\n            PositionType: \"OFFICER\",\n            Comment: mysqlRecord.OfficerComment,\n            StartYear: mysqlRecord.OfficerStart,\n            EndYear: mysqlRecord.OfficerEnd,\n        }\n        insertLeadershipRecord(leadershipRecord)\n    }\n\n    if mysqlRecord.BoardMember {\n        leadershipRecord := Leadership{\n            ID: generateUUID(),\n            PersonID: personID,\n            PositionType: \"BOARD_MEMBER\",\n            Comment: mysqlRecord.BoardMemberComment,\n            StartYear: mysqlRecord.BoardMemberStart,\n            EndYear: mysqlRecord.BoardMemberEnd,\n        }\n        insertLeadershipRecord(leadershipRecord)\n    }\n\n    return nil\n}\n</code></pre>"},{"location":"tables/other-tables/#prospect-data-migration-strategy","title":"Prospect Data Migration Strategy","text":""},{"location":"tables/other-tables/#wealth-scoring-system-migration","title":"Wealth Scoring System Migration","text":"<pre><code>-- MySQL prospect data with various scoring systems\n-- Map MySQL tinyint(-1) defaults to PostgreSQL SMALLINT with proper null handling\nUPDATE prospect SET\n    study_action = CASE WHEN study_action = -1 THEN NULL ELSE study_action END,\n    study_status = CASE WHEN study_status = -1 THEN NULL ELSE study_status END,\n    willingness = CASE WHEN willingness = -1 THEN NULL ELSE willingness END,\n    donor_score = CASE WHEN donor_score = -1 THEN NULL ELSE donor_score END,\n    ds_rating = CASE WHEN ds_rating = -1 THEN NULL ELSE ds_rating END;\n</code></pre>"},{"location":"tables/other-tables/#campaign-context-migration","title":"Campaign Context Migration","text":"<pre><code>-- Link prospects to campaigns via organization relationships\n-- MySQL stores campaign_id directly, PostgreSQL infers from organization context\nWITH campaign_mapping AS (\n    SELECT\n        p.id as prospect_id,\n        p.person_id,\n        o.current_campaign_id\n    FROM prospect p\n    JOIN person pe ON p.person_id = pe.id\n    JOIN person_organization po ON pe.id = po.person_id\n    JOIN organization o ON po.organization_id = o.id\n    WHERE o.current_campaign_id IS NOT NULL\n)\nUPDATE prospect p\nSET campaign_context = cm.current_campaign_id\nFROM campaign_mapping cm\nWHERE p.id = cm.prospect_id;\n</code></pre>"},{"location":"tables/other-tables/#volunteer-data-migration-strategy","title":"Volunteer Data Migration Strategy","text":""},{"location":"tables/other-tables/#training-date-migration","title":"Training Date Migration","text":"<pre><code>-- Migrate training dates with proper null handling\n-- MySQL uses '0000-00-00' for unset dates, PostgreSQL uses NULL\nUPDATE volunteer SET\n    study_training = CASE\n        WHEN study_training = '0000-00-00' THEN NULL\n        ELSE study_training\n    END,\n    cc_training = CASE\n        WHEN cc_training = '0000-00-00' THEN NULL\n        ELSE cc_training\n    END,\n    sol_pkg_sent = CASE\n        WHEN sol_pkg_sent = '0000-00-00' THEN NULL\n        ELSE sol_pkg_sent\n    END;\n</code></pre>"},{"location":"tables/other-tables/#data-validation-and-integrity-checks","title":"Data Validation and Integrity Checks","text":""},{"location":"tables/other-tables/#pre-migration-validation","title":"Pre-Migration Validation","text":"<pre><code>-- Validate person references exist before migration\nSELECT\n    'prospect' as source_table,\n    COUNT(*) as total_records,\n    COUNT(CASE WHEN donor_id NOT IN (SELECT id FROM person) THEN 1 END) as invalid_refs\nFROM mysql_prospect\nUNION ALL\nSELECT\n    'volunteer',\n    COUNT(*),\n    COUNT(CASE WHEN donor_id NOT IN (SELECT id FROM person) THEN 1 END)\nFROM mysql_volunteer\nUNION ALL\nSELECT\n    'detail_frat_info',\n    COUNT(*),\n    COUNT(CASE WHEN donor_id NOT IN (SELECT id FROM person) THEN 1 END)\nFROM mysql_detail_frat_info;\n</code></pre>"},{"location":"tables/other-tables/#post-migration-validation","title":"Post-Migration Validation","text":"<p><pre><code>-- Verify migration completeness\nWITH migration_stats AS (\n    SELECT\n        'prospect' as table_name,\n        (SELECT COUNT(*) FROM mysql_prospect) as source_count,\n        (SELECT COUNT(*) FROM prospect) as target_count\n    UNION ALL\n    SELECT\n        'volunteer',\n        (SELECT COUNT(*) FROM mysql_volunteer),\n        (SELECT COUNT(*) FROM volunteer)\n    UNION ALL\n    SELECT\n        'hall_of_fame',\n        (SELECT COUNT(*) FROM mysql_detail_frat_info WHERE hof_hoh_nominee = 1 OR hof_hoh_inductee = 1),\n        (SELECT COUNT(*) FROM hall_of_fame)\n    UNION ALL\n    SELECT\n        'man_of_year',\n        (SELECT COUNT(*) FROM mysql_detail_frat_info WHERE man_of_year = 1),\n        (SELECT COUNT(*) FROM man_of_year)\n)\nSELECT\n    table_name,\n    source_count,\n    target_count,\n    CASE\n        WHEN source_count = target_count THEN 'PASS'\n        ELSE 'FAIL'\n    END as migration_status,\n    ABS(source_count - target_count) as record_difference\nFROM migration_stats;\n\n## Migration Best Practices\n\n### Data Quality Improvements\n\n1. **Relationship Validation**\n   ```sql\n   -- Ensure all person references exist\n   SELECT table_name, COUNT(*) as orphaned_records\n   FROM (\n       SELECT 'prospect' as table_name FROM prospect p\n       LEFT JOIN person pe ON p.person_id = pe.id WHERE pe.id IS NULL\n       UNION ALL\n       SELECT 'volunteer' FROM volunteer v\n       LEFT JOIN person pe ON v.person_id = pe.id WHERE pe.id IS NULL\n       -- Add similar checks for other tables\n   ) validation\n   GROUP BY table_name;\n   ```\n\n2. **Date Consistency Checks**\n   ```sql\n   -- Check for future dates in historical records\n   SELECT 'prospect' as table_name, COUNT(*) as future_dates\n   FROM prospect WHERE last_contact_date &gt; CURRENT_DATE\n   UNION ALL\n   SELECT 'volunteer', COUNT(*)\n   FROM volunteer WHERE start_date &gt; CURRENT_DATE;\n   ```\n\n3. **Enum Value Validation**\n   ```sql\n   -- Verify enum values are properly mapped\n   SELECT 'prospect_rating', prospect_rating, COUNT(*)\n   FROM prospect GROUP BY prospect_rating\n   UNION ALL\n   SELECT 'volunteer_type', volunteer_type::text, COUNT(*)\n   FROM volunteer GROUP BY volunteer_type;\n   ```\n\n### Performance Optimization\n\n1. **Indexes for Common Queries**\n   ```sql\n   -- Campaign prospect analysis indexes\n   CREATE INDEX idx_prospect_campaign_status ON prospect(campaign_id, prospect_status);\n   CREATE INDEX idx_prospect_likelihood ON prospect(likelihood_score);\n\n   -- Volunteer tracking indexes\n   CREATE INDEX idx_volunteer_active ON volunteer(is_active);\n   CREATE INDEX idx_volunteer_hours ON volunteer(total_hours);\n\n   -- Recognition indexes\n   CREATE INDEX idx_hall_of_fame_year ON hall_of_fame(induction_year);\n   CREATE INDEX idx_man_of_year_year ON man_of_year(award_year);\n\n   -- Key player analysis indexes\n   CREATE INDEX idx_key_players_active ON key_players(is_active);\n   CREATE INDEX idx_key_players_influence ON key_players(influence_level, engagement_score);\n   ```\n\n2. **Performance Views**\n   ```sql\n   -- Active volunteer summary\n   CREATE VIEW active_volunteers AS\n   SELECT\n       p.id,\n       p.first_name,\n       p.last_name,\n       v.volunteer_type,\n       v.total_hours,\n       v.recognition_level\n   FROM volunteer v\n   JOIN person p ON v.person_id = p.id\n   WHERE v.is_active = true;\n\n   -- Campaign prospect summary\n   CREATE VIEW campaign_prospects AS\n   SELECT\n       c.id as campaign_id,\n       c.campaign_name,\n       COUNT(*) as prospect_count,\n       SUM(p.estimated_amount) as total_estimated,\n       AVG(p.likelihood_score) as avg_likelihood\n   FROM prospect p\n   JOIN campaign c ON p.campaign_id = c.id\n   GROUP BY c.id, c.campaign_name;\n   ```\n\n## Troubleshooting Guide\n\n### Common Migration Issues\n\n#### 1. Recognition Data Normalization Errors\n\n**Issue**: Duplicate key violations when migrating `Detail_Frat_Info` table\n</code></pre> ERROR: duplicate key value violates unique constraint \"hall_of_fame_pkey\" <pre><code>**Cause**: Multiple MySQL records for the same person with different recognition flags set\n\n**Solution**:\n```sql\n-- Consolidate recognition data before migration\nWITH consolidated_recognition AS (\n    SELECT\n        donor_id,\n        BOOL_OR(hof_hoh_nominee) as hof_nominee,\n        BOOL_OR(hof_hoh_inductee) as hof_inductee,\n        BOOL_OR(man_of_year) as man_of_year,\n        BOOL_OR(officer) as officer,\n        BOOL_OR(board_member) as board_member,\n        -- Combine comments with separator\n        STRING_AGG(DISTINCT hof_hoh_nominee_comment, '; ') as hof_comments,\n        STRING_AGG(DISTINCT man_of_year_comment, '; ') as moy_comments\n    FROM mysql_detail_frat_info\n    GROUP BY donor_id\n)\n-- Use consolidated data for migration\n</code></pre></p>"},{"location":"tables/other-tables/#2-prospect-wealth-score-migration-issues","title":"2. Prospect Wealth Score Migration Issues","text":"<p>Issue: Invalid wealth score values causing check constraint violations <pre><code>ERROR: new row for relation \"prospect\" violates check constraint \"valid_wealth_score\"\n</code></pre></p> <p>Cause: MySQL allows out-of-range values that PostgreSQL constraints reject</p> <p>Solution: <pre><code>-- Clean invalid scores before migration\nUPDATE mysql_prospect SET\n    wealth_score = CASE\n        WHEN wealth_score &lt; 0 OR wealth_score &gt; 10 THEN NULL\n        ELSE wealth_score\n    END,\n    donor_score = CASE\n        WHEN donor_score &lt; -1 OR donor_score &gt; 10 THEN -1\n        ELSE donor_score\n    END,\n    capacity_to_give = CASE\n        WHEN capacity_to_give &lt; 0 OR capacity_to_give &gt; 10 THEN NULL\n        ELSE capacity_to_give\n    END;\n</code></pre></p>"},{"location":"tables/other-tables/#3-volunteer-training-date-issues","title":"3. Volunteer Training Date Issues","text":"<p>Issue: Invalid date formats causing migration failures <pre><code>ERROR: invalid input syntax for type date: \"0000-00-00\"\n</code></pre></p> <p>Cause: MySQL zero dates not supported in PostgreSQL</p> <p>Solution: <pre><code>-- Convert zero dates to NULL before migration\nUPDATE mysql_volunteer SET\n    study_training = CASE WHEN study_training = '0000-00-00' THEN NULL ELSE study_training END,\n    cc_training = CASE WHEN cc_training = '0000-00-00' THEN NULL ELSE cc_training END,\n    sol_pkg_sent = CASE WHEN sol_pkg_sent = '0000-00-00' THEN NULL ELSE sol_pkg_sent END,\n    pros_pkg = CASE WHEN pros_pkg = '0000-00-00' THEN NULL ELSE pros_pkg END;\n</code></pre></p>"},{"location":"tables/other-tables/#4-foreign-key-reference-failures","title":"4. Foreign Key Reference Failures","text":"<p>Issue: Orphaned records causing foreign key constraint violations <pre><code>ERROR: insert or update on table \"prospect\" violates foreign key constraint \"prospect_person_id_fkey\"\n</code></pre></p> <p>Cause: References to non-existent person records</p> <p>Solution: <pre><code>-- Identify and resolve orphaned records\nWITH orphaned_prospects AS (\n    SELECT p.*\n    FROM mysql_prospect p\n    LEFT JOIN person pe ON p.donor_id = pe.mysql_id\n    WHERE pe.id IS NULL\n)\n-- Option 1: Skip orphaned records\nDELETE FROM mysql_prospect WHERE id IN (SELECT id FROM orphaned_prospects);\n\n-- Option 2: Create placeholder person records\nINSERT INTO person (id, first_name, last_name, mysql_id)\nSELECT\n    gen_random_uuid(),\n    'Unknown',\n    'Person_' || donor_id,\n    donor_id\nFROM orphaned_prospects;\n</code></pre></p>"},{"location":"tables/other-tables/#5-leadership-position-duplication","title":"5. Leadership Position Duplication","text":"<p>Issue: Multiple leadership records for same person and position type <pre><code>ERROR: duplicate key value violates unique constraint \"leadership_person_position_unique\"\n</code></pre></p> <p>Cause: Overlapping officer and board member terms in MySQL</p> <p>Solution: <pre><code>-- Merge overlapping leadership terms\nWITH leadership_consolidated AS (\n    SELECT\n        donor_id,\n        'OFFICER' as position_type,\n        MIN(officer_start) as start_year,\n        MAX(officer_end) as end_year,\n        STRING_AGG(DISTINCT officer_comment, '; ') as comments\n    FROM mysql_detail_frat_info\n    WHERE officer = 1\n    GROUP BY donor_id\n\n    UNION ALL\n\n    SELECT\n        donor_id,\n        'BOARD_MEMBER',\n        MIN(board_member_start),\n        MAX(board_member_end),\n        STRING_AGG(DISTINCT board_member_comment, '; ')\n    FROM mysql_detail_frat_info\n    WHERE board_member = 1\n    GROUP BY donor_id\n)\n-- Use consolidated data for leadership migration\n</code></pre></p>"},{"location":"tables/other-tables/#data-quality-validation-scripts","title":"Data Quality Validation Scripts","text":""},{"location":"tables/other-tables/#pre-migration-health-check","title":"Pre-Migration Health Check","text":"<pre><code>-- Comprehensive pre-migration validation\nWITH validation_results AS (\n    -- Check for invalid person references\n    SELECT\n        'Invalid person references in prospect' as check_name,\n        COUNT(*) as issue_count,\n        'HIGH' as severity\n    FROM mysql_prospect p\n    LEFT JOIN person pe ON p.donor_id = pe.mysql_id\n    WHERE pe.id IS NULL\n\n    UNION ALL\n\n    -- Check for zero dates\n    SELECT\n        'Zero dates in volunteer table',\n        COUNT(*),\n        'MEDIUM'\n    FROM mysql_volunteer\n    WHERE study_training = '0000-00-00'\n       OR cc_training = '0000-00-00'\n       OR sol_pkg_sent = '0000-00-00'\n\n    UNION ALL\n\n    -- Check for out-of-range scores\n    SELECT\n        'Invalid wealth scores in prospect',\n        COUNT(*),\n        'MEDIUM'\n    FROM mysql_prospect\n    WHERE wealth_score &lt; 0 OR wealth_score &gt; 10\n       OR donor_score &lt; -1 OR donor_score &gt; 10\n\n    UNION ALL\n\n    -- Check for duplicate recognition records\n    SELECT\n        'Duplicate recognition records',\n        COUNT(*) - COUNT(DISTINCT donor_id),\n        'LOW'\n    FROM mysql_detail_frat_info\n)\nSELECT\n    check_name,\n    issue_count,\n    severity,\n    CASE\n        WHEN issue_count = 0 THEN 'PASS'\n        WHEN severity = 'HIGH' AND issue_count &gt; 0 THEN 'CRITICAL - FIX REQUIRED'\n        WHEN severity = 'MEDIUM' AND issue_count &gt; 0 THEN 'WARNING - REVIEW NEEDED'\n        ELSE 'INFO - MINOR ISSUES'\n    END as status\nFROM validation_results\nORDER BY\n    CASE severity WHEN 'HIGH' THEN 1 WHEN 'MEDIUM' THEN 2 ELSE 3 END,\n    issue_count DESC;\n</code></pre>"},{"location":"tables/other-tables/#post-migration-verification","title":"Post-Migration Verification","text":"<pre><code>-- Verify migration completeness and accuracy\nWITH migration_summary AS (\n    SELECT\n        'prospect' as table_name,\n        (SELECT COUNT(*) FROM mysql_prospect) as source_records,\n        (SELECT COUNT(*) FROM prospect) as migrated_records,\n        (SELECT COUNT(*) FROM prospect WHERE wealth_score IS NOT NULL) as wealth_scored_records\n\n    UNION ALL\n\n    SELECT\n        'volunteer',\n        (SELECT COUNT(*) FROM mysql_volunteer),\n        (SELECT COUNT(*) FROM volunteer),\n        (SELECT COUNT(*) FROM volunteer WHERE study_training IS NOT NULL OR cc_training IS NOT NULL) as trained_volunteers\n\n    UNION ALL\n\n    SELECT\n        'hall_of_fame',\n        (SELECT COUNT(*) FROM mysql_detail_frat_info WHERE hof_hoh_nominee = 1 OR hof_hoh_inductee = 1),\n        (SELECT COUNT(*) FROM hall_of_fame),\n        (SELECT COUNT(*) FROM hall_of_fame WHERE is_inductee = true) as inductees\n\n    UNION ALL\n\n    SELECT\n        'leadership',\n        (SELECT COUNT(*) FROM mysql_detail_frat_info WHERE officer = 1) +\n        (SELECT COUNT(*) FROM mysql_detail_frat_info WHERE board_member = 1),\n        (SELECT COUNT(*) FROM leadership),\n        (SELECT COUNT(DISTINCT person_id) FROM leadership) as unique_leaders\n)\nSELECT\n    table_name,\n    source_records,\n    migrated_records,\n    ROUND((migrated_records::NUMERIC / source_records * 100), 2) as migration_percentage,\n    migrated_records - source_records as record_difference,\n    CASE\n        WHEN migrated_records = source_records THEN 'PERFECT'\n        WHEN migrated_records &gt; source_records * 0.95 THEN 'GOOD'\n        WHEN migrated_records &gt; source_records * 0.90 THEN 'ACCEPTABLE'\n        ELSE 'NEEDS_REVIEW'\n    END as migration_quality\nFROM migration_summary\nORDER BY migration_percentage DESC;\n</code></pre>"},{"location":"tables/other-tables/#performance-optimization","title":"Performance Optimization","text":""},{"location":"tables/other-tables/#index-strategy-for-large-tables","title":"Index Strategy for Large Tables","text":"<pre><code>-- Essential indexes for prospect table (largest table)\nCREATE INDEX CONCURRENTLY idx_prospect_person_wealth\nON prospect(person_id, wealth_score DESC, networth DESC);\n\nCREATE INDEX CONCURRENTLY idx_prospect_campaign_status\nON prospect(campaign_context, campaign_status);\n\nCREATE INDEX CONCURRENTLY idx_prospect_solicitor_status\nON prospect(solicitor, campaign_status)\nWHERE solicitor IS NOT NULL;\n\n-- Volunteer tracking indexes\nCREATE INDEX CONCURRENTLY idx_volunteer_training_status\nON volunteer(study_training, cc_training)\nWHERE study_training IS NOT NULL OR cc_training IS NOT NULL;\n\n-- Recognition query optimization\nCREATE INDEX CONCURRENTLY idx_leadership_active_positions\nON leadership(person_id, position_type, start_year, end_year);\n</code></pre>"},{"location":"tables/other-tables/#partitioning-strategy-for-large-datasets","title":"Partitioning Strategy for Large Datasets","text":"<pre><code>-- Partition prospect table by campaign for large organizations\nCREATE TABLE prospect_partitioned (\n    LIKE prospect INCLUDING ALL\n) PARTITION BY HASH (campaign_context);\n\n-- Create partitions\nCREATE TABLE prospect_partition_0 PARTITION OF prospect_partitioned\nFOR VALUES WITH (modulus 4, remainder 0);\n\nCREATE TABLE prospect_partition_1 PARTITION OF prospect_partitioned\nFOR VALUES WITH (modulus 4, remainder 1);\n\n-- Continue for all partitions...\n</code></pre> <p>This comprehensive troubleshooting guide addresses the most common issues encountered during the migration of these specialized tables and provides practical solutions for data quality and performance optimization.</p> <p>This comprehensive migration of specialized tables ensures robust tracking of campaign prospects, volunteer activities, recognition programs, and key donor relationships while maintaining data integrity and improving reporting capabilities.</p>"},{"location":"tables/person/","title":"Person Table Migration","text":""},{"location":"tables/person/#overview","title":"Overview","text":"<p>The <code>person</code> table migration is one of the most critical components of the schema transformation, as nearly every other table references person records through foreign keys.</p>"},{"location":"tables/person/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/person/#mysql-source-table-donor","title":"MySQL Source Table: <code>Donor</code>","text":"<pre><code>CREATE TABLE `Donor` (\n  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,\n  `staff` varchar(45) DEFAULT NULL,\n  `full_name` varchar(255) DEFAULT NULL,\n  `first_name` varchar(45) DEFAULT NULL,\n  `last_name` varchar(45) NOT NULL DEFAULT '',\n  `dob` date DEFAULT NULL,\n  `dod` date DEFAULT NULL,\n  `last_changed` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),\n  `color_code` char(6) DEFAULT NULL,\n  `showdir` tinyint(1) DEFAULT 1,\n  `passwd` varchar(45) DEFAULT NULL,\n  `maiden_name` varchar(45) DEFAULT NULL,\n  `twitter` varchar(15) DEFAULT NULL,\n  `linkedin` varchar(45) DEFAULT NULL,\n  `facebook` varchar(45) DEFAULT NULL,\n  `instagram` varchar(45) DEFAULT NULL,\n  `preferred_contact_email` tinyint(1) DEFAULT 1,\n  `preferred_contact_phone` tinyint(1) DEFAULT 1,\n  `preferred_contact_text` tinyint(1) DEFAULT 1,\n  `nickname` varchar(45) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n);\n</code></pre> <p>Note: Additional person-related fields are stored in related tables:</p> <ul> <li>Status and person code information: <code>General_Frat_Info</code> table</li> <li>Address information: <code>Address</code> table</li> <li>Email addresses: <code>Email</code> table</li> <li>Phone numbers: <code>Phone</code> table</li> <li>Employment information: <code>Job</code> table</li> <li>Family information: <code>Family</code> table</li> <li>Education information: <code>Schools</code> table</li> <li>Recognition information: <code>Detail_Frat_Info</code> table</li> </ul>"},{"location":"tables/person/#postgresql-target-table-person","title":"PostgreSQL Target Table: <code>person</code>","text":"<pre><code>CREATE TABLE person (\n    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n    organization_id UUID NOT NULL REFERENCES organization(id) ON DELETE CASCADE,\n    staff TEXT,\n    full_name TEXT,\n    first_name TEXT,\n    last_name TEXT NOT NULL,\n    display_name TEXT NOT NULL,\n    date_of_birth DATE,\n    date_of_death DATE,\n    color_code CHAR(6),\n    show_dir BOOLEAN DEFAULT TRUE,\n    maiden_name VARCHAR(45),\n    nickname VARCHAR(45),\n    in_chapter BOOLEAN NOT NULL DEFAULT FALSE,\n    chapter TEXT,\n    pin VARCHAR(45),\n    initiation_date DATE,\n    status person_status_enum NOT NULL DEFAULT 'Active',\n    code person_code_enum NOT NULL DEFAULT 'Alumni',\n    involvement_comments TEXT,\n    graduation_date DATE,\n    created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n</code></pre> <ul> <li>The <code>dob</code> column is now <code>date_of_birth</code>.</li> <li>The <code>dod</code> column is now <code>date_of_death</code>.</li> </ul>"},{"location":"tables/person/#person-status","title":"Person Status","text":"<pre><code>CREATE TYPE person_status_enum AS ENUM (\n    'Active',\n    'In-active',\n    'Lost',\n    'Deceased'\n);\n</code></pre> <p>Maps from MySQL <code>General_Frat_Info.mstatus</code>:</p> <ul> <li>'A' \u2192 'Active'</li> <li>'I' \u2192 'In-active'</li> <li>'L' \u2192 'Lost'</li> <li>'D' \u2192 'Deceased'</li> </ul>"},{"location":"tables/person/#person-code","title":"Person Code","text":"<pre><code>CREATE TYPE person_code_enum AS ENUM (\n    'Alumni',\n    'Undergrad',\n    'Parent',\n    'Friend',\n    'Alumni/Parent'\n);\n</code></pre> <p>Maps from MySQL <code>General_Frat_Info.mcode</code>:</p> <ul> <li>'A' \u2192 'Alumni'</li> <li>'U' \u2192 'Undergrad'</li> <li>'P' \u2192 'Parent'</li> <li>'F' \u2192 'Friend'</li> <li>'X' \u2192 'Alumni/Parent'rving as the foundation for most other data relationships.</li> </ul>"},{"location":"tables/person/#key-changes-and-improvements","title":"Key Changes and Improvements","text":""},{"location":"tables/person/#1-primary-key-modernization","title":"1. Primary Key Modernization","text":"<p>MySQL: Auto-increment integer <pre><code>id INT AUTO_INCREMENT PRIMARY KEY\n</code></pre></p> <p>PostgreSQL: UUID for better distributed system support <pre><code>id UUID PRIMARY KEY DEFAULT uuid_generate_v4()\n</code></pre></p> <p>Benefits:</p> <ul> <li>Globally unique identifiers</li> <li>Better for distributed systems</li> <li>Enhanced security (non-sequential)</li> <li>Easier data merging and synchronization</li> </ul>"},{"location":"tables/person/#2-table-consolidation","title":"2. Table Consolidation","text":"<p>MySQL: Data spread across multiple tables</p> <ul> <li>Basic info: <code>Donor</code> table</li> <li>Status/membership: <code>General_Frat_Info</code> table</li> <li>Social media: Individual fields in <code>Donor</code></li> <li>Contact preferences: Individual boolean fields in <code>Donor</code></li> </ul> <p>PostgreSQL: Consolidated and normalized structure</p> <ul> <li>Core person data: <code>person</code> table</li> <li>Social media: Dedicated <code>social_media</code> table</li> <li>Contact preferences: Dedicated <code>contact_preferences</code> table</li> </ul>"},{"location":"tables/person/#3-enhanced-data-types","title":"3. Enhanced Data Types","text":""},{"location":"tables/person/#boolean-fields","title":"Boolean Fields","text":"<p>MySQL: <code>TINYINT(1)</code> emulation</p> <pre><code>showdir TINYINT(1) DEFAULT 1,\nin_chapter TINYINT(1) NOT NULL DEFAULT 0,\npreferred_contact_email TINYINT(1) DEFAULT 1\n</code></pre> <p>PostgreSQL: Native boolean type <pre><code>show_dir BOOLEAN DEFAULT TRUE,\nin_chapter BOOLEAN NOT NULL DEFAULT FALSE\n</code></pre></p>"},{"location":"tables/person/#4-organization-relationship","title":"4. Organization Relationship","text":"<p>PostgreSQL adds explicit organization relationship: <pre><code>organization_id UUID NOT NULL REFERENCES organization(id) ON DELETE CASCADE\n</code></pre></p> <p>This provides clear hierarchical structure and multi-tenancy support.</p>"},{"location":"tables/person/#5-display-name-standardization","title":"5. Display Name Standardization","text":"<p>PostgreSQL includes a computed <code>display_name</code> field for consistent name representation across the application.</p>"},{"location":"tables/person/#6-graduation-date-addition","title":"6. Graduation Date Addition","text":"<p>PostgreSQL introduces <code>graduation_date</code> field: <pre><code>graduation_date DATE\n</code></pre></p> <ul> <li>The person's graduation date, if available.</li> <li>Populated from the earliest <code>grad_date</code> in the Schools table for each person.</li> </ul>"},{"location":"tables/person/#8-data-normalization","title":"8. Data Normalization","text":""},{"location":"tables/person/#social-media-extraction","title":"Social Media Extraction","text":"<p>MySQL (embedded in Donor table): <pre><code>twitter VARCHAR(15),\nlinkedin VARCHAR(45),\nfacebook VARCHAR(45),\ninstagram VARCHAR(45)\n</code></pre></p> <p>PostgreSQL (normalized to separate table): <pre><code>-- Separate social_media table\nCREATE TABLE social_media (\n    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n    person_id UUID NOT NULL REFERENCES person(id) ON DELETE CASCADE,\n    twitter VARCHAR(15),\n    linkedin VARCHAR(45),\n    facebook VARCHAR(45),\n    instagram VARCHAR(45)\n);\n</code></pre></p>"},{"location":"tables/person/#contact-preferences-consolidation","title":"Contact Preferences Consolidation","text":"<p>MySQL (multiple boolean fields): <pre><code>preferred_contact_email TINYINT(1) DEFAULT 1,\npreferred_contact_phone TINYINT(1) DEFAULT 1,\npreferred_contact_text TINYINT(1) DEFAULT 1\n</code></pre></p> <p>PostgreSQL (structured table): <pre><code>-- Dedicated contact_preferences table\nCREATE TABLE contact_preferences (\n    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n    person_id UUID NOT NULL REFERENCES person(id) ON DELETE CASCADE,\n    preferred_contact_method contact_method_enum DEFAULT 'Email',\n    allows_marketing BOOLEAN NOT NULL DEFAULT TRUE,\n    -- ... additional preference fields\n);\n</code></pre></p>"},{"location":"tables/person/#field-mapping-reference","title":"Field Mapping Reference","text":"MySQL Field PostgreSQL Field Type Change Notes <code>Donor.id</code> <code>person.id</code> INT \u2192 UUID Primary key conversion <code>Donor.staff</code> <code>person.staff</code> VARCHAR(45) \u2192 TEXT No change <code>Donor.full_name</code> <code>person.full_name</code> VARCHAR(255) \u2192 TEXT No change <code>Donor.first_name</code> <code>person.first_name</code> VARCHAR(45) \u2192 TEXT No change <code>Donor.last_name</code> <code>person.last_name</code> VARCHAR(45) \u2192 TEXT No change <code>Donor.dob</code> <code>person.date_of_birth</code> DATE \u2192 DATE Renamed <code>Donor.dod</code> <code>person.date_of_death</code> DATE \u2192 DATE Renamed <code>Donor.color_code</code> <code>person.color_code</code> CHAR(6) \u2192 CHAR(6) No change <code>Donor.showdir</code> <code>person.show_dir</code> TINYINT(1) \u2192 BOOLEAN Native boolean type <code>Donor.maiden_name</code> <code>person.maiden_name</code> VARCHAR(45) \u2192 VARCHAR(45) No change <code>Donor.nickname</code> <code>person.nickname</code> VARCHAR(45) \u2192 VARCHAR(45) No change <code>Donor.last_changed</code> <code>person.last_changed</code> TIMESTAMP \u2192 TIMESTAMP No change <code>General_Frat_Info.in_chapter</code> <code>person.in_chapter</code> TINYINT(1) \u2192 BOOLEAN Native boolean, from related table <code>General_Frat_Info.chapter</code> <code>person.chapter</code> VARCHAR(45) \u2192 TEXT From related table <code>General_Frat_Info.pin</code>/<code>pin2</code> <code>person.pin</code> INT/VARCHAR \u2192 VARCHAR(45) Use <code>pin</code> if present, else <code>pin2</code> <code>General_Frat_Info.init_date</code> <code>person.initiation_date</code> DATE \u2192 DATE From related table <code>General_Frat_Info.mstatus</code> <code>person.status</code> ENUM('A','I','L','D') \u2192 person_status_enum Custom enum type, from related table <code>General_Frat_Info.mcode</code> <code>person.code</code> ENUM('A','U','P','F','X') \u2192 person_code_enum Custom enum type, from related table <code>Schools.grad_date</code> <code>person.graduation_date</code> DATE \u2192 DATE Earliest grad_date for donor_id, or NULL if none N/A <code>person.organization_id</code> N/A \u2192 UUID New field, references organization N/A <code>person.display_name</code> N/A \u2192 TEXT New computed field N/A <code>person.involvement_comments</code> N/A \u2192 TEXT New field N/A <code>person.created</code> N/A \u2192 TIMESTAMP New audit field"},{"location":"tables/person/#migration-logic","title":"Migration Logic","text":""},{"location":"tables/person/#1-data-source-and-selection","title":"1. Data Source and Selection","text":"<p>The migration extracts person data from MySQL using a complex join to ensure only valid members are migrated:</p> <pre><code>-- Join Donor with Member and Donor_Group to get organization mapping\nSELECT d.id, d.staff, d.full_name, d.first_name, d.last_name,\n       d.dob, d.dod, d.last_changed, d.color_code, d.showdir,\n       d.maiden_name, d.nickname, dg.id as group_id\nFROM Donor d\nINNER JOIN Member m ON d.id = m.donor_id\nINNER JOIN Donor_Group dg ON m.group_id = dg.id\nWHERE dg.main = 1\n</code></pre>"},{"location":"tables/person/#2-uuid-generation-and-mapping","title":"2. UUID Generation and Mapping","text":"<p>Each MySQL <code>Donor.id</code> is mapped to a new PostgreSQL UUID and stored for reference by other migrations:</p> <pre><code>// Generate new UUID for each person\npersonID := generateUUID()\nm.personMapping.Set(id, personID)  // Store mapping for other migrations\n</code></pre>"},{"location":"tables/person/#3-organization-relationship","title":"3. Organization Relationship","text":"<p>The person is linked to the correct organization using the organization mapping established during the organization migration:</p> <pre><code>// Lookup the correct organization ID from the mapping\norganizationID, exists := m.orgMapping.Get(groupID)\nif !exists {\n    return fmt.Errorf(\"failed to get organization ID for group_id %d\", groupID)\n}\n</code></pre>"},{"location":"tables/person/#4-display-name-generation","title":"4. Display Name Generation","text":"<p>The migration creates a computed <code>display_name</code> field following this priority:</p> <pre><code>var displayName string\nswitch {\ncase fullName.Valid &amp;&amp; fullName.String != \"\":\n    displayName = fullName.String\ncase firstName.Valid &amp;&amp; firstName.String != \"\" &amp;&amp; lastName != \"\":\n    displayName = firstName.String + \" \" + lastName\ncase lastName != \"\":\n    displayName = lastName\ncase firstName.Valid &amp;&amp; firstName.String != \"\":\n    displayName = firstName.String\ndefault:\n    displayName = \"Unknown\"\n}\n</code></pre>"},{"location":"tables/person/#5-default-values-and-type-conversion","title":"5. Default Values and Type Conversion","text":"<p>The migration applies default values and converts MySQL types to PostgreSQL equivalents:</p> <pre><code>// Convert TINYINT(1) to boolean\nshowDirBool := true\nif showDir.Valid {\n    showDirBool = showDir.Bool\n}\n\n// Set defaults for enum fields\nstatus := \"Active\"    // Default person status\ncode := \"Alumni\"      // Default person code\ninChapter := false    // Default in_chapter value\n</code></pre>"},{"location":"tables/person/#6-data-validation-and-cleaning","title":"6. Data Validation and Cleaning","text":"<p>The migration includes comprehensive data validation:</p>"},{"location":"tables/person/#date-validation","title":"Date Validation","text":"<pre><code>// Handle nullable dates\nvar dobPtr *time.Time\nif dob.Valid {\n    dobPtr = &amp;dob.Time\n}\n\nvar dodPtr *time.Time\nif dod.Valid {\n    dodPtr = &amp;dod.Time\n}\n</code></pre>"},{"location":"tables/person/#timestamp-conversion","title":"Timestamp Conversion","text":"<pre><code>// Convert MySQL TIMESTAMP from []byte to time.Time\nvar lastChanged time.Time\nif lastChangedRaw != nil {\n    t, err := time.Parse(\"2006-01-02 15:04:05\", string(lastChangedRaw))\n    if err == nil {\n        lastChanged = t\n    }\n}\n</code></pre>"},{"location":"tables/person/#string-field-handling","title":"String Field Handling","text":"<pre><code>// Handle nullable string fields\nvar staff, fullName, firstName, colorCode, maidenName, nickname *string\nif staff.Valid { staff = &amp;staff.String }\nif fullName.Valid { fullName = &amp;fullName.String }\n// ... similar for other nullable string fields\n</code></pre>"},{"location":"tables/person/#7-data-normalization-process","title":"7. Data Normalization Process","text":"<p>The migration separates embedded data into normalized tables:</p>"},{"location":"tables/person/#social-media-extraction_1","title":"Social Media Extraction","text":"<p>Social media fields from the <code>Donor</code> table are extracted during a separate migration step:</p> <ul> <li><code>twitter</code> \u2192 <code>social_media.twitter</code></li> <li><code>linkedin</code> \u2192 <code>social_media.linkedin</code></li> <li><code>facebook</code> \u2192 <code>social_media.facebook</code></li> <li><code>instagram</code> \u2192 <code>social_media.instagram</code></li> </ul>"},{"location":"tables/person/#contact-preferences-migration","title":"Contact Preferences Migration","text":"<p>Contact preference boolean fields are migrated to a structured <code>contact_preferences</code> table during a separate migration step that:</p> <pre><code>// Determines preferred contact method based on available contact info\npreferredMethod := \"Email\"\nif !emailPersons[personID] &amp;&amp; phonePersons[personID] {\n    preferredMethod = \"Phone\"\n}\n\n// Inserts contact preferences with defaults\nINSERT INTO contact_preferences (\n    person_id, preferred_contact_method, allows_marketing,\n    allows_surveys, allows_political\n) VALUES (personID, preferredMethod, true, true, false)\n</code></pre>"},{"location":"tables/person/#8-conflict-handling-and-data-integrity","title":"8. Conflict Handling and Data Integrity","text":"<p>The migration uses PostgreSQL's conflict resolution to ensure data integrity:</p> <pre><code>INSERT INTO person (...) VALUES (...)\nON CONFLICT (id) DO NOTHING\n</code></pre> <p>This prevents duplicate records during migration reruns while maintaining referential integrity.</p>"},{"location":"tables/person/#indexes-and-performance","title":"Indexes and Performance","text":""},{"location":"tables/person/#primary-indexes","title":"Primary Indexes","text":"<pre><code>-- Primary key (automatic)\nCREATE UNIQUE INDEX person_pkey ON person(id);\n\n-- Essential lookup indexes\nCREATE INDEX idx_person_last_name ON person(last_name);\nCREATE INDEX idx_person_first_name ON person(first_name);\nCREATE INDEX idx_person_full_name ON person(last_name, first_name);\nCREATE INDEX idx_person_display_name ON person(display_name);\n</code></pre>"},{"location":"tables/person/#status-and-code-indexes","title":"Status and Code Indexes","text":"<pre><code>-- Status-based queries\nCREATE INDEX idx_person_status ON person(status);\nCREATE INDEX idx_person_active ON person(status) WHERE status = 'Active';\n\n-- Person code filtering\nCREATE INDEX idx_person_code ON person(code);\n</code></pre>"},{"location":"tables/person/#organization-relationship-index","title":"Organization Relationship Index","text":"<pre><code>-- Organization membership queries\nCREATE INDEX idx_person_organization ON person(organization_id);\n</code></pre>"},{"location":"tables/person/#composite-indexes","title":"Composite Indexes","text":"<pre><code>-- Common query patterns\nCREATE INDEX idx_person_status_code ON person(status, code);\nCREATE INDEX idx_person_name_status ON person(last_name, first_name, status);\nCREATE INDEX idx_person_org_status ON person(organization_id, status);\n</code></pre>"},{"location":"tables/person/#common-queries","title":"Common Queries","text":""},{"location":"tables/person/#basic-person-lookup","title":"Basic Person Lookup","text":"<pre><code>-- Find person by name\nSELECT id, first_name, last_name, status, code\nFROM person\nWHERE last_name ILIKE 'Smith%'\nAND status = 'Active'\nORDER BY last_name, first_name;\n</code></pre>"},{"location":"tables/person/#contact-information-queries","title":"Contact Information Queries","text":"<pre><code>-- Find people with email addresses\nSELECT p.first_name, p.last_name, e.email_address\nFROM person p\nJOIN email_address e ON p.id = e.person_id\nWHERE p.status = 'Active'\nAND e.is_primary = true;\n\n-- Find people with phone numbers\nSELECT p.first_name, p.last_name, ph.phone_number\nFROM person p\nJOIN phone_number ph ON p.id = ph.person_id\nWHERE p.status = 'Active'\nAND ph.is_primary = true;\n</code></pre>"},{"location":"tables/person/#alumni-analysis","title":"Alumni Analysis","text":"<pre><code>-- Alumni statistics by status and code\nSELECT\n    code,\n    status,\n    COUNT(*) as count\nFROM person\nWHERE code IN ('Alumni', 'Alumni/Parent')\nGROUP BY code, status\nORDER BY code, status;\n</code></pre>"},{"location":"tables/person/#organization-membership","title":"Organization Membership","text":"<pre><code>-- People by organization\nSELECT\n    o.title as organization_name,\n    COUNT(*) as member_count,\n    COUNT(*) FILTER (WHERE p.status = 'Active') as active_members\nFROM person p\nJOIN organization o ON p.organization_id = o.id\nGROUP BY o.id, o.title\nORDER BY member_count DESC;\n</code></pre>"},{"location":"tables/person/#age-demographics","title":"Age Demographics","text":"<pre><code>-- Age distribution for active alumni\nSELECT\n    CASE\n        WHEN EXTRACT(YEAR FROM AGE(dob)) &lt; 30 THEN 'Under 30'\n        WHEN EXTRACT(YEAR FROM AGE(dob)) &lt; 50 THEN '30-49'\n        WHEN EXTRACT(YEAR FROM AGE(dob)) &lt; 70 THEN '50-69'\n        ELSE '70+'\n    END as age_group,\n    COUNT(*) as count\nFROM person\nWHERE status = 'Active'\nAND code = 'Alumni'\nAND dob IS NOT NULL\nGROUP BY age_group\nORDER BY age_group;\n</code></pre>"},{"location":"tables/person/#data-quality-improvements","title":"Data Quality Improvements","text":""},{"location":"tables/person/#enhanced-validation","title":"Enhanced Validation","text":"<p>The PostgreSQL schema includes enhanced validation:</p> <pre><code>-- Name requirements\nALTER TABLE person ADD CONSTRAINT person_names_check\nCHECK (\n    LENGTH(TRIM(first_name)) &gt;= 1 AND\n    LENGTH(TRIM(last_name)) &gt;= 1\n);\n\n-- Birth date validation\nALTER TABLE person ADD CONSTRAINT person_birth_date_check\nCHECK (\n    dob IS NULL OR\n    (dob &gt;= '1900-01-01' AND dob &lt;= CURRENT_DATE)\n);\n\n-- Status enum validation (automatically enforced by enum type)\n-- Code enum validation (automatically enforced by enum type)\n</code></pre>"},{"location":"tables/person/#data-standardization","title":"Data Standardization","text":"<p>The migration includes data standardization:</p> <ul> <li>Name Formatting: Proper handling of null/empty names with fallbacks</li> <li>Display Name Generation: Computed field for consistent name representation</li> <li>Boolean Type Conversion: MySQL TINYINT(1) \u2192 PostgreSQL BOOLEAN</li> <li>Date Validation: Invalid date handling with null conversion</li> <li>Enum Type Safety: Strong typing with custom enum types</li> </ul>"},{"location":"tables/person/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/person/#common-migration-issues","title":"Common Migration Issues","text":""},{"location":"tables/person/#1-missing-organization-mapping","title":"1. Missing Organization Mapping","text":"<p>Issue: Person record cannot find corresponding organization Solution: Ensure organization migration completed successfully and organization mapping is available</p>"},{"location":"tables/person/#2-duplicate-person-records","title":"2. Duplicate Person Records","text":"<p>Issue: Multiple donor records with same information Solution: Migration uses <code>ON CONFLICT (id) DO NOTHING</code> to prevent duplicates; manual cleanup may be needed</p>"},{"location":"tables/person/#3-invalid-date-values","title":"3. Invalid Date Values","text":"<p>Issue: MySQL contains invalid dates (0000-00-00) Solution: Migration converts invalid dates to NULL values</p>"},{"location":"tables/person/#4-missing-display-names","title":"4. Missing Display Names","text":"<p>Issue: Records without proper display name generation Solution: Migration has fallback logic: full_name \u2192 first+last \u2192 last \u2192 first \u2192 \"Unknown\"</p>"},{"location":"tables/person/#5-organization-relationship-issues","title":"5. Organization Relationship Issues","text":"<p>Issue: Person records not properly linked to organizations Solution: Verify that Donor_Group.main=1 records exist and organization migration completed</p>"},{"location":"tables/person/#validation-queries","title":"Validation Queries","text":"<pre><code>-- Check for missing required data\nSELECT COUNT(*) as missing_names\nFROM person\nWHERE first_name IS NULL OR first_name = ''\n   OR last_name IS NULL OR last_name = '';\n\n-- Verify enum values\nSELECT status, COUNT(*)\nFROM person\nGROUP BY status;\n\nSELECT code, COUNT(*)\nFROM person\nGROUP BY code;\n\n-- Check organization relationships\nSELECT\n    o.title,\n    COUNT(p.id) as person_count\nFROM organization o\nLEFT JOIN person p ON o.id = p.organization_id\nGROUP BY o.id, o.title\nORDER BY person_count DESC;\n\n-- Verify display name consistency\nSELECT COUNT(*) as missing_display_names\nFROM person\nWHERE display_name IS NULL OR display_name = '';\n</code></pre> <p>The Person table migration forms the foundation of the entire system, providing enhanced data types, better validation, and improved structure while maintaining complete data integrity.</p>"},{"location":"tables/social-media/","title":"Social Media Table Migration","text":"<p>The Social Media table represents the extraction and normalization of social media fields from MySQL's <code>Donor</code> table into a dedicated PostgreSQL <code>social_media</code> table, providing better organization and extensibility for social media platform management.</p>"},{"location":"tables/social-media/#overview","title":"Overview","text":"<p>Social media information that was previously embedded as individual fields in the MySQL <code>Donor</code> table is now properly normalized into a dedicated <code>social_media</code> table. This allows for multiple social media profiles per person and better management of various platforms.</p>"},{"location":"tables/social-media/#schema-transformation","title":"Schema Transformation","text":""},{"location":"tables/social-media/#mysql-source-fields-from-donor-table","title":"MySQL Source Fields (from <code>Donor</code> table)","text":"<pre><code>-- Social media fields embedded in Donor table\ntwitter VARCHAR(15),\nlinkedin VARCHAR(45),\nfacebook VARCHAR(45),\ninstagram VARCHAR(45)\n</code></pre>"},{"location":"tables/social-media/#postgresql-target-table-social_media","title":"PostgreSQL Target Table: <code>social_media</code>","text":"<pre><code>CREATE TABLE IF NOT EXISTS social_media (\n  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),\n  person_id UUID NOT NULL REFERENCES person(id) ON DELETE CASCADE,\n  service social_media_service_enum NOT NULL,\n  custom_service VARCHAR(45), -- Used when service = 'Other'\n  handle VARCHAR(100), -- Username/handle (without @ symbol)\n  display_name VARCHAR(100), -- Display name on the platform\n  profile_url TEXT,\n\n  -- Platform engagement data\n  is_verified BOOLEAN NOT NULL DEFAULT FALSE,\n  is_active BOOLEAN NOT NULL DEFAULT TRUE,\n\n  -- Privacy and contact preferences\n  is_public_profile BOOLEAN NOT NULL DEFAULT TRUE,\n  allows_messaging BOOLEAN NOT NULL DEFAULT TRUE,\n  allows_mentions BOOLEAN NOT NULL DEFAULT TRUE,\n\n  -- Metadata\n  platform_user_id VARCHAR(100), -- Platform's internal user ID\n\n  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n  last_changed TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n\n  -- Constraints\n  CONSTRAINT chk_custom_service_required CHECK (\n    (service != 'Other') OR (service = 'Other' AND custom_service IS NOT NULL)\n  ),\n  CONSTRAINT chk_url_format CHECK (\n    profile_url IS NULL OR profile_url ~ '^https?://'\n  )\n);\n</code></pre>"},{"location":"tables/social-media/#postgresql-social-media-service-enum","title":"PostgreSQL Social Media Service Enum","text":"<pre><code>CREATE TYPE social_media_service_enum AS ENUM (\n  'Facebook', 'Twitter', 'LinkedIn', 'Instagram', 'YouTube', 'TikTok',\n  'Snapchat', 'Pinterest', 'Reddit', 'Discord', 'Mastodon', 'Threads',\n  'WhatsApp', 'Telegram', 'Signal', 'GitHub', 'GitLab', 'Stack Overflow',\n  'Medium', 'Substack', 'Twitch', 'Other'\n);\n    'Snapchat',\n    'Pinterest',\n    'Discord',\n    'Reddit',\n    'Other'\n);\n</code></pre>"},{"location":"tables/social-media/#key-changes-and-improvements","title":"Key Changes and Improvements","text":""},{"location":"tables/social-media/#1-normalization-benefits","title":"1. Normalization Benefits","text":"<p>MySQL: Embedded fields in person table <pre><code>-- Fixed fields in Donor table\ntwitter_handle VARCHAR(50),\nlinkedin_url VARCHAR(255),\nfacebook_url VARCHAR(255),\ninstagram_handle VARCHAR(50)\n</code></pre></p> <p>PostgreSQL: Normalized relationship table <pre><code>-- Separate table with platform flexibility\n-- Multiple platforms per person\n-- Extensible for new platforms\n-- Better data organization\n</code></pre></p>"},{"location":"tables/social-media/#2-enhanced-platform-support","title":"2. Enhanced Platform Support","text":"<p>MySQL: Limited to 4 hardcoded platforms <pre><code>-- Only Twitter, LinkedIn, Facebook, Instagram\n-- No room for new platforms without schema changes\n</code></pre></p> <p>PostgreSQL: Extensible platform system <pre><code>-- Enum supports many platforms\n-- Easy to add new platforms\n-- Consistent data structure across platforms\n</code></pre></p>"},{"location":"tables/social-media/#3-enhanced-metadata","title":"3. Enhanced Metadata","text":"<p>MySQL: Basic URL/handle storage <pre><code>-- Just the handle or URL\n-- No additional metadata\n</code></pre></p> <p>PostgreSQL: Rich metadata support <pre><code>is_public BOOLEAN DEFAULT true,\nis_verified BOOLEAN DEFAULT false,\nfollower_count INTEGER,\nlast_updated TIMESTAMPTZ,\nnotes TEXT\n</code></pre></p>"},{"location":"tables/social-media/#4-data-validation-and-quality","title":"4. Data Validation and Quality","text":"<p>MySQL: No validation <pre><code>-- No constraints on URL format\n-- No handle validation\n</code></pre></p> <p>PostgreSQL: Comprehensive validation <pre><code>-- URL format validation\n-- Handle format validation per platform\n-- Public/private designation\n-- Verification status tracking\n</code></pre></p>"},{"location":"tables/social-media/#migration-logic","title":"Migration Logic","text":""},{"location":"tables/social-media/#1-platform-mapping","title":"1. Platform Mapping","text":"<p>Each MySQL field maps to a specific platform in PostgreSQL:</p> <pre><code>// Go migration logic for platform mapping\nfunc migratePersonSocialMedia(donorID int, donor *MySQLDonor) error {\n    personID, err := mapPersonID(donorID)\n    if err != nil {\n        return err\n    }\n\n    // Migrate Twitter\n    if donor.TwitterHandle != \"\" {\n        err = createSocialMediaRecord(personID, \"Twitter\", donor.TwitterHandle, \"\")\n        if err != nil {\n            return err\n        }\n    }\n\n    // Migrate LinkedIn\n    if donor.LinkedInURL != \"\" {\n        err = createSocialMediaRecord(personID, \"LinkedIn\", \"\", donor.LinkedInURL)\n        if err != nil {\n            return err\n        }\n    }\n\n    // Migrate Facebook\n    if donor.FacebookURL != \"\" {\n        err = createSocialMediaRecord(personID, \"Facebook\", \"\", donor.FacebookURL)\n        if err != nil {\n            return err\n        }\n    }\n\n    // Migrate Instagram\n    if donor.InstagramHandle != \"\" {\n        err = createSocialMediaRecord(personID, \"Instagram\", donor.InstagramHandle, \"\")\n        if err != nil {\n            return err\n        }\n    }\n\n    return nil\n}\n</code></pre>"},{"location":"tables/social-media/#2-handle-vs-url-detection","title":"2. Handle vs URL Detection","text":"<p>The migration intelligently determines whether the data is a handle or URL:</p> <pre><code>func createSocialMediaRecord(personID uuid.UUID, platform, data, url string) error {\n    socialMedia := &amp;SocialMedia{\n        ID:       uuid.New(),\n        PersonID: personID,\n        Platform: platform,\n        IsPublic: true, // Default assumption\n    }\n\n    // Determine if data is a URL or handle\n    if strings.HasPrefix(data, \"http\") || strings.Contains(data, \".com\") {\n        socialMedia.URL = normalizeURL(data)\n        socialMedia.Handle = extractHandleFromURL(data, platform)\n    } else {\n        socialMedia.Handle = normalizeHandle(data, platform)\n        socialMedia.URL = generateURLFromHandle(data, platform)\n    }\n\n    return insertSocialMedia(socialMedia)\n}\n</code></pre>"},{"location":"tables/social-media/#3-url-normalization","title":"3. URL Normalization","text":"<pre><code>func normalizeURL(url string) string {\n    // Ensure proper protocol\n    if !strings.HasPrefix(url, \"http\") {\n        url = \"https://\" + url\n    }\n\n    // Remove trailing slashes\n    url = strings.TrimRight(url, \"/\")\n\n    return url\n}\n\nfunc normalizeHandle(handle, platform string) string {\n    // Remove @ symbols\n    handle = strings.TrimPrefix(handle, \"@\")\n\n    // Platform-specific normalization\n    switch platform {\n    case \"Twitter\":\n        return normalizeTwitterHandle(handle)\n    case \"Instagram\":\n        return normalizeInstagramHandle(handle)\n    case \"LinkedIn\":\n        return normalizeLinkedInHandle(handle)\n    default:\n        return strings.ToLower(strings.TrimSpace(handle))\n    }\n}\n</code></pre>"},{"location":"tables/social-media/#4-url-generation","title":"4. URL Generation","text":"<pre><code>func generateURLFromHandle(handle, platform string) string {\n    baseURLs := map[string]string{\n        \"Twitter\":   \"https://twitter.com/\",\n        \"Instagram\": \"https://instagram.com/\",\n        \"LinkedIn\":  \"https://linkedin.com/in/\",\n        \"Facebook\":  \"https://facebook.com/\",\n        \"YouTube\":   \"https://youtube.com/@\",\n        \"TikTok\":    \"https://tiktok.com/@\",\n    }\n\n    if baseURL, exists := baseURLs[platform]; exists {\n        return baseURL + strings.TrimPrefix(handle, \"@\")\n    }\n\n    return \"\"\n}\n</code></pre>"},{"location":"tables/social-media/#field-mapping-reference","title":"Field Mapping Reference","text":""},{"location":"tables/social-media/#platform-specific-mapping","title":"Platform-Specific Mapping","text":"MySQL Field PostgreSQL Platform Handle/URL Field Notes <code>twitter_handle</code> <code>Twitter</code> <code>handle</code> Twitter username <code>linkedin_url</code> <code>LinkedIn</code> <code>url</code> LinkedIn profile URL <code>facebook_url</code> <code>Facebook</code> <code>url</code> Facebook profile URL <code>instagram_handle</code> <code>Instagram</code> <code>handle</code> Instagram username"},{"location":"tables/social-media/#data-transformation","title":"Data Transformation","text":"MySQL Data Type PostgreSQL Field Type Notes VARCHAR(50) <code>handle</code> VARCHAR(100) Increased capacity VARCHAR(255) <code>url</code> VARCHAR(255) No change N/A <code>platform</code> ENUM Platform identification N/A <code>is_public</code> BOOLEAN Public/private designation N/A <code>is_verified</code> BOOLEAN Verification status N/A <code>follower_count</code> INTEGER Follower tracking N/A <code>last_updated</code> TIMESTAMPTZ Update tracking N/A <code>notes</code> TEXT Additional information"},{"location":"tables/social-media/#indexes-and-performance","title":"Indexes and Performance","text":""},{"location":"tables/social-media/#primary-and-foreign-key-indexes","title":"Primary and Foreign Key Indexes","text":"<pre><code>-- Primary key index (automatic)\nCREATE INDEX CONCURRENTLY IF NOT EXISTS idx_social_media_pkey ON social_media(id);\n\n-- Foreign key index for person lookups\nCREATE INDEX CONCURRENTLY IF NOT EXISTS idx_social_media_person_id ON social_media(person_id);\n\n-- Platform-based queries\nCREATE INDEX CONCURRENTLY IF NOT EXISTS idx_social_media_platform ON social_media(platform);\n\n-- Handle searches\nCREATE INDEX CONCURRENTLY IF NOT EXISTS idx_social_media_handle ON social_media(handle) WHERE handle IS NOT NULL;\n</code></pre>"},{"location":"tables/social-media/#search-and-query-optimization","title":"Search and Query Optimization","text":"<pre><code>-- URL-based searches\nCREATE INDEX CONCURRENTLY IF NOT EXISTS idx_social_media_url ON social_media(url) WHERE url IS NOT NULL;\n\n-- Public profile searches\nCREATE INDEX CONCURRENTLY IF NOT EXISTS idx_social_media_public ON social_media(platform, is_public) WHERE is_public = true;\n\n-- Full-text search for handles and notes\nCREATE INDEX CONCURRENTLY IF NOT EXISTS idx_social_media_search\nON social_media USING GIN(to_tsvector('english', COALESCE(handle, '') || ' ' || COALESCE(notes, '')));\n</code></pre>"},{"location":"tables/social-media/#common-queries","title":"Common Queries","text":""},{"location":"tables/social-media/#person-social-media-profiles","title":"Person Social Media Profiles","text":"<pre><code>-- Get all social media profiles for a person\nSELECT sm.platform, sm.handle, sm.url, sm.is_public, sm.is_verified\nFROM social_media sm\nWHERE sm.person_id = $1\nORDER BY sm.platform;\n\n-- Find people on specific platforms\nSELECT p.first_name, p.last_name, sm.handle, sm.url\nFROM person p\nJOIN social_media sm ON p.id = sm.person_id\nWHERE sm.platform = 'Twitter'\n  AND sm.is_public = true\nORDER BY p.last_name, p.first_name;\n\n-- Count social media presence by platform\nSELECT sm.platform, COUNT(*) as user_count\nFROM social_media sm\nWHERE sm.is_public = true\nGROUP BY sm.platform\nORDER BY user_count DESC;\n</code></pre>"},{"location":"tables/social-media/#search-and-discovery","title":"Search and Discovery","text":"<pre><code>-- Search for social media handles\nSELECT p.first_name, p.last_name, sm.platform, sm.handle\nFROM person p\nJOIN social_media sm ON p.id = sm.person_id\nWHERE sm.handle ILIKE '%smith%'\n  AND sm.is_public = true\nORDER BY sm.platform, sm.handle;\n\n-- Find verified accounts\nSELECT p.first_name, p.last_name, sm.platform, sm.handle, sm.follower_count\nFROM person p\nJOIN social_media sm ON p.id = sm.person_id\nWHERE sm.is_verified = true\nORDER BY sm.follower_count DESC NULLS LAST;\n\n-- Recently updated profiles\nSELECT p.first_name, p.last_name, sm.platform, sm.last_updated\nFROM person p\nJOIN social_media sm ON p.id = sm.person_id\nWHERE sm.last_updated &gt;= NOW() - INTERVAL '30 days'\nORDER BY sm.last_updated DESC;\n</code></pre>"},{"location":"tables/social-media/#platform-analytics","title":"Platform Analytics","text":"<pre><code>-- Social media adoption by platform\nSELECT\n    sm.platform,\n    COUNT(*) as total_profiles,\n    COUNT(CASE WHEN sm.is_public THEN 1 END) as public_profiles,\n    COUNT(CASE WHEN sm.is_verified THEN 1 END) as verified_profiles,\n    AVG(sm.follower_count) as avg_followers\nFROM social_media sm\nGROUP BY sm.platform\nORDER BY total_profiles DESC;\n\n-- People with multiple social media platforms\nSELECT\n    p.first_name,\n    p.last_name,\n    COUNT(sm.id) as platform_count,\n    string_agg(sm.platform::text, ', ' ORDER BY sm.platform) as platforms\nFROM person p\nJOIN social_media sm ON p.id = sm.person_id\nGROUP BY p.id, p.first_name, p.last_name\nHAVING COUNT(sm.id) &gt; 1\nORDER BY platform_count DESC, p.last_name;\n</code></pre>"},{"location":"tables/social-media/#data-quality-improvements","title":"Data Quality Improvements","text":""},{"location":"tables/social-media/#1-platform-specific-validation","title":"1. Platform-Specific Validation","text":"<pre><code>-- Twitter handle validation\nALTER TABLE social_media\nADD CONSTRAINT chk_social_media_twitter_handle\nCHECK (\n    platform != 'Twitter' OR\n    (handle IS NOT NULL AND handle ~ '^[A-Za-z0-9_]{1,15}$')\n);\n\n-- LinkedIn URL validation\nALTER TABLE social_media\nADD CONSTRAINT chk_social_media_linkedin_url\nCHECK (\n    platform != 'LinkedIn' OR\n    (url IS NOT NULL AND url ~ '^https?://.*linkedin\\.com/')\n);\n\n-- Instagram handle validation\nALTER TABLE social_media\nADD CONSTRAINT chk_social_media_instagram_handle\nCHECK (\n    platform != 'Instagram' OR\n    (handle IS NOT NULL AND handle ~ '^[A-Za-z0-9_.]{1,30}$')\n);\n</code></pre>"},{"location":"tables/social-media/#2-data-consistency","title":"2. Data Consistency","text":"<pre><code>-- Ensure either handle or URL is provided\nALTER TABLE social_media\nADD CONSTRAINT chk_social_media_handle_or_url\nCHECK (handle IS NOT NULL OR url IS NOT NULL);\n\n-- Follower count validation\nALTER TABLE social_media\nADD CONSTRAINT chk_social_media_follower_count\nCHECK (follower_count IS NULL OR follower_count &gt;= 0);\n</code></pre>"},{"location":"tables/social-media/#3-update-triggers","title":"3. Update Triggers","text":"<pre><code>-- Function to sync handle and URL\nCREATE OR REPLACE FUNCTION sync_social_media_handle_url()\nRETURNS TRIGGER AS $$\nBEGIN\n    -- Generate URL from handle if URL is missing\n    IF NEW.url IS NULL AND NEW.handle IS NOT NULL THEN\n        NEW.url = generate_url_from_handle(NEW.handle, NEW.platform);\n    END IF;\n\n    -- Extract handle from URL if handle is missing\n    IF NEW.handle IS NULL AND NEW.url IS NOT NULL THEN\n        NEW.handle = extract_handle_from_url(NEW.url, NEW.platform);\n    END IF;\n\n    -- Update timestamp\n    NEW.updated_at = NOW();\n\n    RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE TRIGGER social_media_sync_handle_url\n    BEFORE INSERT OR UPDATE ON social_media\n    FOR EACH ROW\n    EXECUTE FUNCTION sync_social_media_handle_url();\n</code></pre>"},{"location":"tables/social-media/#advanced-features","title":"Advanced Features","text":""},{"location":"tables/social-media/#1-social-media-analytics","title":"1. Social Media Analytics","text":"<pre><code>// Go functions for social media analytics\ntype SocialMediaStats struct {\n    TotalProfiles    int\n    PlatformBreakdown map[string]int\n    VerifiedCount    int\n    AverageFollowers float64\n}\n\nfunc GetSocialMediaStats(db *sql.DB) (*SocialMediaStats, error) {\n    stats := &amp;SocialMediaStats{\n        PlatformBreakdown: make(map[string]int),\n    }\n\n    query := `\n        SELECT\n            COUNT(*) as total,\n            platform,\n            COUNT(CASE WHEN is_verified THEN 1 END) as verified,\n            AVG(follower_count) as avg_followers\n        FROM social_media\n        GROUP BY platform\n    `\n\n    rows, err := db.Query(query)\n    if err != nil {\n        return nil, err\n    }\n    defer rows.Close()\n\n    for rows.Next() {\n        var platform string\n        var count, verified int\n        var avgFollowers sql.NullFloat64\n\n        err := rows.Scan(&amp;count, &amp;platform, &amp;verified, &amp;avgFollowers)\n        if err != nil {\n            return nil, err\n        }\n\n        stats.TotalProfiles += count\n        stats.PlatformBreakdown[platform] = count\n        stats.VerifiedCount += verified\n\n        if avgFollowers.Valid {\n            stats.AverageFollowers = avgFollowers.Float64\n        }\n    }\n\n    return stats, nil\n}\n</code></pre>"},{"location":"tables/social-media/#2-profile-validation","title":"2. Profile Validation","text":"<pre><code>func ValidateSocialMediaProfile(platform, handle, url string) error {\n    switch platform {\n    case \"Twitter\":\n        return validateTwitterProfile(handle, url)\n    case \"Instagram\":\n        return validateInstagramProfile(handle, url)\n    case \"LinkedIn\":\n        return validateLinkedInProfile(handle, url)\n    case \"Facebook\":\n        return validateFacebookProfile(handle, url)\n    default:\n        return validateGenericProfile(handle, url)\n    }\n}\n\nfunc validateTwitterProfile(handle, url string) error {\n    if handle != \"\" &amp;&amp; !regexp.MustCompile(`^[A-Za-z0-9_]{1,15}$`).MatchString(handle) {\n        return errors.New(\"invalid Twitter handle format\")\n    }\n\n    if url != \"\" &amp;&amp; !strings.Contains(url, \"twitter.com\") {\n        return errors.New(\"invalid Twitter URL\")\n    }\n\n    return nil\n}\n</code></pre>"},{"location":"tables/social-media/#troubleshooting","title":"Troubleshooting","text":""},{"location":"tables/social-media/#common-migration-issues","title":"Common Migration Issues","text":""},{"location":"tables/social-media/#1-invalid-social-media-data","title":"1. Invalid Social Media Data","text":"<pre><code>-- Find profiles with invalid handles or URLs\nSELECT sm.id, p.first_name, p.last_name, sm.platform, sm.handle, sm.url\nFROM social_media sm\nJOIN person p ON sm.person_id = p.id\nWHERE (sm.handle IS NULL AND sm.url IS NULL)\n   OR (sm.platform = 'Twitter' AND sm.handle !~ '^[A-Za-z0-9_]{1,15}$')\n   OR (sm.platform = 'LinkedIn' AND sm.url !~ '^https?://.*linkedin\\.com/');\n</code></pre>"},{"location":"tables/social-media/#2-duplicate-platform-entries","title":"2. Duplicate Platform Entries","text":"<pre><code>-- Check for duplicate platform entries per person (should not exist due to unique constraint)\nSELECT person_id, platform, COUNT(*) as duplicate_count\nFROM social_media\nGROUP BY person_id, platform\nHAVING COUNT(*) &gt; 1;\n</code></pre>"},{"location":"tables/social-media/#3-missing-person-references","title":"3. Missing Person References","text":"<pre><code>-- Find social media records with missing person references\nSELECT sm.id, sm.platform, sm.handle\nFROM social_media sm\nLEFT JOIN person p ON sm.person_id = p.id\nWHERE p.id IS NULL;\n</code></pre>"},{"location":"tables/social-media/#performance-optimization","title":"Performance Optimization","text":""},{"location":"tables/social-media/#query-performance","title":"Query Performance","text":"<ul> <li>Use person_id index for person-based social media lookups</li> <li>Use platform index for platform-specific queries</li> <li>Use handle index for handle-based searches</li> <li>Consider partial indexes for public profiles only</li> </ul>"},{"location":"tables/social-media/#data-management","title":"Data Management","text":"<ul> <li>Regular validation of social media URLs and handles</li> <li>Periodic updates of follower counts and verification status</li> <li>Cleanup of inactive or invalid profiles</li> </ul> <p>This social media table migration provides a flexible, normalized approach to managing social media profiles with comprehensive validation and platform-specific handling capabilities.</p>"}]}